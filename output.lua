--[[ This file is protected by LuraGuards ]]--

local IllIIllIIllII = [[aWYgZ2V0Z2VudigpLnBpbmt5IHRoZW4gd2FybigiUGlua3kgSHViIDogQWxyZWFkeSBleGVjdXRlZCEiKSByZXR1cm4gZW5kDQpnZXRnZW52KCkucGlua3kgPSB0cnVlDQoNCmlmIG5vdCBnYW1lOklzTG9hZGVkKCkgdGhlbg0KICAgIGdhbWUuTG9hZGVkOldhaXQoKQ0KZW5kDQoNCmxvY2FsIEZsdWVudCA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL2dpdGh1Yi5jb20vZGF3aWQtc2NyaXB0cy9GbHVlbnQvcmVsZWFzZXMvbGF0ZXN0L2Rvd25sb2FkL21haW4ubHVhIikpKCkNCmxvY2FsIFNhdmVNYW5hZ2VyID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYXdpZC1zY3JpcHRzL0ZsdWVudC9tYXN0ZXIvQWRkb25zL1NhdmVNYW5hZ2VyLmx1YSIpKSgpDQpsb2NhbCBJbnRlcmZhY2VNYW5hZ2VyID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYXdpZC1zY3JpcHRzL0ZsdWVudC9tYXN0ZXIvQWRkb25zL0ludGVyZmFjZU1hbmFnZXIubHVhIikpKCkNCg0KbG9jYWwgRGV2aWNlVHlwZSA9IGdhbWU6R2V0U2VydmljZSgiVXNlcklucHV0U2VydmljZSIpLlRvdWNoRW5hYmxlZCBhbmQgIk1vYmlsZSIgb3IgIlBDIg0KaWYgRGV2aWNlVHlwZSA9PSAiTW9iaWxlIiB0aGVuDQogICAgbG9jYWwgQ2xpY2tCdXR0b24gPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpDQogICAgbG9jYWwgTWFpbkZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpDQogICAgbG9jYWwgSW1hZ2VMYWJlbCA9IEluc3RhbmNlLm5ldygiSW1hZ2VMYWJlbCIpDQogICAgbG9jYWwgVGV4dEJ1dHRvbiA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpDQogICAgbG9jYWwgVUlDb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikNCiAgICBsb2NhbCBVSUNvcm5lcl8yID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpDQoNCiAgICBDbGlja0J1dHRvbi5OYW1lID0gIkNsaWNrQnV0dG9uIg0KICAgIENsaWNrQnV0dG9uLlBhcmVudCA9IGdhbWUuQ29yZUd1aQ0KICAgIENsaWNrQnV0dG9uLlpJbmRleEJlaGF2aW9yID0gRW51bS5aSW5kZXhCZWhhdmlvci5TaWJsaW5nDQoNCiAgICBNYWluRnJhbWUuTmFtZSA9ICJNYWluRnJhbWUiDQogICAgTWFpbkZyYW1lLlBhcmVudCA9IENsaWNrQnV0dG9uDQogICAgTWFpbkZyYW1lLkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMSwgMCkNCiAgICBNYWluRnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMg0KICAgIE1haW5GcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAsIDIwLCAyNSkNCiAgICBNYWluRnJhbWUuQm9yZGVyU2l6ZVBpeGVsID0gMA0KICAgIE1haW5GcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygxLCAtNjAsIDAsIDEwKQ0KICAgIE1haW5GcmFtZS5TaXplID0gVURpbTIubmV3KDAsIDQ1LCAwLCA0NSkNCg0KICAgIFVJQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDEsIDApDQogICAgVUlDb3JuZXIuUGFyZW50ID0gTWFpbkZyYW1lDQoNCiAgICBVSUNvcm5lcl8yLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDEwKQ0KICAgIFVJQ29ybmVyXzIuUGFyZW50ID0gSW1hZ2VMYWJlbA0KDQogICAgSW1hZ2VMYWJlbC5QYXJlbnQgPSBNYWluRnJhbWUNCiAgICBJbWFnZUxhYmVsLkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpDQogICAgSW1hZ2VMYWJlbC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldygwLCAwLCAwKQ0KICAgIEltYWdlTGFiZWwuQm9yZGVyU2l6ZVBpeGVsID0gMA0KICAgIEltYWdlTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApDQogICAgSW1hZ2VMYWJlbC5TaXplID0gVURpbTIubmV3KDAsIDQ1LCAwLCA0NSkNCiAgICBJbWFnZUxhYmVsLkltYWdlID0gInJieGFzc2V0aWQ6Ly8iDQoNCiAgICBUZXh0QnV0dG9uLlBhcmVudCA9IE1haW5GcmFtZQ0KICAgIFRleHRCdXR0b24uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5uZXcoMSwgMSwgMSkNCiAgICBUZXh0QnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxDQogICAgVGV4dEJ1dHRvbi5Cb3JkZXJTaXplUGl4ZWwgPSAwDQogICAgVGV4dEJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKQ0KICAgIFRleHRCdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLCA0NSwgMCwgNDUpDQogICAgVGV4dEJ1dHRvbi5BdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQ0KICAgIFRleHRCdXR0b24uRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkDQogICAgVGV4dEJ1dHRvbi5UZXh0ID0gIk9wZW4iDQogICAgVGV4dEJ1dHRvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMjgsIDI1NSkNCiAgICBUZXh0QnV0dG9uLlRleHRTaXplID0gMTgNCg0KICAgIFRleHRCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpDQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiVmlydHVhbElucHV0TWFuYWdlciIpOlNlbmRLZXlFdmVudCh0cnVlLCAiTGVmdENvbnRyb2wiLCBmYWxzZSwgZ2FtZSkNCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJWaXJ0dWFsSW5wdXRNYW5hZ2VyIik6U2VuZEtleUV2ZW50KGZhbHNlLCAiTGVmdENvbnRyb2wiLCBmYWxzZSwgZ2FtZSkNCiAgICBlbmQpDQoNCiAgICBsb2NhbCBVSUdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikNCiAgICBVSUdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoew0KICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDI1NSwgMTI4LCAyNTUpKSwNCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygxLCBDb2xvcjMuZnJvbVJHQigxODAsIDkwLCAxODApKQ0KICAgIH0pDQogICAgVUlHcmFkaWVudC5Sb3RhdGlvbiA9IDQ1DQogICAgVUlHcmFkaWVudC5QYXJlbnQgPSBNYWluRnJhbWUNCg0KICAgIGxvY2FsIEdsb3cgPSBJbnN0YW5jZS5uZXcoIkltYWdlTGFiZWwiKQ0KICAgIEdsb3cuTmFtZSA9ICJHbG93Ig0KICAgIEdsb3cuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDENCiAgICBHbG93LlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41LCAwKQ0KICAgIEdsb3cuU2l6ZSA9IFVEaW0yLm5ldygxLjUsIDAsIDEuNSwgMCkNCiAgICBHbG93LkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpDQogICAgR2xvdy5JbWFnZSA9ICJyYnhhc3NldGlkOi8vNzEzMTk0NjA5OCINCiAgICBHbG93LkltYWdlQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMjgsIDI1NSkNCiAgICBHbG93LkltYWdlVHJhbnNwYXJlbmN5ID0gMC41DQogICAgR2xvdy5QYXJlbnQgPSBNYWluRnJhbWUNCmVuZA0KDQpsb2NhbCBXaW5kb3cgPSBGbHVlbnQ6Q3JlYXRlV2luZG93KHsNCiAgICBUaXRsZSA9IGdhbWU6R2V0U2VydmljZSgiTWFya2V0cGxhY2VTZXJ2aWNlIik6R2V0UHJvZHVjdEluZm8oMTY3MzI2OTQwNTIpLk5hbWUgLi4iIHwgUGlua3kgR29kIiwNCiAgICBTdWJUaXRsZSA9ICJHb2QgRWRpdGlvbiB8IGRpc2NvcmQuZ2cvN21xZmt5eEEiLA0KICAgIFRhYldpZHRoID0gMTcwLA0KICAgIFNpemUgPSBVRGltMi5mcm9tT2Zmc2V0KDY1MCwgNTIwKSwNCiAgICBBY3J5bGljID0gZmFsc2UsDQogICAgVGhlbWUgPSAiRGFyayIsDQogICAgTWluaW1pemVLZXkgPSBFbnVtLktleUNvZGUuTGVmdENvbnRyb2wsDQogICAgQnV0dG9uUHJlc2V0ID0gIkN1c3RvbSIsDQogICAgQnV0dG9ucyA9IHsNCiAgICAgICAgew0KICAgICAgICAgICAgVGV4dCA9ICJEaXNjb3JkIiwNCiAgICAgICAgICAgIFJpY2hUZXh0ID0gdHJ1ZSwNCiAgICAgICAgICAgIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMjU1KSwNCiAgICAgICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKSANCiAgICAgICAgICAgICAgICBzZXRjbGlwYm9hcmQoImRpc2NvcmQuZ2cvN21xZmt5eEEiKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIH0NCiAgICB9DQp9KQ0KDQotLSAvLyAvLyAvLyBTZXJ2aWNlcyAvLyAvLyAvLyAtLQ0KbG9jYWwgVmlydHVhbElucHV0TWFuYWdlciA9IGdhbWU6R2V0U2VydmljZSgiVmlydHVhbElucHV0TWFuYWdlciIpDQpsb2NhbCBSZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKQ0KbG9jYWwgVmlydHVhbFVzZXIgPSBnYW1lOkdldFNlcnZpY2UoIlZpcnR1YWxVc2VyIikNCmxvY2FsIEh0dHBTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJIdHRwU2VydmljZSIpDQpsb2NhbCBHdWlTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJHdWlTZXJ2aWNlIikNCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQ0KbG9jYWwgV29ya3NwYWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKQ0KbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpDQpsb2NhbCBDb3JlR3VpID0gZ2FtZTpHZXRTZXJ2aWNlKCdTdGFydGVyR3VpJykNCmxvY2FsIENvbnRleHRBY3Rpb25TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCdDb250ZXh0QWN0aW9uU2VydmljZScpDQpsb2NhbCBVc2VySW5wdXRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCdVc2VySW5wdXRTZXJ2aWNlJykNCg0KLS0gLy8gLy8gLy8gTG9jYWxzIC8vIC8vIC8vIC0tDQpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXINCmxvY2FsIExvY2FsQ2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQ0KbG9jYWwgSHVtYW5vaWRSb290UGFydCA9IExvY2FsQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikNCmxvY2FsIFVzZXJQbGF5ZXIgPSBIdW1hbm9pZFJvb3RQYXJ0OldhaXRGb3JDaGlsZCgidXNlciIpDQpsb2NhbCBBY3RpdmVGb2xkZXIgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoImFjdGl2ZSIpDQpsb2NhbCBGaXNoaW5nWm9uZXNGb2xkZXIgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoInpvbmVzIik6V2FpdEZvckNoaWxkKCJmaXNoaW5nIikNCmxvY2FsIFRwU3BvdHNGb2xkZXIgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIndvcmxkIik6V2FpdEZvckNoaWxkKCJzcGF3bnMiKTpXYWl0Rm9yQ2hpbGQoIlRwU3BvdHMiKQ0KbG9jYWwgTnBjRm9sZGVyID0gV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJ3b3JsZCIpOldhaXRGb3JDaGlsZCgibnBjcyIpDQpsb2NhbCBQbGF5ZXJHdWkgPSBMb2NhbFBsYXllcjpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIpDQpsb2NhbCBzY3JlZW5HdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIsIFBsYXllckd1aSkNCmxvY2FsIHNoYWRvd0NvdW50TGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIsIHNjcmVlbkd1aSkNCnNoYWRvd0NvdW50TGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygwLCAyODAsIDAsIDcwKQ0Kc2hhZG93Q291bnRMYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAzMCwgMCwgMjYwKQ0Kc2hhZG93Q291bnRMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMA0Kc2hhZG93Q291bnRMYWJlbC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTUsIDE1LCAyMCkNCnNoYWRvd0NvdW50TGFiZWwuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQpzaGFkb3dDb3VudExhYmVsLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZA0Kc2hhZG93Q291bnRMYWJlbC5UZXh0U2l6ZSA9IDI0DQpzaGFkb3dDb3VudExhYmVsLlRleHQgPSAiU2hhZG93IENvdW50OiAwIg0Kc2hhZG93Q291bnRMYWJlbC5WaXNpYmxlID0gZmFsc2UNCmxvY2FsIFJlbmRlclN0ZXBwZWQgPSBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQNCmxvY2FsIFdhaXRGb3JTb21lb25lID0gUmVuZGVyU3RlcHBlZC5XYWl0DQoNCi0tIC8vIC8vIC8vIEZlYXR1cmVzIExpc3QgLy8gLy8gLy8gLS0NCg0KDQotLSAvLyAvLyAvLyBWYXJpYWJsZXMgLy8gLy8gLy8gLS0NCmxvY2FsIENhc3RNb2RlID0gIkxlZ2l0Ig0KbG9jYWwgU2hha2VNb2RlID0gIk5hdmlnYXRpb24iDQpsb2NhbCBSZWVsTW9kZSA9ICJCbGF0YW50Ig0KbG9jYWwgQ29sbGVjdE1vZGUgPSAiVGVsZXBvcnRzIg0KbG9jYWwgdGVsZXBvcnRTcG90cyA9IHt9DQpsb2NhbCBGcmVlemVDaGFyID0gZmFsc2UNCmxvY2FsIERheU9ubHlMb29wID0gbmlsDQpsb2NhbCBCeXBhc3NHcHNMb29wID0gbmlsDQpsb2NhbCBOb2NsaXAgPSBmYWxzZQ0KbG9jYWwgUnVuQ291bnQgPSBmYWxzZQ0KDQotLSAvLyAvLyAvLyBGdW5jdGlvbnMgLy8gLy8gLy8gLS0NCmZ1bmN0aW9uIFNob3dOb3RpZmljYXRpb24oU3RyaW5nKQ0KICAgIEZsdWVudDpOb3RpZnkoew0KICAgICAgICBUaXRsZSA9ICJQaW5reSBHb2QiLA0KICAgICAgICBDb250ZW50ID0gU3RyaW5nLA0KICAgICAgICBEdXJhdGlvbiA9IDMsDQogICAgICAgIFRoZW1lID0gIkRhcmsiLA0KICAgICAgICBUaXRsZUNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMDAsIDI1NSksDQogICAgICAgIEljb24gPSAicmJ4YXNzZXRpZDovLzcwNzI3MTg0MTIiLA0KICAgICAgICBBY3Rpb25zID0gew0KICAgICAgICAgICAgSWdub3JlID0gew0KICAgICAgICAgICAgICAgIE5hbWUgPSAiT0siLA0KICAgICAgICAgICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKSBlbmQNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pDQplbmQNCg0KLS0gLy8gU2VuZGluZyBFeGVjdXRpb24gVG8gRGlzY29yZCAvLyAtLQ0KbG9jYWwgZnVuY3Rpb24gR2V0UGxheWVyU3RhdHMoKQ0KICAgIGxvY2FsIGh1ZCA9IExvY2FsUGxheWVyOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJHdWkiKSBhbmQgTG9jYWxQbGF5ZXIuUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJodWQiKQ0KICAgIGlmIGh1ZCBhbmQgaHVkLnNhZmV6b25lIHRoZW4NCiAgICAgICAgbG9jYWwgY29pbnMgPSBodWQuc2FmZXpvbmU6RmluZEZpcnN0Q2hpbGQoImNvaW5zIikgYW5kIGh1ZC5zYWZlem9uZS5jb2lucy5UZXh0IG9yICJOL0EiDQogICAgICAgIGxvY2FsIGpvYklkID0gZ2FtZS5Kb2JJZA0KICAgICAgICBsb2NhbCBqb2luU2NyaXB0ID0gc3RyaW5nLmZvcm1hdCgiZ2FtZTpHZXRTZXJ2aWNlKCdUZWxlcG9ydFNlcnZpY2UnKTpUZWxlcG9ydFRvUGxhY2VJbnN0YW5jZSglZCwgJyVzJywgZ2FtZTpHZXRTZXJ2aWNlKCdQbGF5ZXJzJykuTG9jYWxQbGF5ZXIpIiwgZ2FtZS5QbGFjZUlkLCBqb2JJZCkNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIFVzZXJuYW1lID0gTG9jYWxQbGF5ZXIuTmFtZSwNCiAgICAgICAgICAgIERpc3BsYXlOYW1lID0gTG9jYWxQbGF5ZXIuRGlzcGxheU5hbWUsDQogICAgICAgICAgICBDb2lucyA9IGNvaW5zLA0KICAgICAgICAgICAgSm9iSWQgPSBqb2JJZCwNCiAgICAgICAgICAgIEpvaW5TY3JpcHQgPSBqb2luU2NyaXB0DQogICAgICAgIH0NCiAgICBlbmQNCiAgICByZXR1cm4gbmlsDQplbmQNCg0KZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLklkbGVkOkNvbm5lY3QoZnVuY3Rpb24oKQ0KICAgIFZpcnR1YWxVc2VyOkNhcHR1cmVDb250cm9sbGVyKCkNCiAgICBWaXJ0dWFsVXNlcjpDbGlja0J1dHRvbjIoVmVjdG9yMi5uZXcoKSkNCmVuZCkNCg0Kc3Bhd24oZnVuY3Rpb24oKQ0KICAgIHdoaWxlIHRydWUgZG8NCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiZXZlbnRzIik6V2FpdEZvckNoaWxkKCJhZmsiKTpGaXJlU2VydmVyKGZhbHNlKQ0KICAgICAgICB0YXNrLndhaXQoMC4wMSkNCiAgICBlbmQNCmVuZCkNCg0KLS0gLy8gLy8gLy8gQXV0byBDYXN0IC8vIC8vIC8vIC0tDQpsb2NhbCBhdXRvQ2FzdEVuYWJsZWQgPSBmYWxzZQ0KbG9jYWwgZnVuY3Rpb24gYXV0b0Nhc3QoKQ0KICAgIGlmIExvY2FsQ2hhcmFjdGVyIHRoZW4NCiAgICAgICAgbG9jYWwgdG9vbCA9IExvY2FsQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiVG9vbCIpDQogICAgICAgIGlmIHRvb2wgdGhlbg0KICAgICAgICAgICAgbG9jYWwgaGFzQm9iYmVyID0gdG9vbDpGaW5kRmlyc3RDaGlsZCgiYm9iYmVyIikNCiAgICAgICAgICAgIGlmIG5vdCBoYXNCb2JiZXIgdGhlbg0KICAgICAgICAgICAgICAgIGlmIENhc3RNb2RlID09ICJMZWdpdCIgdGhlbg0KICAgICAgICAgICAgICAgICAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRNb3VzZUJ1dHRvbkV2ZW50KDAsIDAsIDAsIHRydWUsIExvY2FsUGxheWVyLCAwKQ0KICAgICAgICAgICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LkNoaWxkQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBIdW1hbm9pZFJvb3RQYXJ0OkZpbmRGaXJzdENoaWxkKCJwb3dlciIpIH49IG5pbCBhbmQgSHVtYW5vaWRSb290UGFydC5wb3dlci5wb3dlcmJhci5iYXIgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LnBvd2VyLnBvd2VyYmFyLmJhci5DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24ocHJvcGVydHkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHByb3BlcnR5ID09ICJTaXplIiB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBIdW1hbm9pZFJvb3RQYXJ0LnBvd2VyLnBvd2VyYmFyLmJhci5TaXplID09IFVEaW0yLm5ldygxLCAwLCAxLCAwKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlydHVhbElucHV0TWFuYWdlcjpTZW5kTW91c2VCdXR0b25FdmVudCgwLCAwLCAwLCBmYWxzZSwgTG9jYWxQbGF5ZXIsIDApDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgIGVuZCkNCiAgICAgICAgICAgICAgICBlbHNlaWYgQ2FzdE1vZGUgPT0gIkJsYXRhbnQiIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcm9kID0gTG9jYWxDaGFyYWN0ZXIgYW5kIExvY2FsQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiVG9vbCIpDQogICAgICAgICAgICAgICAgICAgIGlmIHJvZCBhbmQgcm9kOkZpbmRGaXJzdENoaWxkKCJ2YWx1ZXMiKSBhbmQgc3RyaW5nLmZpbmQocm9kLk5hbWUsICJSb2QiKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQ0KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgUmFuZG9tID0gbWF0aC5yYW5kb20oOTAsIDk5KQ0KICAgICAgICAgICAgICAgICAgICAgICAgcm9kLmV2ZW50cy5jYXN0OkZpcmVTZXJ2ZXIoUmFuZG9tKQ0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgdGFzay53YWl0KDAuNSkNCiAgICBlbmQNCmVuZA0KDQotLSAvLyAvLyAvLyBBdXRvIFNoYWtlIC8vIC8vIC8vIC0tDQpsb2NhbCBhdXRvU2hha2VFbmFibGVkID0gdHJ1ZSAtLSBTZXQgdG8gdHJ1ZSB0byBlbmFibGUgYXV0by1zaGFrZQ0KbG9jYWwgYXV0b1NoYWtlQ29ubmVjdGlvbg0KbG9jYWwgU2hha2VNb2RlID0gIk5hdmlnYXRpb24iIC0tIENob29zZSBiZXR3ZWVuICJOYXZpZ2F0aW9uIiBvciAiTW91c2UiDQoNCmxvY2FsIGZ1bmN0aW9uIGF1dG9TaGFrZSgpDQogICAgaWYgU2hha2VNb2RlID09ICJOYXZpZ2F0aW9uIiB0aGVuDQogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGxvY2FsIHNoYWtldWkgPSBQbGF5ZXJHdWk6RmluZEZpcnN0Q2hpbGQoInNoYWtldWkiKQ0KICAgICAgICAgICAgaWYgbm90IHNoYWtldWkgdGhlbiByZXR1cm4gZW5kDQogICAgICAgICAgICBsb2NhbCBzYWZlem9uZSA9IHNoYWtldWk6RmluZEZpcnN0Q2hpbGQoInNhZmV6b25lIikNCiAgICAgICAgICAgIGxvY2FsIGJ1dHRvbiA9IHNhZmV6b25lIGFuZCBzYWZlem9uZTpGaW5kRmlyc3RDaGlsZCgiYnV0dG9uIikNCiAgICAgICAgICAgIGlmIGJ1dHRvbiB0aGVuDQogICAgICAgICAgICAgICAgLS0gU2ltdWxhdGUgYnV0dG9uIHByZXNzIHVzaW5nIEd1aVNlcnZpY2UNCiAgICAgICAgICAgICAgICBHdWlTZXJ2aWNlLlNlbGVjdGVkT2JqZWN0ID0gYnV0dG9uDQogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkgLS0gUmVkdWNlZCB3YWl0IHRpbWUgZm9yIGJldHRlciByZXNwb25zaXZlbmVzcw0KICAgICAgICAgICAgICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZEtleUV2ZW50KHRydWUsIEVudW0uS2V5Q29kZS5SZXR1cm4sIGZhbHNlLCBnYW1lKQ0KICAgICAgICAgICAgICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZEtleUV2ZW50KGZhbHNlLCBFbnVtLktleUNvZGUuUmV0dXJuLCBmYWxzZSwgZ2FtZSkNCiAgICAgICAgICAgICAgICBHdWlTZXJ2aWNlLlNlbGVjdGVkT2JqZWN0ID0gbmlsIC0tIENsZWFyIHNlbGVjdGVkIG9iamVjdCBhZnRlciBwcmVzcw0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZCkNCiAgICBlbHNlaWYgU2hha2VNb2RlID09ICJNb3VzZSIgdGhlbg0KICAgICAgICBwY2FsbChmdW5jdGlvbigpDQogICAgICAgICAgICBsb2NhbCBzaGFrZXVpID0gUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJzaGFrZXVpIikNCiAgICAgICAgICAgIGlmIG5vdCBzaGFrZXVpIHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICAgICAgbG9jYWwgc2FmZXpvbmUgPSBzaGFrZXVpOkZpbmRGaXJzdENoaWxkKCJzYWZlem9uZSIpDQogICAgICAgICAgICBsb2NhbCBidXR0b24gPSBzYWZlem9uZSBhbmQgc2FmZXpvbmU6RmluZEZpcnN0Q2hpbGQoImJ1dHRvbiIpDQogICAgICAgICAgICBpZiBidXR0b24gdGhlbg0KICAgICAgICAgICAgICAgIC0tIFNpbXVsYXRlIG1vdXNlIGNsaWNrIG9uIGJ1dHRvbg0KICAgICAgICAgICAgICAgIGxvY2FsIHBvcyA9IGJ1dHRvbi5BYnNvbHV0ZVBvc2l0aW9uDQogICAgICAgICAgICAgICAgbG9jYWwgc2l6ZSA9IGJ1dHRvbi5BYnNvbHV0ZVNpemUNCiAgICAgICAgICAgICAgICBsb2NhbCBjZW50ZXJYLCBjZW50ZXJZID0gcG9zLlggKyBzaXplLlggLyAyLCBwb3MuWSArIHNpemUuWSAvIDINCiAgICAgICAgICAgICAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRNb3VzZUJ1dHRvbkV2ZW50KGNlbnRlclgsIGNlbnRlclksIDAsIHRydWUsIGdhbWUsIDApDQogICAgICAgICAgICAgICAgVmlydHVhbElucHV0TWFuYWdlcjpTZW5kTW91c2VCdXR0b25FdmVudChjZW50ZXJYLCBjZW50ZXJZLCAwLCBmYWxzZSwgZ2FtZSwgMCkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQpDQogICAgZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gc3RhcnRBdXRvU2hha2UoKQ0KICAgIGlmIGF1dG9TaGFrZUNvbm5lY3Rpb24gb3Igbm90IGF1dG9TaGFrZUVuYWJsZWQgdGhlbiByZXR1cm4gZW5kDQogICAgLS0gVXNlIEhlYXJ0YmVhdCBmb3Igc21vb3RoZXIgZXhlY3V0aW9uIGluc3RlYWQgb2YgUmVuZGVyU3RlcHBlZA0KICAgIGF1dG9TaGFrZUNvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGF1dG9TaGFrZSkNCmVuZA0KDQpsb2NhbCBmdW5jdGlvbiBzdG9wQXV0b1NoYWtlKCkNCiAgICBpZiBhdXRvU2hha2VDb25uZWN0aW9uIHRoZW4NCiAgICAgICAgYXV0b1NoYWtlQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkNCiAgICAgICAgYXV0b1NoYWtlQ29ubmVjdGlvbiA9IG5pbA0KICAgIGVuZA0KZW5kDQoNCi0tIEF1dG9tYXRpY2FsbHkgc3RhcnQvc3RvcCBhdXRvLXNoYWtlIGJhc2VkIG9uIEdVSSBjaGFuZ2VzDQpQbGF5ZXJHdWkuRGVzY2VuZGFudEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oZGVzY2VuZGFudCkNCiAgICBpZiBhdXRvU2hha2VFbmFibGVkIGFuZCBkZXNjZW5kYW50Lk5hbWUgPT0gImJ1dHRvbiIgYW5kIGRlc2NlbmRhbnQuUGFyZW50IGFuZCBkZXNjZW5kYW50LlBhcmVudC5OYW1lID09ICJzYWZlem9uZSIgdGhlbg0KICAgICAgICBzdGFydEF1dG9TaGFrZSgpDQogICAgZW5kDQplbmQpDQoNClBsYXllckd1aS5EZXNjZW5kYW50UmVtb3Zpbmc6Q29ubmVjdChmdW5jdGlvbihkZXNjZW5kYW50KQ0KICAgIGlmIGRlc2NlbmRhbnQuTmFtZSA9PSAiYnV0dG9uIiBhbmQgZGVzY2VuZGFudC5QYXJlbnQgYW5kIGRlc2NlbmRhbnQuUGFyZW50Lk5hbWUgPT0gInNhZmV6b25lIiB0aGVuDQogICAgICAgIHN0b3BBdXRvU2hha2UoKQ0KICAgIGVuZA0KZW5kKQ0KDQotLSBJbml0aWFsIGNoZWNrIGZvciBzaGFrZSBVSQ0KdGFzay5kZWZlcihmdW5jdGlvbigpDQogICAgbG9jYWwgc2hha2V1aSA9IFBsYXllckd1aTpGaW5kRmlyc3RDaGlsZCgic2hha2V1aSIpDQogICAgbG9jYWwgc2FmZXpvbmUgPSBzaGFrZXVpIGFuZCBzaGFrZXVpOkZpbmRGaXJzdENoaWxkKCJzYWZlem9uZSIpDQogICAgbG9jYWwgYnV0dG9uID0gc2FmZXpvbmUgYW5kIHNhZmV6b25lOkZpbmRGaXJzdENoaWxkKCJidXR0b24iKQ0KICAgIGlmIGF1dG9TaGFrZUVuYWJsZWQgYW5kIGJ1dHRvbiB0aGVuDQogICAgICAgIHN0YXJ0QXV0b1NoYWtlKCkNCiAgICBlbmQNCmVuZCkNCg0KDQotLSAvLyAvLyAvLyBBdXRvIFJlZWwgLy8gLy8gLy8gLS0NCmxvY2FsIGF1dG9SZWVsRW5hYmxlZCA9IGZhbHNlDQpsb2NhbCBQZXJmZWN0Q2F0Y2hFbmFibGVkID0gZmFsc2UNCmxvY2FsIGF1dG9SZWVsQ29ubmVjdGlvbg0KbG9jYWwgZnVuY3Rpb24gYXV0b1JlZWwoKQ0KICAgIGxvY2FsIHJlZWwgPSBQbGF5ZXJHdWk6RmluZEZpcnN0Q2hpbGQoInJlZWwiKQ0KICAgIGlmIG5vdCByZWVsIHRoZW4gcmV0dXJuIGVuZA0KICAgIGxvY2FsIGJhciA9IHJlZWw6RmluZEZpcnN0Q2hpbGQoImJhciIpDQogICAgbG9jYWwgcGxheWVyYmFyID0gYmFyIGFuZCBiYXI6RmluZEZpcnN0Q2hpbGQoInBsYXllcmJhciIpDQogICAgbG9jYWwgZmlzaCA9IGJhciBhbmQgYmFyOkZpbmRGaXJzdENoaWxkKCJmaXNoIikNCiAgICBpZiBwbGF5ZXJiYXIgYW5kIGZpc2ggdGhlbg0KICAgICAgICBwbGF5ZXJiYXIuUG9zaXRpb24gPSBmaXNoLlBvc2l0aW9uDQogICAgZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gbm9wZXJmZWN0KCkNCiAgICBsb2NhbCByZWVsID0gUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJyZWVsIikNCiAgICBpZiBub3QgcmVlbCB0aGVuIHJldHVybiBlbmQNCiAgICBsb2NhbCBiYXIgPSByZWVsOkZpbmRGaXJzdENoaWxkKCJiYXIiKQ0KICAgIGxvY2FsIHBsYXllcmJhciA9IGJhciBhbmQgYmFyOkZpbmRGaXJzdENoaWxkKCJwbGF5ZXJiYXIiKQ0KICAgIGlmIHBsYXllcmJhciB0aGVuDQogICAgICAgIHBsYXllcmJhci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAtMzUsIDApDQogICAgICAgIHdhaXQoMC4yKQ0KICAgIGVuZA0KZW5kDQoNCmxvY2FsIGZ1bmN0aW9uIHN0YXJ0QXV0b1JlZWwoKQ0KICAgIGlmIFJlZWxNb2RlID09ICJMZWdpdCIgdGhlbg0KICAgICAgICBpZiBhdXRvUmVlbENvbm5lY3Rpb24gb3Igbm90IGF1dG9SZWVsRW5hYmxlZCB0aGVuIHJldHVybiBlbmQNCiAgICAgICAgbm9wZXJmZWN0KCkNCiAgICAgICAgdGFzay53YWl0KDIpDQogICAgICAgIGF1dG9SZWVsQ29ubmVjdGlvbiA9IFJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZDpDb25uZWN0KGF1dG9SZWVsKQ0KICAgIGVsc2VpZiBSZWVsTW9kZSA9PSAiQmxhdGFudCIgdGhlbg0KICAgICAgICBsb2NhbCByZWVsID0gUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJyZWVsIikNCiAgICAgICAgaWYgbm90IHJlZWwgdGhlbiByZXR1cm4gZW5kDQogICAgICAgIGxvY2FsIGJhciA9IHJlZWw6RmluZEZpcnN0Q2hpbGQoImJhciIpDQogICAgICAgIGxvY2FsIHBsYXllcmJhciA9IGJhciBhbmQgYmFyOkZpbmRGaXJzdENoaWxkKCJwbGF5ZXJiYXIiKQ0KICAgICAgICBwbGF5ZXJiYXI6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCdQb3NpdGlvbicpOldhaXQoKQ0KICAgICAgICBnYW1lLlJlcGxpY2F0ZWRTdG9yYWdlOldhaXRGb3JDaGlsZCgiZXZlbnRzIik6V2FpdEZvckNoaWxkKCJyZWVsZmluaXNoZWQiKTpGaXJlU2VydmVyKDEwMCwgZmFsc2UpDQogICAgZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gc3RvcEF1dG9SZWVsKCkNCiAgICBpZiBhdXRvUmVlbENvbm5lY3Rpb24gdGhlbg0KICAgICAgICBhdXRvUmVlbENvbm5lY3Rpb246RGlzY29ubmVjdCgpDQogICAgICAgIGF1dG9SZWVsQ29ubmVjdGlvbiA9IG5pbA0KICAgIGVuZA0KZW5kDQoNClBsYXllckd1aS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbihkZXNjZW5kYW50KQ0KICAgIGlmIGF1dG9SZWVsRW5hYmxlZCBhbmQgZGVzY2VuZGFudC5OYW1lID09ICJwbGF5ZXJiYXIiIGFuZCBkZXNjZW5kYW50LlBhcmVudCBhbmQgZGVzY2VuZGFudC5QYXJlbnQuTmFtZSA9PSAiYmFyIiB0aGVuDQogICAgICAgIHN0YXJ0QXV0b1JlZWwoKQ0KICAgIGVuZA0KZW5kKQ0KDQpQbGF5ZXJHdWkuRGVzY2VuZGFudFJlbW92aW5nOkNvbm5lY3QoZnVuY3Rpb24oZGVzY2VuZGFudCkNCiAgICBpZiBkZXNjZW5kYW50Lk5hbWUgPT0gInBsYXllcmJhciIgYW5kIGRlc2NlbmRhbnQuUGFyZW50IGFuZCBkZXNjZW5kYW50LlBhcmVudC5OYW1lID09ICJiYXIiIHRoZW4NCiAgICAgICAgc3RvcEF1dG9SZWVsKCkNCiAgICAgICAgaWYgYXV0b0Nhc3RFbmFibGVkIHRoZW4NCiAgICAgICAgICAgIHRhc2sud2FpdCgxKQ0KICAgICAgICAgICAgYXV0b0Nhc3QoKQ0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZCkNCg0KaWYgYXV0b1JlZWxFbmFibGVkIGFuZCBQbGF5ZXJHdWk6RmluZEZpcnN0Q2hpbGQoInJlZWwiKSBhbmQgDQogICAgUGxheWVyR3VpLnJlZWw6RmluZEZpcnN0Q2hpbGQoImJhciIpIGFuZCANCiAgICBQbGF5ZXJHdWkucmVlbC5iYXI6RmluZEZpcnN0Q2hpbGQoInBsYXllcmJhciIpIHRoZW4NCiAgICBzdGFydEF1dG9SZWVsKCkNCmVuZA0KDQotLSAvLyAvLyAvLyBab25lIENhc3QgLy8gLy8gLy8gLS0NClpvbmVDb25uZWN0aW9uID0gTG9jYWxDaGFyYWN0ZXIuQ2hpbGRBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKGNoaWxkKQ0KICAgIGlmIFpvbmVDYXN0IGFuZCBjaGlsZDpJc0EoIlRvb2wiKSBhbmQgRmlzaGluZ1pvbmVzRm9sZGVyOkZpbmRGaXJzdENoaWxkKFpvbmUpIH49IG5pbCB0aGVuDQogICAgICAgIGNoaWxkLkNoaWxkQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihibGVoaCkNCiAgICAgICAgICAgIGlmIGJsZWhoLk5hbWUgPT0gImJvYmJlciIgdGhlbg0KICAgICAgICAgICAgICAgIGxvY2FsIFJvcGVDb25zdHJhaW50ID0gYmxlaGg6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJSb3BlQ29uc3RyYWludCIpDQogICAgICAgICAgICAgICAgaWYgWm9uZUNhc3QgYW5kIFJvcGVDb25zdHJhaW50IH49IG5pbCB0aGVuDQogICAgICAgICAgICAgICAgICAgIFJvcGVDb25zdHJhaW50LkNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihwcm9wZXJ0eSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHByb3BlcnR5ID09ICJMZW5ndGgiIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSb3BlQ29uc3RyYWludC5MZW5ndGggPSBtYXRoLmh1Z2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgICBlbmQpDQogICAgICAgICAgICAgICAgICAgIFJvcGVDb25zdHJhaW50Lkxlbmd0aCA9IG1hdGguaHVnZQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQ0KICAgICAgICAgICAgICAgIHdoaWxlIFdhaXRGb3JTb21lb25lKFJlbmRlclN0ZXBwZWQpIGRvDQogICAgICAgICAgICAgICAgICAgIGlmIFpvbmVDYXN0IGFuZCBibGVoaC5QYXJlbnQgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpDQogICAgICAgICAgICAgICAgICAgICAgICBibGVoaC5DRnJhbWUgPSBGaXNoaW5nWm9uZXNGb2xkZXJbWm9uZV0uQ0ZyYW1lDQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZCkNCiAgICBlbmQNCmVuZCkNCg0KLS0gLy8gRmluZCBUcFNwb3RzIC8vIC0tDQpsb2NhbCBUcFNwb3RzRm9sZGVyID0gV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJ3b3JsZCIpOldhaXRGb3JDaGlsZCgic3Bhd25zIik6V2FpdEZvckNoaWxkKCJUcFNwb3RzIikNCmZvciBpLCB2IGluIHBhaXJzKFRwU3BvdHNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8NCiAgICBpZiB0YWJsZS5maW5kKHRlbGVwb3J0U3BvdHMsIHYuTmFtZSkgPT0gbmlsIHRoZW4NCiAgICAgICAgdGFibGUuaW5zZXJ0KHRlbGVwb3J0U3BvdHMsIHYuTmFtZSkNCiAgICBlbmQNCmVuZA0KDQotLSAvLyAvLyAvLyBHZXQgUG9zaXRpb24gLy8gLy8gLy8gLS0NCmZ1bmN0aW9uIEdldFBvc2l0aW9uKCkNCglpZiBub3QgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4NCgkJcmV0dXJuIHsNCgkJCVZlY3RvcjMubmV3KDAsMCwwKSwNCgkJCVZlY3RvcjMubmV3KDAsMCwwKSwNCgkJCVZlY3RvcjMubmV3KDAsMCwwKQ0KCQl9DQoJZW5kDQoJcmV0dXJuIHsNCgkJZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpLlBvc2l0aW9uLlgsDQoJCWdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKS5Qb3NpdGlvbi5ZLA0KCQlnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikuUG9zaXRpb24uWg0KCX0NCmVuZA0KDQpmdW5jdGlvbiBFeHBvcnRWYWx1ZShhcmcxLCBhcmcyKQ0KCXJldHVybiB0b251bWJlcihzdHJpbmcuZm9ybWF0KCIlLiIuLihhcmcyIG9yIDEpLi4nZicsIGFyZzEpKQ0KZW5kDQoNCi0tIC8vIC8vIC8vIFNlbGwgSXRlbSAvLyAvLyAvLyAtLQ0KZnVuY3Rpb24gcmVtZW1iZXJQb3NpdGlvbigpDQogICAgc3Bhd24oZnVuY3Rpb24oKQ0KICAgICAgICBsb2NhbCBpbml0aWFsQ0ZyYW1lID0gSHVtYW5vaWRSb290UGFydC5DRnJhbWUNCiANCiAgICAgICAgbG9jYWwgYm9keVZlbG9jaXR5ID0gSW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiKQ0KICAgICAgICBib2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygwLCAwLCAwKQ0KICAgICAgICBib2R5VmVsb2NpdHkuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQ0KICAgICAgICBib2R5VmVsb2NpdHkuUGFyZW50ID0gSHVtYW5vaWRSb290UGFydA0KIA0KICAgICAgICBsb2NhbCBib2R5R3lybyA9IEluc3RhbmNlLm5ldygiQm9keUd5cm8iKQ0KICAgICAgICBib2R5R3lyby5NYXhUb3JxdWUgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQ0KICAgICAgICBib2R5R3lyby5EID0gMTAwDQogICAgICAgIGJvZHlHeXJvLlAgPSAxMDAwMA0KICAgICAgICBib2R5R3lyby5DRnJhbWUgPSBpbml0aWFsQ0ZyYW1lDQogICAgICAgIGJvZHlHeXJvLlBhcmVudCA9IEh1bWFub2lkUm9vdFBhcnQNCiANCiAgICAgICAgd2hpbGUgQXV0b0ZyZWV6ZSBkbw0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBpbml0aWFsQ0ZyYW1lDQogICAgICAgICAgICB0YXNrLndhaXQoMC4wMSkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGJvZHlWZWxvY2l0eSB0aGVuDQogICAgICAgICAgICBib2R5VmVsb2NpdHk6RGVzdHJveSgpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBib2R5R3lybyB0aGVuDQogICAgICAgICAgICBib2R5R3lybzpEZXN0cm95KCkNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KZW5kDQpmdW5jdGlvbiBTZWxsSGFuZCgpDQogICAgbG9jYWwgY3VycmVudFBvc2l0aW9uID0gSHVtYW5vaWRSb290UGFydC5DRnJhbWUNCiAgICBsb2NhbCBzZWxsUG9zaXRpb24gPSBDRnJhbWUubmV3KDQ2NCwgMTUxLCAyMzIpDQogICAgbG9jYWwgd2FzQXV0b0ZyZWV6ZUFjdGl2ZSA9IGZhbHNlDQogICAgaWYgQXV0b0ZyZWV6ZSB0aGVuDQogICAgICAgIHdhc0F1dG9GcmVlemVBY3RpdmUgPSB0cnVlDQogICAgICAgIEF1dG9GcmVlemUgPSBmYWxzZQ0KICAgIGVuZA0KICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gc2VsbFBvc2l0aW9uDQogICAgdGFzay53YWl0KDAuNSkNCiAgICB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJ3b3JsZCIpOldhaXRGb3JDaGlsZCgibnBjcyIpOldhaXRGb3JDaGlsZCgiTWFyYyBNZXJjaGFudCIpOldhaXRGb3JDaGlsZCgibWVyY2hhbnQiKTpXYWl0Rm9yQ2hpbGQoInNlbGwiKTpJbnZva2VTZXJ2ZXIoKQ0KICAgIHRhc2sud2FpdCgxKQ0KICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gY3VycmVudFBvc2l0aW9uDQogICAgaWYgd2FzQXV0b0ZyZWV6ZUFjdGl2ZSB0aGVuDQogICAgICAgIEF1dG9GcmVlemUgPSB0cnVlDQogICAgICAgIHJlbWVtYmVyUG9zaXRpb24oKQ0KICAgIGVuZA0KZW5kDQpmdW5jdGlvbiBTZWxsQWxsKCkNCiAgICBsb2NhbCBjdXJyZW50UG9zaXRpb24gPSBIdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQ0KICAgIGxvY2FsIHNlbGxQb3NpdGlvbiA9IENGcmFtZS5uZXcoNDY0LCAxNTEsIDIzMikNCiAgICBsb2NhbCB3YXNBdXRvRnJlZXplQWN0aXZlID0gZmFsc2UNCiAgICBpZiBBdXRvRnJlZXplIHRoZW4NCiAgICAgICAgd2FzQXV0b0ZyZWV6ZUFjdGl2ZSA9IHRydWUNCiAgICAgICAgQXV0b0ZyZWV6ZSA9IGZhbHNlDQogICAgZW5kDQogICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBzZWxsUG9zaXRpb24NCiAgICB0YXNrLndhaXQoMC41KQ0KICAgIHdvcmtzcGFjZTpXYWl0Rm9yQ2hpbGQoIndvcmxkIik6V2FpdEZvckNoaWxkKCJucGNzIik6V2FpdEZvckNoaWxkKCJNYXJjIE1lcmNoYW50Iik6V2FpdEZvckNoaWxkKCJtZXJjaGFudCIpOldhaXRGb3JDaGlsZCgic2VsbGFsbCIpOkludm9rZVNlcnZlcigpDQogICAgdGFzay53YWl0KDEpDQogICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBjdXJyZW50UG9zaXRpb24NCiAgICBpZiB3YXNBdXRvRnJlZXplQWN0aXZlIHRoZW4NCiAgICAgICAgQXV0b0ZyZWV6ZSA9IHRydWUNCiAgICAgICAgcmVtZW1iZXJQb3NpdGlvbigpDQogICAgZW5kDQplbmQNCg0KLS0gLy8gLy8gLy8gTm9jbGlwIFN0ZXBwZWQgLy8gLy8gLy8gLS0NCk5vY2xpcENvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLlN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgaWYgTm9jbGlwID09IHRydWUgdGhlbg0KICAgICAgICBpZiBMb2NhbENoYXJhY3RlciB+PSBuaWwgdGhlbg0KICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMoTG9jYWxDaGFyYWN0ZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8NCiAgICAgICAgICAgICAgICBpZiB2OklzQSgiQmFzZVBhcnQiKSBhbmQgdi5DYW5Db2xsaWRlID09IHRydWUgdGhlbg0KICAgICAgICAgICAgICAgICAgICB2LkNhbkNvbGxpZGUgPSBmYWxzZQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZA0KZW5kKQ0KDQotLSAvLyAvLyAvLyBEdXBlIC8vIC8vIC8vIC0tDQpsb2NhbCBEdXBlRW5hYmxlZCA9IGZhbHNlDQpsb2NhbCBEdXBlQ29ubmVjdGlvbg0KbG9jYWwgZnVuY3Rpb24gYXV0b0R1cGUoKQ0KICAgIGxvY2FsIGh1ZCA9IExvY2FsUGxheWVyLlBsYXllckd1aTpGaW5kRmlyc3RDaGlsZCgiaHVkIikNCiAgICBpZiBodWQgdGhlbg0KICAgICAgICBsb2NhbCBzYWZlem9uZSA9IGh1ZDpGaW5kRmlyc3RDaGlsZCgic2FmZXpvbmUiKQ0KICAgICAgICBpZiBzYWZlem9uZSB0aGVuDQogICAgICAgICAgICBsb2NhbCBib2R5QW5ub3VuY2VtZW50cyA9IHNhZmV6b25lOkZpbmRGaXJzdENoaWxkKCJib2R5YW5ub3VuY2VtZW50cyIpDQogICAgICAgICAgICBpZiBib2R5QW5ub3VuY2VtZW50cyB0aGVuDQogICAgICAgICAgICAgICAgbG9jYWwgb2ZmZXJGcmFtZSA9IGJvZHlBbm5vdW5jZW1lbnRzOkZpbmRGaXJzdENoaWxkKCJvZmZlciIpDQogICAgICAgICAgICAgICAgaWYgb2ZmZXJGcmFtZSBhbmQgb2ZmZXJGcmFtZTpGaW5kRmlyc3RDaGlsZCgiY29uZmlybSIpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgZmlyZXNpZ25hbChvZmZlckZyYW1lLmNvbmZpcm0uTW91c2VCdXR0b24xQ2xpY2spDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gc3RhcnRBdXRvRHVwZSgpDQogICAgaWYgRHVwZUNvbm5lY3Rpb24gb3Igbm90IER1cGVFbmFibGVkIHRoZW4gcmV0dXJuIGVuZA0KICAgIER1cGVDb25uZWN0aW9uID0gUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoYXV0b0R1cGUpDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gc3RvcEF1dG9EdXBlKCkNCiAgICBpZiBEdXBlQ29ubmVjdGlvbiB0aGVuDQogICAgICAgIER1cGVDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQ0KICAgICAgICBEdXBlQ29ubmVjdGlvbiA9IG5pbA0KICAgIGVuZA0KZW5kDQoNClBsYXllckd1aS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbihkZXNjZW5kYW50KQ0KICAgIGlmIER1cGVFbmFibGVkIGFuZCBkZXNjZW5kYW50Lk5hbWUgPT0gImNvbmZpcm0iIGFuZCBkZXNjZW5kYW50LlBhcmVudCBhbmQgZGVzY2VuZGFudC5QYXJlbnQuTmFtZSA9PSAib2ZmZXIiIHRoZW4NCiAgICAgICAgbG9jYWwgaHVkID0gTG9jYWxQbGF5ZXIuUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJodWQiKQ0KICAgICAgICBpZiBodWQgdGhlbg0KICAgICAgICAgICAgbG9jYWwgc2FmZXpvbmUgPSBodWQ6RmluZEZpcnN0Q2hpbGQoInNhZmV6b25lIikNCiAgICAgICAgICAgIGlmIHNhZmV6b25lIHRoZW4NCiAgICAgICAgICAgICAgICBsb2NhbCBib2R5QW5ub3VuY2VtZW50cyA9IHNhZmV6b25lOkZpbmRGaXJzdENoaWxkKCJib2R5YW5ub3VuY2VtZW50cyIpDQogICAgICAgICAgICAgICAgaWYgYm9keUFubm91bmNlbWVudHMgdGhlbg0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBvZmZlckZyYW1lID0gYm9keUFubm91bmNlbWVudHM6RmluZEZpcnN0Q2hpbGQoIm9mZmVyIikNCiAgICAgICAgICAgICAgICAgICAgaWYgb2ZmZXJGcmFtZSBhbmQgb2ZmZXJGcmFtZTpGaW5kRmlyc3RDaGlsZCgiY29uZmlybSIpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIGZpcmVzaWduYWwob2ZmZXJGcmFtZS5jb25maXJtLk1vdXNlQnV0dG9uMUNsaWNrKQ0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZCkNCg0KLS0gLy8gLy8gLy8gRXhjbHVzaXZlcyAvLyAvLyAvLyAtLQ0KbG9jYWwgc2hhZG93Q291bnRMYWJlbCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIiwgc2NyZWVuR3VpKQ0Kc2hhZG93Q291bnRMYWJlbC5TaXplID0gVURpbTIubmV3KDAsIDI4MCwgMCwgNzApDQpzaGFkb3dDb3VudExhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDMwLCAwLCAyNjApDQpzaGFkb3dDb3VudExhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwDQpzaGFkb3dDb3VudExhYmVsLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxNSwgMTUsIDIwKQ0Kc2hhZG93Q291bnRMYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMDAsIDI1NSkNCnNoYWRvd0NvdW50TGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkDQpzaGFkb3dDb3VudExhYmVsLlRleHRTaXplID0gMjQNCnNoYWRvd0NvdW50TGFiZWwuVGV4dCA9ICJTaGFkb3cgQ291bnQ6IDAiDQpzaGFkb3dDb3VudExhYmVsLlZpc2libGUgPSBmYWxzZQ0KDQpsb2NhbCBVSUdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikNClVJR3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7DQogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMjU1KSksDQogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjUsIENvbG9yMy5mcm9tUkdCKDE4MCwgOTAsIDE4MCkpLA0KICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgQ29sb3IzLmZyb21SR0IoMjU1LCAxMDAsIDI1NSkpDQp9KQ0KVUlHcmFkaWVudC5QYXJlbnQgPSBzaGFkb3dDb3VudExhYmVsDQoNCnNwYXduKGZ1bmN0aW9uKCkNCiAgICBsb2NhbCByb3RhdGlvbiA9IDANCiAgICB3aGlsZSB3YWl0KCkgZG8NCiAgICAgICAgcm90YXRpb24gPSAocm90YXRpb24gKyAxKSAlIDM2MA0KICAgICAgICBVSUdyYWRpZW50LlJvdGF0aW9uID0gcm90YXRpb24NCiAgICBlbmQNCmVuZCkNCg0KbG9jYWwgR2xvdyA9IEluc3RhbmNlLm5ldygiSW1hZ2VMYWJlbCIpDQpHbG93Lk5hbWUgPSAiR2xvdyINCkdsb3cuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDENCkdsb3cuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApDQpHbG93LlNpemUgPSBVRGltMi5uZXcoMS4yLCAwLCAxLjIsIDApDQpHbG93LkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpDQpHbG93LkltYWdlID0gInJieGFzc2V0aWQ6Ly83MTMxOTQ2MDk4Ig0KR2xvdy5JbWFnZUNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQpHbG93LkltYWdlVHJhbnNwYXJlbmN5ID0gMC44DQpHbG93LlBhcmVudCA9IHNoYWRvd0NvdW50TGFiZWwNCg0KbG9jYWwgY29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIHNoYWRvd0NvdW50TGFiZWwpDQpjb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTUpDQoNCmxvY2FsIFVJU3Ryb2tlID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIpDQpVSVN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQpVSVN0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjQNClVJU3Ryb2tlLlRoaWNrbmVzcyA9IDINClVJU3Ryb2tlLlBhcmVudCA9IHNoYWRvd0NvdW50TGFiZWwNCg0KbG9jYWwgRHJvcFNoYWRvdyA9IEluc3RhbmNlLm5ldygiSW1hZ2VMYWJlbCIpDQpEcm9wU2hhZG93Lk5hbWUgPSAiRHJvcFNoYWRvdyINCkRyb3BTaGFkb3cuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDENCkRyb3BTaGFkb3cuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApDQpEcm9wU2hhZG93LlNpemUgPSBVRGltMi5uZXcoMS4xLCAwLCAxLjEsIDApDQpEcm9wU2hhZG93LkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpDQpEcm9wU2hhZG93LkltYWdlID0gInJieGFzc2V0aWQ6Ly83MTMxOTQ2MDk4Ig0KRHJvcFNoYWRvdy5JbWFnZUNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApDQpEcm9wU2hhZG93LkltYWdlVHJhbnNwYXJlbmN5ID0gMC41DQpEcm9wU2hhZG93LlpJbmRleCA9IC0xDQpEcm9wU2hhZG93LlBhcmVudCA9IHNoYWRvd0NvdW50TGFiZWwNCg0KbG9jYWwgZnVuY3Rpb24gdXBkYXRlU2hhZG93Q291bnQoKQ0KICAgIGxvY2FsIGNvdW50ID0gI3dvcmtzcGFjZS5TaGFkb3dzOkdldENoaWxkcmVuKCkNCiAgICBzaGFkb3dDb3VudExhYmVsLlRleHQgPSAiU2hhZG93IENvdW50OiAiIC4uIGNvdW50DQplbmQNCg0Kc3Bhd24oZnVuY3Rpb24oKQ0KICAgIHdoaWxlIHRydWUgZG8NCiAgICAgICAgdXBkYXRlU2hhZG93Q291bnQoKQ0KICAgICAgICB0YXNrLndhaXQoMC41KQ0KICAgIGVuZA0KZW5kKQ0KDQotLSAvLyAvLyAvLyBUYWJzIEd1aSAvLyAvLyAvLyAtLQ0KDQpsb2NhbCBUYWJzID0geyAtLSBodHRwczovL2x1Y2lkZS5kZXYvaWNvbnMvDQogICAgSG9tZSA9IFdpbmRvdzpBZGRUYWIoeyANCiAgICAgICAgVGl0bGUgPSAiSG9tZSIsIA0KICAgICAgICBJY29uID0gImNyb3duIiwNCiAgICAgICAgUmlnaHRJY29uID0gInNwYXJrbGVzIiwNCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQogICAgfSksDQogICAgRXhjbHVzaXZlcyA9IFdpbmRvdzpBZGRUYWIoeyANCiAgICAgICAgVGl0bGUgPSAiRXhjbHVzaXZlcyIsIA0KICAgICAgICBJY29uID0gImdlbSIsDQogICAgICAgIFJpZ2h0SWNvbiA9ICJzdGFyIiwNCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQogICAgfSksDQogICAgTWFpbiA9IFdpbmRvdzpBZGRUYWIoeyANCiAgICAgICAgVGl0bGUgPSAiTWFpbiIsIA0KICAgICAgICBJY29uID0gInNldHRpbmdzIiwNCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQogICAgfSksDQogICAgSXRlbXMgPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiSXRlbXMiLCBJY29uID0gInBhY2thZ2UiLCBSaWdodEljb24gPSAiYm94IiwgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTI4LCAyNTUpIH0pLA0KICAgIFRlbGVwb3J0cyA9IFdpbmRvdzpBZGRUYWIoeyBUaXRsZSA9ICJUZWxlcG9ydHMiLCBJY29uID0gIm1hcCIsIFJpZ2h0SWNvbiA9ICJuYXZpZ2F0aW9uIiwgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTI4LCAyNTUpIH0pLA0KICAgIE1pc2MgPSBXaW5kb3c6QWRkVGFiKHsgVGl0bGUgPSAiTWlzYyIsIEljb24gPSAibW9yZS1ob3Jpem9udGFsIiwgUmlnaHRJY29uID0gInNldHRpbmdzIiwgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTI4LCAyNTUpIH0pLA0KICAgIFRyYWRlID0gV2luZG93OkFkZFRhYih7IFRpdGxlID0gIlRyYWRlIiwgSWNvbiA9ICJyZXBlYXQiLCBSaWdodEljb24gPSAiZ2lmdCIsIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEyOCwgMjU1KSB9KQ0KfQ0KDQpsb2NhbCBPcHRpb25zID0gRmx1ZW50Lk9wdGlvbnMNCg0KZG8NCiAgICBUYWJzLkhvbWU6QWRkUGFyYWdyYXBoKHsNCiAgICAgICAgVGl0bGUgPSAiV2VsY29tZSB0byBQaW5reSBHb2QiLA0KICAgICAgICBDb250ZW50ID0gW1sNClRoYW5rIHlvdSBmb3IgY2hvb3NpbmcgUGlua3kgR29kIQ0KDQpGZWF0dXJlczoNCsOi4oKswqIgRXhjbHVzaXZlIFNoYWRvdyBTeXN0ZW0NCsOi4oKswqIgQWR2YW5jZWQgRmlzaGluZyBUb29scw0Kw6LigqzCoiBQcmVtaXVtIFRlbGVwb3J0YXRpb24NCsOi4oKswqIgVklQIFN1cHBvcnQNCg0KVmVyc2lvbjogMS4wLjANClVwZGF0ZWQ6IF1dIC4uIG9zLmRhdGUoIiVkLyVtLyVZIikNCiAgICB9KQ0KDQogICAgLS0gLy8gRXhjbHVzaXZlcyBUYWIgLy8gLS0NCiAgICBsb2NhbCBzZWN0aW9uRXhjbHVzID0gVGFicy5FeGNsdXNpdmVzOkFkZFNlY3Rpb24oIkV4Y2x1c2l2ZXMgRmVhdHVyZXMiKQ0KICAgIGxvY2FsIENvdW50U2hhZG93cyA9IFRhYnMuRXhjbHVzaXZlczpBZGRUb2dnbGUoIkNvdW50U2hhZG93cyIsIHsNCiAgICAgICAgVGl0bGUgPSAiU2hvdyBTaGFkb3cgQ291bnRlciIsDQogICAgICAgIERlZmF1bHQgPSBmYWxzZQ0KICAgIH0pDQogICAgQ291bnRTaGFkb3dzOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGxvY2FsIFJlcXVpcmVSb2QgPSBQbGF5ZXJHdWkuaHVkLnNhZmV6b25lLmVxdWlwbWVudC5yb2RzLnNjcm9sbC5zYWZlem9uZTpGaW5kRmlyc3RDaGlsZCgiUm9kIE9mIFRoZSBEZXB0aHMiKQ0KICAgICAgICBpZiBub3QgUmVxdWlyZVJvZCB0aGVuIA0KICAgICAgICAgICAgQ291bnRTaGFkb3dzOlNldFZhbHVlKGZhbHNlKQ0KICAgICAgICAgICAgaWYgT3B0aW9ucy5Db3VudFNoYWRvd3MuVmFsdWUgdGhlbg0KICAgICAgICAgICAgICAgIFNob3dOb3RpZmljYXRpb24oIlJlcXVpcmVtZW50OiBSb2QgT2YgVGhlIERlcHRocyIpIA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgICAgICBzaGFkb3dDb3VudExhYmVsLlZpc2libGUgPSBPcHRpb25zLkNvdW50U2hhZG93cy5WYWx1ZQ0KICAgIGVuZCkNCiAgICBsb2NhbCBSb2REdXBlID0gVGFicy5FeGNsdXNpdmVzOkFkZFRvZ2dsZSgiUm9kRHVwZSIsIHtUaXRsZSA9ICJSb2QgT2YgVGhlIERlcHRocyBTcGFtIiwgRGVmYXVsdCA9IGZhbHNlIH0pDQogICAgUm9kRHVwZTpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBsb2NhbCBSZXF1aXJlUm9kID0gUGxheWVyR3VpLmh1ZC5zYWZlem9uZS5lcXVpcG1lbnQucm9kcy5zY3JvbGwuc2FmZXpvbmU6RmluZEZpcnN0Q2hpbGQoIlJvZCBPZiBUaGUgRGVwdGhzIikNCiAgICAgICAgaWYgbm90IFJlcXVpcmVSb2QgdGhlbiByZXR1cm4gU2hvd05vdGlmaWNhdGlvbigiUmVxdWlyZW1lbnQgUm9kIE9mIFRoZSBEZXB0aHMiKSBlbmQNCiAgICAgICAgd2hpbGUgT3B0aW9ucy5Sb2REdXBlLlZhbHVlIGRvDQogICAgICAgICAgICBsb2NhbCBhcmdzMSA9IHtbMV0gPSAiRmxpbXN5IFJvZCJ9DQogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuZXZlbnRzLmVxdWlwcm9kOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MxKSkNCg0KICAgICAgICAgICAgbG9jYWwgYXJnczIgPSB7WzFdID0gIlJvZCBPZiBUaGUgRGVwdGhzIn0NCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5ldmVudHMuZXF1aXByb2Q6RmlyZVNlcnZlcih1bnBhY2soYXJnczIpKQ0KICAgICAgICAgICAgdGFzay53YWl0KFJvZER1cGVEZWxheSkNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KICAgIGxvY2FsIFJvZER1cGVfRGVsYXkgPSBUYWJzLkV4Y2x1c2l2ZXM6QWRkU2xpZGVyKCJSb2REdXBlX0RlbGF5Iiwgew0KICAgICAgICBUaXRsZSA9ICJSb2QgT2YgVGhlIERlcHRocyBTcGFtIERlbGF5IiwNCiAgICAgICAgRGVzY3JpcHRpb24gPSAiIiwNCiAgICAgICAgRGVmYXVsdCA9IDAuMiwNCiAgICAgICAgTWluID0gMCwNCiAgICAgICAgTWF4ID0gMSwNCiAgICAgICAgUm91bmRpbmcgPSAxLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQ0KICAgICAgICAgICAgUm9kRHVwZURlbGF5ID0gVmFsdWUNCiAgICAgICAgZW5kDQogICAgfSkNCiAgICBUYWJzLkV4Y2x1c2l2ZXM6QWRkQnV0dG9uKHsNCiAgICAgICAgVGl0bGUgPSAiRHVwZSBTaGFkb3ciLA0KICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGxvY2FsIFJlcXVpcmVSb2QgPSBQbGF5ZXJHdWkuaHVkLnNhZmV6b25lLmVxdWlwbWVudC5yb2RzLnNjcm9sbC5zYWZlem9uZTpGaW5kRmlyc3RDaGlsZCgiUm9kIE9mIFRoZSBEZXB0aHMiKQ0KICAgICAgICAgICAgaWYgbm90IFJlcXVpcmVSb2QgdGhlbiByZXR1cm4gU2hvd05vdGlmaWNhdGlvbigiUmVxdWlyZW1lbnQgUm9kIE9mIFRoZSBEZXB0aHMiKSBlbmQNCiAgICAgICAgICAgIGZvciBpLHYgaW4gcGFpcnMoTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8gDQogICAgICAgICAgICAgICAgaWYgdjpGaW5kRmlyc3RDaGlsZCgib2ZmZXIiKSB0aGVuDQogICAgICAgICAgICAgICAgICAgIHYuUGFyZW50ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIHRhc2sud2FpdCgyKQ0KICAgICAgICAgICAgZm9yIGksdiBpbiBwYWlycyhMb2NhbFBsYXllci5DaGFyYWN0ZXI6R2V0Q2hpbGRyZW4oKSkgZG8gDQogICAgICAgICAgICAgICAgaWYgdjpGaW5kRmlyc3RDaGlsZCgib2ZmZXIiKSB0aGVuDQogICAgICAgICAgICAgICAgICAgIHYuUGFyZW50ID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICB9KQ0KDQogICAgVGFicy5FeGNsdXNpdmVzOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIkRlc3Ryb3kgU2hhZG93cyIsDQogICAgICAgIERlc2NyaXB0aW9uID0gIiIsDQogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQ0KICAgICAgICAgICAgZm9yIF8sc2hhZG93IGluIHBhaXJzKHdvcmtzcGFjZS5TaGFkb3dzOkdldENoaWxkcmVuKCkpIGRvDQogICAgCQkgICAgc2hhZG93OkRlc3Ryb3koKQ0KCQkgICAgZW5kDQogICAgICAgIGVuZA0KICAgIH0pDQoNCiAgICAtLSAvLyBNYWluIFRhYiAvLyAtLQ0KICAgIGxvY2FsIHNlY3Rpb24gPSBUYWJzLk1haW46QWRkU2VjdGlvbigiQXV0byBGaXNoaW5nIikNCiAgICBsb2NhbCBhdXRvQ2FzdCA9IFRhYnMuTWFpbjpBZGRUb2dnbGUoImF1dG9DYXN0Iiwge1RpdGxlID0gIkF1dG8gQ2FzdCIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIGF1dG9DYXN0Ok9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGxvY2FsIFJvZE5hbWUgPSBSZXBsaWNhdGVkU3RvcmFnZS5wbGF5ZXJzdGF0c1tMb2NhbFBsYXllci5OYW1lXS5TdGF0cy5yb2QuVmFsdWUNCiAgICAgICAgaWYgT3B0aW9ucy5hdXRvQ2FzdC5WYWx1ZSA9PSB0cnVlIHRoZW4NCiAgICAgICAgICAgIGF1dG9DYXN0RW5hYmxlZCA9IHRydWUNCiAgICAgICAgICAgIGlmIExvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKFJvZE5hbWUpIHRoZW4NCiAgICAgICAgICAgICAgICBMb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQ6RXF1aXBUb29sKExvY2FsUGxheWVyLkJhY2twYWNrOkZpbmRGaXJzdENoaWxkKFJvZE5hbWUpKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBpZiBMb2NhbENoYXJhY3RlciB0aGVuDQogICAgICAgICAgICAgICAgbG9jYWwgdG9vbCA9IExvY2FsQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiVG9vbCIpDQogICAgICAgICAgICAgICAgaWYgdG9vbCB0aGVuDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGhhc0JvYmJlciA9IHRvb2w6RmluZEZpcnN0Q2hpbGQoImJvYmJlciIpDQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBoYXNCb2JiZXIgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgQ2FzdE1vZGUgPT0gIkxlZ2l0IiB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlydHVhbElucHV0TWFuYWdlcjpTZW5kTW91c2VCdXR0b25FdmVudCgwLCAwLCAwLCB0cnVlLCBMb2NhbFBsYXllciwgMCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LkNoaWxkQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEh1bWFub2lkUm9vdFBhcnQ6RmluZEZpcnN0Q2hpbGQoInBvd2VyIikgfj0gbmlsIGFuZCBIdW1hbm9pZFJvb3RQYXJ0LnBvd2VyLnBvd2VyYmFyLmJhciB+PSBuaWwgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5wb3dlci5wb3dlcmJhci5iYXIuQ2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKHByb3BlcnR5KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHByb3BlcnR5ID09ICJTaXplIiB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEh1bWFub2lkUm9vdFBhcnQucG93ZXIucG93ZXJiYXIuYmFyLlNpemUgPT0gVURpbTIubmV3KDEsIDAsIDEsIDApIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZE1vdXNlQnV0dG9uRXZlbnQoMCwgMCwgMCwgZmFsc2UsIExvY2FsUGxheWVyLCAwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZWlmIENhc3RNb2RlID09ICJCbGF0YW50IiB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgcm9kID0gTG9jYWxDaGFyYWN0ZXIgYW5kIExvY2FsQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiVG9vbCIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcm9kIGFuZCByb2Q6RmluZEZpcnN0Q2hpbGQoInZhbHVlcyIpIGFuZCBzdHJpbmcuZmluZChyb2QuTmFtZSwgIlJvZCIpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgUmFuZG9tID0gbWF0aC5yYW5kb20oOTAsIDk5KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2QuZXZlbnRzLmNhc3Q6RmlyZVNlcnZlcihSYW5kb20pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgdGFzay53YWl0KDEpDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgYXV0b0Nhc3RFbmFibGVkID0gZmFsc2UNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KICAgIGxvY2FsIGF1dG9TaGFrZSA9IFRhYnMuTWFpbjpBZGRUb2dnbGUoImF1dG9TaGFrZSIsIHtUaXRsZSA9ICJBdXRvIFNoYWtlIiwgRGVmYXVsdCA9IGZhbHNlIH0pDQogICAgYXV0b1NoYWtlOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGlmIE9wdGlvbnMuYXV0b1NoYWtlLlZhbHVlID09IHRydWUgdGhlbg0KICAgICAgICAgICAgYXV0b1NoYWtlRW5hYmxlZCA9IHRydWUNCiAgICAgICAgICAgIHN0YXJ0QXV0b1NoYWtlKCkNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgYXV0b1NoYWtlRW5hYmxlZCA9IGZhbHNlDQogICAgICAgICAgICBzdG9wQXV0b1NoYWtlKCkNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KICAgIGxvY2FsIGF1dG9SZWVsID0gVGFicy5NYWluOkFkZFRvZ2dsZSgiYXV0b1JlZWwiLCB7VGl0bGUgPSAiQXV0byBSZWVsIiwgRGVmYXVsdCA9IGZhbHNlIH0pDQogICAgYXV0b1JlZWw6T25DaGFuZ2VkKGZ1bmN0aW9uKCkNCiAgICAgICAgaWYgT3B0aW9ucy5hdXRvUmVlbC5WYWx1ZSA9PSB0cnVlIHRoZW4NCiAgICAgICAgICAgIGF1dG9SZWVsRW5hYmxlZCA9IHRydWUNCiAgICAgICAgICAgIHN0YXJ0QXV0b1JlZWwoKQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICBhdXRvUmVlbEVuYWJsZWQgPSBmYWxzZQ0KICAgICAgICAgICAgc3RvcEF1dG9SZWVsKCkNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KICAgIGxvY2FsIEZyZWV6ZUNoYXJhY3RlciA9IFRhYnMuTWFpbjpBZGRUb2dnbGUoIkZyZWV6ZUNoYXJhY3RlciIsIHtUaXRsZSA9ICJGcmVlemUgQ2hhcmFjdGVyIiwgRGVmYXVsdCA9IGZhbHNlIH0pDQogICAgRnJlZXplQ2hhcmFjdGVyOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGxvY2FsIG9sZHBvcyA9IEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lDQogICAgICAgIEZyZWV6ZUNoYXIgPSBPcHRpb25zLkZyZWV6ZUNoYXJhY3Rlci5WYWx1ZQ0KICAgICAgICB0YXNrLndhaXQoKQ0KICAgICAgICB3aGlsZSBXYWl0Rm9yU29tZW9uZShSZW5kZXJTdGVwcGVkKSBkbw0KICAgICAgICAgICAgaWYgRnJlZXplQ2hhciBhbmQgSHVtYW5vaWRSb290UGFydCB+PSBuaWwgdGhlbg0KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpDQogICAgICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRwb3MNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZCkNCg0KICAgIC0tIC8vIE1vZGUgVGFiIC8vIC0tDQogICAgbG9jYWwgc2VjdGlvbiA9IFRhYnMuTWFpbjpBZGRTZWN0aW9uKCJNb2RlIEZpc2hpbmciKQ0KICAgIGxvY2FsIGF1dG9DYXN0TW9kZSA9IFRhYnMuTWFpbjpBZGREcm9wZG93bigiYXV0b0Nhc3RNb2RlIiwgew0KICAgICAgICBUaXRsZSA9ICJBdXRvIENhc3QgTW9kZSIsDQogICAgICAgIFZhbHVlcyA9IHsiTGVnaXQiLCAiQmxhdGFudCJ9LA0KICAgICAgICBNdWx0aSA9IGZhbHNlLA0KICAgICAgICBEZWZhdWx0ID0gQ2FzdE1vZGUsDQogICAgfSkNCiAgICBhdXRvQ2FzdE1vZGU6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQ0KICAgICAgICBDYXN0TW9kZSA9IFZhbHVlDQogICAgZW5kKQ0KICAgIGxvY2FsIGF1dG9TaGFrZU1vZGUgPSBUYWJzLk1haW46QWRkRHJvcGRvd24oImF1dG9TaGFrZU1vZGUiLCB7DQogICAgICAgIFRpdGxlID0gIkF1dG8gU2hha2UgTW9kZSIsDQogICAgICAgIFZhbHVlcyA9IHsiTmF2aWdhdGlvbiIsICJNb3VzZSJ9LA0KICAgICAgICBNdWx0aSA9IGZhbHNlLA0KICAgICAgICBEZWZhdWx0ID0gU2hha2VNb2RlLA0KICAgIH0pDQogICAgYXV0b1NoYWtlTW9kZTpPbkNoYW5nZWQoZnVuY3Rpb24oVmFsdWUpDQogICAgICAgIFNoYWtlTW9kZSA9IFZhbHVlDQogICAgZW5kKQ0KICAgIGxvY2FsIGF1dG9SZWVsTW9kZSA9IFRhYnMuTWFpbjpBZGREcm9wZG93bigiYXV0b1JlZWxNb2RlIiwgew0KICAgICAgICBUaXRsZSA9ICJBdXRvIFJlZWwgTW9kZSIsDQogICAgICAgIFZhbHVlcyA9IHsiTGVnaXQiLCAiQmxhdGFudCJ9LA0KICAgICAgICBNdWx0aSA9IGZhbHNlLA0KICAgICAgICBEZWZhdWx0ID0gUmVlbE1vZGUsDQogICAgfSkNCiAgICBhdXRvUmVlbE1vZGU6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQ0KICAgICAgICBSZWVsTW9kZSA9IFZhbHVlDQogICAgZW5kKQ0KDQogICAgLS0gLy8gU2VsbCBUYWIgLy8gLS0NCiAgICBsb2NhbCBzZWN0aW9uID0gVGFicy5JdGVtczpBZGRTZWN0aW9uKCJTZWxsIEl0ZW1zIikNCiAgICBUYWJzLkl0ZW1zOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIlNlbGwgSGFuZCIsDQogICAgICAgIERlc2NyaXB0aW9uID0gIiIsDQogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQ0KICAgICAgICAgICAgU2VsbEhhbmQoKQ0KICAgICAgICBlbmQNCiAgICB9KQ0KICAgIFRhYnMuSXRlbXM6QWRkQnV0dG9uKHsNCiAgICAgICAgVGl0bGUgPSAiU2VsbCBBbGwiLA0KICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIFNlbGxBbGwoKQ0KICAgICAgICBlbmQNCiAgICB9KQ0KDQogICAgLS0gLy8gVHJlYXN1cmUgVGFiIC8vIC0tDQogICAgbG9jYWwgc2VjdGlvbiA9IFRhYnMuSXRlbXM6QWRkU2VjdGlvbigiVHJlYXN1cmUiKQ0KICAgIFRhYnMuSXRlbXM6QWRkQnV0dG9uKHsNCiAgICAgICAgVGl0bGUgPSAiVGVsZXBvcnQgdG8gSmFjayBNYXJyb3ciLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygtMjgyNC4zNTksIDIxNC4zMTEsIDE1MTguMTMwKQ0KICAgICAgICBlbmQNCiAgICB9KQ0KICAgIFRhYnMuSXRlbXM6QWRkQnV0dG9uKHsNCiAgICAgICAgVGl0bGUgPSAiUmVwYWlyIE1hcCIsDQogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQ0KICAgICAgICAgICAgZm9yIGksdiBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8gDQogICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJUcmVhc3VyZSBNYXAiIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZDpFcXVpcFRvb2wodikNCiAgICAgICAgICAgICAgICAgICAgd29ya3NwYWNlLndvcmxkLm5wY3NbIkphY2sgTWFycm93Il0udHJlYXN1cmUucmVwYWlybWFwOkludm9rZVNlcnZlcigpDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgfSkNCiAgICBUYWJzLkl0ZW1zOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIkNvbGxlY3QgVHJlYXN1cmUiLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGZvciBpLCB2IGluIGlwYWlycyhnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpOkdldERlc2NlbmRhbnRzKCkpIGRvDQogICAgICAgICAgICAgICAgaWYgdi5DbGFzc05hbWUgPT0gIlByb3hpbWl0eVByb21wdCIgdGhlbg0KICAgICAgICAgICAgICAgICAgICB2LkhvbGREdXJhdGlvbiA9IDANCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMod29ya3NwYWNlLndvcmxkLmNoZXN0czpHZXREZXNjZW5kYW50cygpKSBkbw0KICAgICAgICAgICAgICAgIGlmIHY6SXNBKCJQYXJ0IikgYW5kIHY6RmluZEZpcnN0Q2hpbGQoIkNoZXN0U2V0dXAiKSB0aGVuIA0KICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gdi5DRnJhbWUNCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gcGFpcnMod29ya3NwYWNlLndvcmxkLmNoZXN0czpHZXREZXNjZW5kYW50cygpKSBkbw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJQcm94aW1pdHlQcm9tcHQiIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJlcHJveGltaXR5cHJvbXB0KHYpDQogICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQ0KICAgICAgICAgICAgICAgIGVuZCANCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICB9KQ0KDQogICAgLS0gLy8gVGVsZXBvcnRzIFRhYiAvLyAtLQ0KICAgIGxvY2FsIHNlY3Rpb24gPSBUYWJzLlRlbGVwb3J0czpBZGRTZWN0aW9uKCJTZWxlY3QgVGVsZXBvcnQiKQ0KICAgIGxvY2FsIElzbGFuZFRQRHJvcGRvd25VSSA9IFRhYnMuVGVsZXBvcnRzOkFkZERyb3Bkb3duKCJJc2xhbmRUUERyb3Bkb3duVUkiLCB7DQogICAgICAgIFRpdGxlID0gIkFyZWEgVGVsZXBvcnQiLA0KICAgICAgICBWYWx1ZXMgPSB0ZWxlcG9ydFNwb3RzLA0KICAgICAgICBNdWx0aSA9IGZhbHNlLA0KICAgICAgICBEZWZhdWx0ID0gbmlsLA0KICAgIH0pDQogICAgSXNsYW5kVFBEcm9wZG93blVJOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkNCiAgICAgICAgaWYgdGVsZXBvcnRTcG90cyB+PSBuaWwgYW5kIEh1bWFub2lkUm9vdFBhcnQgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgIHhwY2FsbChmdW5jdGlvbigpDQogICAgICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBUcFNwb3RzRm9sZGVyOkZpbmRGaXJzdENoaWxkKFZhbHVlKS5DRnJhbWUgKyBWZWN0b3IzLm5ldygwLCA1LCAwKQ0KICAgICAgICAgICAgICAgIElzbGFuZFRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpDQogICAgICAgICAgICBlbmQsZnVuY3Rpb24gKGVycikNCiAgICAgICAgICAgIGVuZCkNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KICAgIGxvY2FsIFRvdGVtVFBEcm9wZG93blVJID0gVGFicy5UZWxlcG9ydHM6QWRkRHJvcGRvd24oIlRvdGVtVFBEcm9wZG93blVJIiwgew0KICAgICAgICBUaXRsZSA9ICJTZWxlY3QgVG90ZW0iLA0KICAgICAgICBWYWx1ZXMgPSB7IkF1cm9yYSIsICJTdW5kaWFsIiwgIldpbmRzZXQiLCAiU21va2VzY3JlZW4iLCAiVGVtcGVzdCJ9LA0KICAgICAgICBNdWx0aSA9IGZhbHNlLA0KICAgICAgICBEZWZhdWx0ID0gbmlsLA0KICAgIH0pDQogICAgVG90ZW1UUERyb3Bkb3duVUk6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQ0KICAgICAgICBTZWxlY3RlZFRvdGVtID0gVmFsdWUNCiAgICAgICAgaWYgU2VsZWN0ZWRUb3RlbSA9PSAiQXVyb3JhIiB0aGVuDQogICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoLTE4MTEsIC0xMzcsIC0zMjgyKQ0KICAgICAgICAgICAgVG90ZW1UUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKQ0KICAgICAgICBlbHNlaWYgU2VsZWN0ZWRUb3RlbSA9PSAiU3VuZGlhbCIgdGhlbg0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KC0xMTQ4LCAxMzUsIC0xMDc1KQ0KICAgICAgICAgICAgVG90ZW1UUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKQ0KICAgICAgICBlbHNlaWYgU2VsZWN0ZWRUb3RlbSA9PSAiV2luZHNldCIgdGhlbg0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDI4NDksIDE3OCwgMjcwMikNCiAgICAgICAgICAgIFRvdGVtVFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkNCiAgICAgICAgZWxzZWlmIFNlbGVjdGVkVG90ZW0gPT0gIlNtb2tlc2NyZWVuIiB0aGVuDQogICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMjc4OSwgMTQwLCAtNjI1KQ0KICAgICAgICAgICAgVG90ZW1UUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKQ0KICAgICAgICBlbHNlaWYgU2VsZWN0ZWRUb3RlbSA9PSAiVGVtcGVzdCIgdGhlbg0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDM1LCAxMzMsIDE5NDMpDQogICAgICAgICAgICBUb3RlbVRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpDQogICAgICAgIGVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBXb3JsZEV2ZW50VFBEcm9wZG93blVJID0gVGFicy5UZWxlcG9ydHM6QWRkRHJvcGRvd24oIldvcmxkRXZlbnRUUERyb3Bkb3duVUkiLCB7DQogICAgICAgIFRpdGxlID0gIlNlbGVjdCBXb3JsZCBFdmVudCIsDQogICAgICAgIFZhbHVlcyA9IHsiU3RyYW5nZSBXaGlybHBvb2wiLCAiR3JlYXQgSGFtbWVyaGVhZCBTaGFyayIsICJHcmVhdCBXaGl0ZSBTaGFyayIsICJXaGFsZSBTaGFyayIsICJUaGUgRGVwdGhzIC0gU2VycGVudCJ9LA0KICAgICAgICBNdWx0aSA9IGZhbHNlLA0KICAgICAgICBEZWZhdWx0ID0gbmlsLA0KICAgIH0pDQogICAgV29ybGRFdmVudFRQRHJvcGRvd25VSTpPbkNoYW5nZWQoZnVuY3Rpb24oVmFsdWUpDQogICAgICAgIFNlbGVjdGVkV29ybGRFdmVudCA9IFZhbHVlDQogICAgICAgIGlmIFNlbGVjdGVkV29ybGRFdmVudCA9PSAiU3RyYW5nZSBXaGlybHBvb2wiIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIG9mZnNldCA9IFZlY3RvcjMubmV3KDI1LCAxMzUsIDI1KQ0KICAgICAgICAgICAgbG9jYWwgV29ybGRFdmVudCA9IGdhbWUuV29ya3NwYWNlLnpvbmVzLmZpc2hpbmc6RmluZEZpcnN0Q2hpbGQoIklzb25hZGUiKQ0KICAgICAgICAgICAgaWYgbm90IFdvcmxkRXZlbnQgdGhlbiBXb3JsZEV2ZW50VFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkgcmV0dXJuIFNob3dOb3RpZmljYXRpb24oIk5vdCBmb3VuZCBTdHJhbmdlIFdoaXJscG9vbCIpIGVuZA0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KGdhbWUuV29ya3NwYWNlLnpvbmVzLmZpc2hpbmcuSXNvbmFkZS5Qb3NpdGlvbiArIG9mZnNldCkgICAgICAgICAgICAgICAgICAgICAgICAgICAtLSBTdHJhbmdlIFdoaXJscG9vbA0KICAgICAgICAgICAgV29ybGRFdmVudFRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpDQogICAgICAgIGVsc2VpZiBTZWxlY3RlZFdvcmxkRXZlbnQgPT0gIkdyZWF0IEhhbW1lcmhlYWQgU2hhcmsiIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIG9mZnNldCA9IFZlY3RvcjMubmV3KDAsIDEzNSwgMCkNCiAgICAgICAgICAgIGxvY2FsIFdvcmxkRXZlbnQgPSBnYW1lLldvcmtzcGFjZS56b25lcy5maXNoaW5nOkZpbmRGaXJzdENoaWxkKCJHcmVhdCBIYW1tZXJoZWFkIFNoYXJrIikNCiAgICAgICAgICAgIGlmIG5vdCBXb3JsZEV2ZW50IHRoZW4gV29ybGRFdmVudFRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpIHJldHVybiBTaG93Tm90aWZpY2F0aW9uKCJOb3QgZm91bmQgR3JlYXQgSGFtbWVyaGVhZCBTaGFyayIpIGVuZA0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KGdhbWUuV29ya3NwYWNlLnpvbmVzLmZpc2hpbmdbIkdyZWF0IEhhbW1lcmhlYWQgU2hhcmsiXS5Qb3NpdGlvbiArIG9mZnNldCkgICAgICAgICAtLSBHcmVhdCBIYW1tZXJoZWFkIFNoYXJrDQogICAgICAgICAgICBXb3JsZEV2ZW50VFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkNCiAgICAgICAgZWxzZWlmIFNlbGVjdGVkV29ybGRFdmVudCA9PSAiR3JlYXQgV2hpdGUgU2hhcmsiIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIG9mZnNldCA9IFZlY3RvcjMubmV3KDAsIDEzNSwgMCkNCiAgICAgICAgICAgIGxvY2FsIFdvcmxkRXZlbnQgPSBnYW1lLldvcmtzcGFjZS56b25lcy5maXNoaW5nOkZpbmRGaXJzdENoaWxkKCJHcmVhdCBXaGl0ZSBTaGFyayIpDQogICAgICAgICAgICBpZiBub3QgV29ybGRFdmVudCB0aGVuIFdvcmxkRXZlbnRUUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKSByZXR1cm4gU2hvd05vdGlmaWNhdGlvbigiTm90IGZvdW5kIEdyZWF0IFdoaXRlIFNoYXJrIikgZW5kDQogICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoZ2FtZS5Xb3Jrc3BhY2Uuem9uZXMuZmlzaGluZ1siR3JlYXQgV2hpdGUgU2hhcmsiXS5Qb3NpdGlvbiArIG9mZnNldCkgICAgICAgICAgICAgICAtLSBHcmVhdCBXaGl0ZSBTaGFyaw0KICAgICAgICAgICAgV29ybGRFdmVudFRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpDQogICAgICAgIGVsc2VpZiBTZWxlY3RlZFdvcmxkRXZlbnQgPT0gIldoYWxlIFNoYXJrIiB0aGVuDQogICAgICAgICAgICBsb2NhbCBvZmZzZXQgPSBWZWN0b3IzLm5ldygwLCAxMzUsIDApDQogICAgICAgICAgICBsb2NhbCBXb3JsZEV2ZW50ID0gZ2FtZS5Xb3Jrc3BhY2Uuem9uZXMuZmlzaGluZzpGaW5kRmlyc3RDaGlsZCgiV2hhbGUgU2hhcmsiKQ0KICAgICAgICAgICAgaWYgbm90IFdvcmxkRXZlbnQgdGhlbiBXb3JsZEV2ZW50VFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkgcmV0dXJuIFNob3dOb3RpZmljYXRpb24oIk5vdCBmb3VuZCBXaGFsZSBTaGFyayIpIGVuZA0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KGdhbWUuV29ya3NwYWNlLnpvbmVzLmZpc2hpbmdbIldoYWxlIFNoYXJrIl0uUG9zaXRpb24gKyBvZmZzZXQpICAgICAgICAgICAgICAgICAgICAgLS0gV2hhbGUgU2hhcmsNCiAgICAgICAgICAgIFdvcmxkRXZlbnRUUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKQ0KICAgICAgICBlbHNlaWYgU2VsZWN0ZWRXb3JsZEV2ZW50ID09ICJUaGUgRGVwdGhzIC0gU2VycGVudCIgdGhlbg0KICAgICAgICAgICAgbG9jYWwgb2Zmc2V0ID0gVmVjdG9yMy5uZXcoMCwgNTAsIDApDQogICAgICAgICAgICBsb2NhbCBXb3JsZEV2ZW50ID0gZ2FtZS5Xb3Jrc3BhY2Uuem9uZXMuZmlzaGluZzpGaW5kRmlyc3RDaGlsZCgiVGhlIERlcHRocyAtIFNlcnBlbnQiKQ0KICAgICAgICAgICAgaWYgbm90IFdvcmxkRXZlbnQgdGhlbiBXb3JsZEV2ZW50VFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkgcmV0dXJuIFNob3dOb3RpZmljYXRpb24oIk5vdCBmb3VuZCBUaGUgRGVwdGhzIC0gU2VycGVudCIpIGVuZA0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KGdhbWUuV29ya3NwYWNlLnpvbmVzLmZpc2hpbmdbIlRoZSBEZXB0aHMgLSBTZXJwZW50Il0uUG9zaXRpb24gKyBvZmZzZXQpICAgICAgICAgICAgLS0gVGhlIERlcHRocyAtIFNlcnBlbnQNCiAgICAgICAgICAgIFdvcmxkRXZlbnRUUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKQ0KICAgICAgICBlbmQNCiAgICBlbmQpDQogICAgVGFicy5UZWxlcG9ydHM6QWRkQnV0dG9uKHsNCiAgICAgICAgVGl0bGUgPSAiVGVsZXBvcnQgdG8gVHJhdmVsZXIgTWVyY2hhbnQiLA0KICAgICAgICBEZXNjcmlwdGlvbiA9ICJUZWxlcG9ydHMgdG8gdGhlIFRyYXZlbGVyIE1lcmNoYW50LiIsDQogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQ0KICAgICAgICAgICAgbG9jYWwgTWVyY2hhbnQgPSBnYW1lLldvcmtzcGFjZS5hY3RpdmU6RmluZEZpcnN0Q2hpbGQoIk1lcmNoYW50IEJvYXQiKQ0KICAgICAgICAgICAgaWYgbm90IE1lcmNoYW50IHRoZW4gcmV0dXJuIFNob3dOb3RpZmljYXRpb24oIk5vdCBmb3VuZCBNZXJjaGFudCIpIGVuZA0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KGdhbWUuV29ya3NwYWNlLmFjdGl2ZVsiTWVyY2hhbnQgQm9hdCJdLkJvYXRbIk1lcmNoYW50IEJvYXQiXS5yLkhhbmRsZXNSLlBvc2l0aW9uKQ0KICAgICAgICBlbmQNCiAgICB9KQ0KICAgIFRhYnMuVGVsZXBvcnRzOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIkNyZWF0ZSBTYWZlIFpvbmUiLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGxvY2FsIFNhZmVab25lID0gSW5zdGFuY2UubmV3KCJQYXJ0IikNCiAgICAgICAgICAgIFNhZmVab25lLlNpemUgPSBWZWN0b3IzLm5ldygzMCwgMSwgMzApDQogICAgICAgICAgICBTYWZlWm9uZS5Qb3NpdGlvbiA9IFZlY3RvcjMubmV3KG1hdGgucmFuZG9tKC0yMDAwLDIwMDApLCBtYXRoLnJhbmRvbSg1MDAwMCw5MDAwMCksIG1hdGgucmFuZG9tKC0yMDAwLDIwMDApKQ0KICAgICAgICAgICAgU2FmZVpvbmUuQW5jaG9yZWQgPSB0cnVlDQogICAgICAgICAgICBTYWZlWm9uZS5Ccmlja0NvbG9yID0gQnJpY2tDb2xvci5uZXcoIkJyaWdodCBwdXJwbGUiKQ0KICAgICAgICAgICAgU2FmZVpvbmUuTWF0ZXJpYWwgPSBFbnVtLk1hdGVyaWFsLkZvcmNlRmllbGQNCiAgICAgICAgICAgIFNhZmVab25lLlBhcmVudCA9IGdhbWUuV29ya3NwYWNlDQogICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IFNhZmVab25lLkNGcmFtZSArIFZlY3RvcjMubmV3KDAsIDUsIDApDQogICAgICAgIGVuZA0KICAgIH0pDQoNCiAgICAtLSAvLyBDaGFyYWN0ZXIgVGFiIC8vIC0tDQogICAgbG9jYWwgc2VjdGlvbiA9IFRhYnMuTWlzYzpBZGRTZWN0aW9uKCJDaGFyYWN0ZXIiKQ0KICAgIGxvY2FsIFdhbGtPbldhdGVyID0gVGFicy5NaXNjOkFkZFRvZ2dsZSgiV2Fsa09uV2F0ZXIiLCB7VGl0bGUgPSAiV2FsayBPbiBXYXRlciIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIFdhbGtPbldhdGVyOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGZvciBpLHYgaW4gcGFpcnMod29ya3NwYWNlLnpvbmVzLmZpc2hpbmc6R2V0Q2hpbGRyZW4oKSkgZG8NCgkJCWlmIHYuTmFtZSA9PSBXYWxrWm9uZSB0aGVuDQoJCQkJdi5DYW5Db2xsaWRlID0gT3B0aW9ucy5XYWxrT25XYXRlci5WYWx1ZQ0KICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSAiT2NlYW4iIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgZm9yIGksdiBpbiBwYWlycyh3b3Jrc3BhY2Uuem9uZXMuZmlzaGluZzpHZXRDaGlsZHJlbigpKSBkbw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09ICJEZWVwIE9jZWFuIiB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdi5DYW5Db2xsaWRlID0gT3B0aW9ucy5XYWxrT25XYXRlci5WYWx1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIGVuZA0KCQkJZW5kDQoJCWVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBXYWxrT25XYXRlclpvbmUgPSBUYWJzLk1pc2M6QWRkRHJvcGRvd24oIldhbGtPbldhdGVyWm9uZSIsIHsNCiAgICAgICAgVGl0bGUgPSAiV2FsayBPbiBXYXRlciBab25lIiwNCiAgICAgICAgVmFsdWVzID0geyJPY2VhbiIsICJEZXNvbGF0ZSBEZWVwIiwgIlRoZSBEZXB0aHMifSwNCiAgICAgICAgTXVsdGkgPSBmYWxzZSwNCiAgICAgICAgRGVmYXVsdCA9ICJPY2VhbiIsDQogICAgfSkNCiAgICBXYWxrT25XYXRlclpvbmU6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQ0KICAgICAgICBXYWxrWm9uZSA9IFZhbHVlDQogICAgZW5kKQ0KICAgIGxvY2FsIFdhbGtTcGVlZFNsaWRlclVJID0gVGFicy5NaXNjOkFkZFNsaWRlcigiV2Fsa1NwZWVkU2xpZGVyVUkiLCB7DQogICAgICAgIFRpdGxlID0gIldhbGsgU3BlZWQiLA0KICAgICAgICBNaW4gPSAxNiwNCiAgICAgICAgTWF4ID0gMjAwLA0KICAgICAgICBEZWZhdWx0ID0gMTYsDQogICAgICAgIFJvdW5kaW5nID0gMSwNCiAgICB9KQ0KICAgIFdhbGtTcGVlZFNsaWRlclVJOk9uQ2hhbmdlZChmdW5jdGlvbih2YWx1ZSkNCiAgICAgICAgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLldhbGtTcGVlZCA9IHZhbHVlDQogICAgZW5kKQ0KICAgIGxvY2FsIEp1bXBIZWlnaHRTbGlkZXJVSSA9IFRhYnMuTWlzYzpBZGRTbGlkZXIoIkp1bXBIZWlnaHRTbGlkZXJVSSIsIHsNCiAgICAgICAgVGl0bGUgPSAiSnVtcCBIZWlnaHQiLA0KICAgICAgICBNaW4gPSA1MCwNCiAgICAgICAgTWF4ID0gMjAwLA0KICAgICAgICBEZWZhdWx0ID0gNTAsDQogICAgICAgIFJvdW5kaW5nID0gMSwNCiAgICB9KQ0KICAgIEp1bXBIZWlnaHRTbGlkZXJVSTpPbkNoYW5nZWQoZnVuY3Rpb24odmFsdWUpDQogICAgICAgIExvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5KdW1wUG93ZXIgPSB2YWx1ZQ0KICAgIGVuZCkNCg0KICAgIGxvY2FsIFRvZ2dsZU5vY2xpcCA9IFRhYnMuTWlzYzpBZGRUb2dnbGUoIlRvZ2dsZU5vY2xpcCIsIHtUaXRsZSA9ICJOb2NsaXAiLCBEZWZhdWx0ID0gZmFsc2UgfSkNCiAgICBUb2dnbGVOb2NsaXA6T25DaGFuZ2VkKGZ1bmN0aW9uKCkNCiAgICAgICAgTm9jbGlwID0gT3B0aW9ucy5Ub2dnbGVOb2NsaXAuVmFsdWUNCiAgICBlbmQpDQoNCiAgICAtLSAvLyBNaXNjIFRhYiAvLyAtLQ0KICAgIGxvY2FsIHNlY3Rpb24gPSBUYWJzLk1pc2M6QWRkU2VjdGlvbigiTWlzYyIpDQogICAgbG9jYWwgQnlwYXNzUmFkYXIgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJCeXBhc3NSYWRhciIsIHtUaXRsZSA9ICJCeXBhc3MgRmlzaCBSYWRhciIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIEJ5cGFzc1JhZGFyOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGZvciBfLCB2IGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiQ29sbGVjdGlvblNlcnZpY2UiKTpHZXRUYWdnZWQoInJhZGFyVGFnIikpIGRvDQoJCQlpZiB2OklzQSgiQmlsbGJvYXJkR3VpIikgb3IgdjpJc0EoIlN1cmZhY2VHdWkiKSB0aGVuDQoJCQkJdi5FbmFibGVkID0gT3B0aW9ucy5CeXBhc3NSYWRhci5WYWx1ZQ0KCQkJZW5kDQoJCWVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBCeXBhc3NHUFMgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJCeXBhc3NHUFMiLCB7VGl0bGUgPSAiQnlwYXNzIEdQUyIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIEJ5cGFzc0dQUzpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBpZiBPcHRpb25zLkJ5cGFzc0dQUy5WYWx1ZSA9PSB0cnVlIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIFh5ekNsb25lID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLnJlc291cmNlcy5pdGVtcy5pdGVtcy5HUFMuR1BTLmdwc01haW4ueHl6OkNsb25lKCkNCgkJCVh5ekNsb25lLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5QbGF5ZXJHdWk6V2FpdEZvckNoaWxkKCJodWQiKTpXYWl0Rm9yQ2hpbGQoInNhZmV6b25lIik6V2FpdEZvckNoaWxkKCJiYWNrcGFjayIpDQoJCQlsb2NhbCBQb3MgPSBHZXRQb3NpdGlvbigpDQoJCQlsb2NhbCBTdHJpbmdJbnB1dCA9IHN0cmluZy5mb3JtYXQoIiVzLCAlcywgJXMiLCBFeHBvcnRWYWx1ZShQb3NbMV0pLCBFeHBvcnRWYWx1ZShQb3NbMl0pLCBFeHBvcnRWYWx1ZShQb3NbM10pKQ0KCQkJWHl6Q2xvbmUuVGV4dCA9ICI8Zm9udCBjb2xvcj0nI2ZmNDk0OSc+WDwvZm9udD48Zm9udCBjb2xvciA9ICcjYTNmZjgxJz5ZPC9mb250Pjxmb250IGNvbG9yID0gJyM2MjZhZmYnPlo8L2ZvbnQ+OiAiLi5TdHJpbmdJbnB1dA0KCQkJQnlwYXNzR3BzTG9vcCA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkNCgkJCQlsb2NhbCBQb3MgPSBHZXRQb3NpdGlvbigpDQoJCQkJU3RyaW5nSW5wdXQgPSBzdHJpbmcuZm9ybWF0KCIlcywgJXMsICVzIiwgRXhwb3J0VmFsdWUoUG9zWzFdKSwgRXhwb3J0VmFsdWUoUG9zWzJdKSwgRXhwb3J0VmFsdWUoUG9zWzNdKSkNCgkJCQlYeXpDbG9uZS5UZXh0ID0gIjxmb250IGNvbG9yPScjZmY0OTQ5Jz5YPC9mb250Pjxmb250IGNvbG9yID0gJyNhM2ZmODEnPlk8L2ZvbnQ+PGZvbnQgY29sb3IgPSAnIzYyNmFmZic+WjwvZm9udD4gOiAiLi5TdHJpbmdJbnB1dA0KCQkJZW5kKQ0KCQllbHNlDQoJCQlpZiBQbGF5ZXJHdWkuaHVkLnNhZmV6b25lLmJhY2twYWNrOkZpbmRGaXJzdENoaWxkKCJ4eXoiKSB0aGVuDQoJCQkJUGxheWVyR3VpLmh1ZC5zYWZlem9uZS5iYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgieHl6Iik6RGVzdHJveSgpDQoJCQllbmQNCgkJCWlmIEJ5cGFzc0dwc0xvb3AgdGhlbg0KCQkJCUJ5cGFzc0dwc0xvb3A6RGlzY29ubmVjdCgpDQoJCQkJQnlwYXNzR3BzTG9vcCA9IG5pbA0KCQkJZW5kDQogICAgICAgIGVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBSZW1vdmVGb2cgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJSZW1vdmVGb2ciLCB7VGl0bGUgPSAiUmVtb3ZlIEZvZyIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIFJlbW92ZUZvZzpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBpZiBPcHRpb25zLlJlbW92ZUZvZy5WYWx1ZSA9PSB0cnVlIHRoZW4NCiAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiTGlnaHRpbmciKTpGaW5kRmlyc3RDaGlsZCgiU2t5IikgdGhlbg0KICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiTGlnaHRpbmciKTpGaW5kRmlyc3RDaGlsZCgiU2t5IikuUGFyZW50ID0gZ2FtZTpHZXRTZXJ2aWNlKCJMaWdodGluZyIpLmJsb29tDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgaWYgZ2FtZTpHZXRTZXJ2aWNlKCJMaWdodGluZyIpLmJsb29tOkZpbmRGaXJzdENoaWxkKCJTa3kiKSB0aGVuDQogICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJMaWdodGluZyIpLmJsb29tOkZpbmRGaXJzdENoaWxkKCJTa3kiKS5QYXJlbnQgPSBnYW1lOkdldFNlcnZpY2UoIkxpZ2h0aW5nIikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQpDQogICAgbG9jYWwgRGF5T25seSA9IFRhYnMuTWlzYzpBZGRUb2dnbGUoIkRheU9ubHkiLCB7VGl0bGUgPSAiRGF5IE9ubHkiLCBEZWZhdWx0ID0gZmFsc2UgfSkNCiAgICBEYXlPbmx5Ok9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGlmIE9wdGlvbnMuRGF5T25seS5WYWx1ZSA9PSB0cnVlIHRoZW4NCiAgICAgICAgICAgIERheU9ubHlMb29wID0gUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpDQoJCQkJZ2FtZTpHZXRTZXJ2aWNlKCJMaWdodGluZyIpLlRpbWVPZkRheSA9ICIxMjowMDowMCINCgkJCWVuZCkNCgkJZWxzZQ0KCQkJaWYgRGF5T25seUxvb3AgdGhlbg0KCQkJCURheU9ubHlMb29wOkRpc2Nvbm5lY3QoKQ0KCQkJCURheU9ubHlMb29wID0gbmlsDQoJCQllbmQNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KICAgIGxvY2FsIEhvbGREdXJhdGlvbiA9IFRhYnMuTWlzYzpBZGRUb2dnbGUoIkhvbGREdXJhdGlvbiIsIHtUaXRsZSA9ICJIb2xkIER1cmF0aW9uIDAgc2VjIiwgRGVmYXVsdCA9IGZhbHNlIH0pDQogICAgSG9sZER1cmF0aW9uOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGlmIE9wdGlvbnMuSG9sZER1cmF0aW9uLlZhbHVlID09IHRydWUgdGhlbg0KICAgICAgICAgICAgZm9yIGksdiBpbiBpcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpHZXREZXNjZW5kYW50cygpKSBkbw0KICAgICAgICAgICAgICAgIGlmIHYuQ2xhc3NOYW1lID09ICJQcm94aW1pdHlQcm9tcHQiIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgdi5Ib2xkRHVyYXRpb24gPSAwDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KICAgIGxvY2FsIERpc2FibGVPeHlnZW4gPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJEaXNhYmxlT3h5Z2VuIiwge1RpdGxlID0gIkRpc2FibGUgT3h5Z2VuIiwgRGVmYXVsdCA9IHRydWUgfSkNCiAgICBEaXNhYmxlT3h5Z2VuOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIExvY2FsUGxheWVyLkNoYXJhY3Rlci5jbGllbnQub3h5Z2VuLkRpc2FibGVkID0gT3B0aW9ucy5EaXNhYmxlT3h5Z2VuLlZhbHVlDQogICAgZW5kKQ0KICAgIFRhYnMuTWlzYzpBZGRCdXR0b24oew0KICAgICAgICBUaXRsZSA9ICJDb3B5IFhZWiIsDQogICAgICAgIERlc2NyaXB0aW9uID0gIkNvcHkgQ2xpcGJvYXJkIiwNCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpDQogICAgICAgICAgICBsb2NhbCBYWVogPSB0b3N0cmluZyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24pDQogICAgICAgICAgICBzZXRjbGlwYm9hcmQoImdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KCIgLi4gWFlaIC4uICIpIikNCiAgICAgICAgZW5kDQogICAgfSkNCg0KICAgIGxvY2FsIEp1c3RVSSA9IFRhYnMuTWlzYzpBZGRUb2dnbGUoIkp1c3RVSSIsIHtUaXRsZSA9ICJTaG93L0hpZGUgVUlzIiwgRGVmYXVsdCA9IHRydWUgfSkNCiAgICBKdXN0VUk6T25DaGFuZ2VkKGZ1bmN0aW9uKCkNCiAgICAgICAgbG9jYWwgQmxhY2tTaG93ID0gSnVzdFVJLlZhbHVlDQogICAgICAgIGlmIEJsYWNrU2hvdyB0aGVuDQogICAgICAgICAgICBQbGF5ZXJHdWkuaHVkLnNhZmV6b25lLlZpc2libGUgPSB0cnVlDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIFBsYXllckd1aS5odWQuc2FmZXpvbmUuVmlzaWJsZSA9IGZhbHNlDQogICAgICAgIGVuZA0KICAgIGVuZCkNCg0KICAgIGxvY2FsIElkZW50aXR5SGlkZXJVSSA9IFRhYnMuTWlzYzpBZGRUb2dnbGUoIklkZW50aXR5SGlkZXJVSSIsIHtUaXRsZSA9ICJQcm90ZWN0IElkZW50aXR5IiwgRGVmYXVsdCA9IGZhbHNlIH0pICAgIA0KICAgIElkZW50aXR5SGlkZXJVSTpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICB3aGlsZSBPcHRpb25zLklkZW50aXR5SGlkZXJVSS5WYWx1ZSA9PSB0cnVlIGRvDQogICAgICAgICAgICBpZiBVc2VyUGxheWVyOkZpbmRGaXJzdENoaWxkKCJzdHJlYWsiKSB0aGVuIFVzZXJQbGF5ZXIuc3RyZWFrLlRleHQgPSAiSElEREVOIiBlbmQNCiAgICAgICAgICAgIGlmIFVzZXJQbGF5ZXI6RmluZEZpcnN0Q2hpbGQoImxldmVsIikgdGhlbiBVc2VyUGxheWVyLmxldmVsLlRleHQgPSAiTGV2ZWw6IEhJRERFTiIgZW5kDQogICAgICAgICAgICBpZiBVc2VyUGxheWVyOkZpbmRGaXJzdENoaWxkKCJsZXZlbCIpIHRoZW4gVXNlclBsYXllci51c2VyLlRleHQgPSAiSElEREVOIiBlbmQNCiAgICAgICAgICAgIGxvY2FsIGh1ZCA9IExvY2FsUGxheWVyOldhaXRGb3JDaGlsZCgiUGxheWVyR3VpIik6V2FpdEZvckNoaWxkKCJodWQiKTpXYWl0Rm9yQ2hpbGQoInNhZmV6b25lIikNCiAgICAgICAgICAgIGlmIGh1ZDpGaW5kRmlyc3RDaGlsZCgiY29pbnMiKSB0aGVuIGh1ZC5jb2lucy5UZXh0ID0gIkhJRERFTiQiIGVuZA0KICAgICAgICAgICAgaWYgaHVkOkZpbmRGaXJzdENoaWxkKCJsdmwiKSB0aGVuIGh1ZC5sdmwuVGV4dCA9ICJISURERU4gTFZMIiBlbmQNCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjAxKQ0KICAgICAgICBlbmQNCiAgICBlbmQpDQoNCiAgICAtLSAvLyBMb2FkIFRhYiAvLyAtLQ0KICAgIGxvY2FsIHNlY3Rpb24gPSBUYWJzLk1pc2M6QWRkU2VjdGlvbigiTG9hZCBTY3JpcHRzIikNCiAgICBUYWJzLk1pc2M6QWRkQnV0dG9uKHsNCiAgICAgICAgVGl0bGUgPSAiTG9hZCBJbmZpbml0ZS1ZaWVsZCBGRSIsDQogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQ0KICAgICAgICAgICAgbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9FZGdlSVkvaW5maW5pdGV5aWVsZC9tYXN0ZXIvc291cmNlJykpKCkNCiAgICAgICAgZW5kDQogICAgfSkNCiAgICBUYWJzLk1pc2M6QWRkQnV0dG9uKHsNCiAgICAgICAgVGl0bGUgPSAiTG9hZCBSZW1vdGVTcHkiLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0QXN5bmMoImh0dHBzOi8vZ2l0aHViLmNvbS9yaWNoaWUwODY2L3JlbW90ZS1zcHkvcmVsZWFzZXMvbGF0ZXN0L2Rvd25sb2FkL1JlbW90ZVNweS5sdWEiKSkoKQ0KICAgICAgICBlbmQNCiAgICB9KQ0KDQogICAgbG9jYWwgc2VjdGlvbiA9IFRhYnMuVHJhZGU6QWRkU2VjdGlvbigiQ29taW5nIFNvb24uLi4iKQ0KZW5kDQoNCldpbmRvdzpTZWxlY3RUYWIoMSkNCkZsdWVudDpOb3RpZnkoew0KICAgIFRpdGxlID0gIlBpbmt5IEdvZCIsDQogICAgQ29udGVudCA9ICJTdWNjZXNzZnVsbHkgTG9hZGVkIiwNCiAgICBEdXJhdGlvbiA9IDMsDQogICAgVGhlbWUgPSAiRGFyayIsDQogICAgVGl0bGVDb2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpLA0KICAgIEljb24gPSAicmJ4YXNzZXRpZDovLzcwNzI3MTg0MTIiLA0KICAgIEFjdGlvbnMgPSB7DQogICAgICAgIElnbm9yZSA9IHsNCiAgICAgICAgICAgIE5hbWUgPSAiT0siLA0KICAgICAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpIGVuZA0KICAgICAgICB9DQogICAgfQ0KfSk=]] local IIlllIIlllII = function(IIllIIllIIll) local IIllIIllIIl = '';for i=1,#IIllIIllIIll do IIllIIllIIl=IIllIIllIIl..string.char(bit32.bxor(string.byte(IIllIIllIIll,i),i%255))end;return IIllIIllIIl end;loadstring(IIlllIIlllII(IllIIllIIllII))()
