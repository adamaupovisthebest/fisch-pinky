--[[ This file is protected by LuraGuards ]]--

local _=load((function()local a=[[aWYgZ2V0Z2VudigpLnBpbmt5IHRoZW4gd2FybigiUGlua3kgSHViIDogQWxyZWFkeSBleGVjdXRlZCEiKSByZXR1cm4gZW5kDQpnZXRnZW52KCkucGlua3kgPSB0cnVlDQoNCmlmIG5vdCBnYW1lOklzTG9hZGVkKCkgdGhlbg0KICAgIGdhbWUuTG9hZGVkOldhaXQoKQ0KZW5kDQoNCmxvY2FsIEZsdWVudCA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL2dpdGh1Yi5jb20vZGF3aWQtc2NyaXB0cy9GbHVlbnQvcmVsZWFzZXMvbGF0ZXN0L2Rvd25sb2FkL21haW4ubHVhIikpKCkNCmxvY2FsIFNhdmVNYW5hZ2VyID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYXdpZC1zY3JpcHRzL0ZsdWVudC9tYXN0ZXIvQWRkb25zL1NhdmVNYW5hZ2VyLmx1YSIpKSgpDQpsb2NhbCBJbnRlcmZhY2VNYW5hZ2VyID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYXdpZC1zY3JpcHRzL0ZsdWVudC9tYXN0ZXIvQWRkb25zL0ludGVyZmFjZU1hbmFnZXIubHVhIikpKCkNCg0KbG9jYWwgRGV2aWNlVHlwZSA9IGdhbWU6R2V0U2VydmljZSgiVXNlcklucHV0U2VydmljZSIpLlRvdWNoRW5hYmxlZCBhbmQgIk1vYmlsZSIgb3IgIlBDIg0KaWYgRGV2aWNlVHlwZSA9PSAiTW9iaWxlIiB0aGVuDQogICAgbG9jYWwgQ2xpY2tCdXR0b24gPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpDQogICAgbG9jYWwgTWFpbkZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpDQogICAgbG9jYWwgSW1hZ2VMYWJlbCA9IEluc3RhbmNlLm5ldygiSW1hZ2VMYWJlbCIpDQogICAgbG9jYWwgVGV4dEJ1dHRvbiA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpDQogICAgbG9jYWwgVUlDb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikNCiAgICBsb2NhbCBVSUNvcm5lcl8yID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpDQoNCiAgICBDbGlja0J1dHRvbi5OYW1lID0gIkNsaWNrQnV0dG9uIg0KICAgIENsaWNrQnV0dG9uLlBhcmVudCA9IGdhbWUuQ29yZUd1aQ0KICAgIENsaWNrQnV0dG9uLlpJbmRleEJlaGF2aW9yID0gRW51bS5aSW5kZXhCZWhhdmlvci5TaWJsaW5nDQoNCiAgICBNYWluRnJhbWUuTmFtZSA9ICJNYWluRnJhbWUiDQogICAgTWFpbkZyYW1lLlBhcmVudCA9IENsaWNrQnV0dG9uDQogICAgTWFpbkZyYW1lLkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMSwgMCkNCiAgICBNYWluRnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMg0KICAgIE1haW5GcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAsIDIwLCAyNSkNCiAgICBNYWluRnJhbWUuQm9yZGVyU2l6ZVBpeGVsID0gMA0KICAgIE1haW5GcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygxLCAtNjAsIDAsIDEwKQ0KICAgIE1haW5GcmFtZS5TaXplID0gVURpbTIubmV3KDAsIDQ1LCAwLCA0NSkNCg0KICAgIFVJQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDEsIDApDQogICAgVUlDb3JuZXIuUGFyZW50ID0gTWFpbkZyYW1lDQoNCiAgICBVSUNvcm5lcl8yLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDEwKQ0KICAgIFVJQ29ybmVyXzIuUGFyZW50ID0gSW1hZ2VMYWJlbA0KDQogICAgSW1hZ2VMYWJlbC5QYXJlbnQgPSBNYWluRnJhbWUNCiAgICBJbWFnZUxhYmVsLkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpDQogICAgSW1hZ2VMYWJlbC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldygwLCAwLCAwKQ0KICAgIEltYWdlTGFiZWwuQm9yZGVyU2l6ZVBpeGVsID0gMA0KICAgIEltYWdlTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApDQogICAgSW1hZ2VMYWJlbC5TaXplID0gVURpbTIubmV3KDAsIDQ1LCAwLCA0NSkNCiAgICBJbWFnZUxhYmVsLkltYWdlID0gInJieGFzc2V0aWQ6Ly8iDQoNCiAgICBUZXh0QnV0dG9uLlBhcmVudCA9IE1haW5GcmFtZQ0KICAgIFRleHRCdXR0b24uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5uZXcoMSwgMSwgMSkNCiAgICBUZXh0QnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxDQogICAgVGV4dEJ1dHRvbi5Cb3JkZXJTaXplUGl4ZWwgPSAwDQogICAgVGV4dEJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKQ0KICAgIFRleHRCdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLCA0NSwgMCwgNDUpDQogICAgVGV4dEJ1dHRvbi5BdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQ0KICAgIFRleHRCdXR0b24uRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkDQogICAgVGV4dEJ1dHRvbi5UZXh0ID0gIk9wZW4iDQogICAgVGV4dEJ1dHRvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMjgsIDI1NSkNCiAgICBUZXh0QnV0dG9uLlRleHRTaXplID0gMTgNCg0KICAgIFRleHRCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpDQogICAgICAgIGdhbWU6R2V0U2VydmljZSgiVmlydHVhbElucHV0TWFuYWdlciIpOlNlbmRLZXlFdmVudCh0cnVlLCAiTGVmdENvbnRyb2wiLCBmYWxzZSwgZ2FtZSkNCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJWaXJ0dWFsSW5wdXRNYW5hZ2VyIik6U2VuZEtleUV2ZW50KGZhbHNlLCAiTGVmdENvbnRyb2wiLCBmYWxzZSwgZ2FtZSkNCiAgICBlbmQpDQoNCiAgICBsb2NhbCBVSUdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikNCiAgICBVSUdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoew0KICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDI1NSwgMTI4LCAyNTUpKSwNCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygxLCBDb2xvcjMuZnJvbVJHQigxODAsIDkwLCAxODApKQ0KICAgIH0pDQogICAgVUlHcmFkaWVudC5Sb3RhdGlvbiA9IDQ1DQogICAgVUlHcmFkaWVudC5QYXJlbnQgPSBNYWluRnJhbWUNCg0KICAgIGxvY2FsIEdsb3cgPSBJbnN0YW5jZS5uZXcoIkltYWdlTGFiZWwiKQ0KICAgIEdsb3cuTmFtZSA9ICJHbG93Ig0KICAgIEdsb3cuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDENCiAgICBHbG93LlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41LCAwKQ0KICAgIEdsb3cuU2l6ZSA9IFVEaW0yLm5ldygxLjUsIDAsIDEuNSwgMCkNCiAgICBHbG93LkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpDQogICAgR2xvdy5JbWFnZSA9ICJyYnhhc3NldGlkOi8vNzEzMTk0NjA5OCINCiAgICBHbG93LkltYWdlQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMjgsIDI1NSkNCiAgICBHbG93LkltYWdlVHJhbnNwYXJlbmN5ID0gMC41DQogICAgR2xvdy5QYXJlbnQgPSBNYWluRnJhbWUNCmVuZA0KDQpsb2NhbCBXaW5kb3cgPSBGbHVlbnQ6Q3JlYXRlV2luZG93KHsNCiAgICBUaXRsZSA9IGdhbWU6R2V0U2VydmljZSgiTWFya2V0cGxhY2VTZXJ2aWNlIik6R2V0UHJvZHVjdEluZm8oMTY3MzI2OTQwNTIpLk5hbWUgLi4iIHwgUGlua3kgR29kIiwNCiAgICBTdWJUaXRsZSA9ICJHb2QgRWRpdGlvbiB8IGRpc2NvcmQuZ2cvN21xZmt5eEEiLA0KICAgIFRhYldpZHRoID0gMTcwLA0KICAgIFNpemUgPSBVRGltMi5mcm9tT2Zmc2V0KDY1MCwgNTIwKSwNCiAgICBBY3J5bGljID0gZmFsc2UsDQogICAgVGhlbWUgPSAiRGFyayIsDQogICAgTWluaW1pemVLZXkgPSBFbnVtLktleUNvZGUuTGVmdENvbnRyb2wsDQogICAgQnV0dG9uUHJlc2V0ID0gIkN1c3RvbSIsDQogICAgQnV0dG9ucyA9IHsNCiAgICAgICAgew0KICAgICAgICAgICAgVGV4dCA9ICJEaXNjb3JkIiwNCiAgICAgICAgICAgIFJpY2hUZXh0ID0gdHJ1ZSwNCiAgICAgICAgICAgIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMjU1KSwNCiAgICAgICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKSANCiAgICAgICAgICAgICAgICBzZXRjbGlwYm9hcmQoImRpc2NvcmQuZ2cvN21xZmt5eEEiKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIH0NCiAgICB9DQp9KQ0KDQotLSAvLyAvLyAvLyBTZXJ2aWNlcyAvLyAvLyAvLyAtLQ0KbG9jYWwgVmlydHVhbElucHV0TWFuYWdlciA9IGdhbWU6R2V0U2VydmljZSgiVmlydHVhbElucHV0TWFuYWdlciIpDQpsb2NhbCBSZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKQ0KbG9jYWwgVmlydHVhbFVzZXIgPSBnYW1lOkdldFNlcnZpY2UoIlZpcnR1YWxVc2VyIikNCmxvY2FsIEh0dHBTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJIdHRwU2VydmljZSIpDQpsb2NhbCBHdWlTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJHdWlTZXJ2aWNlIikNCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQ0KbG9jYWwgV29ya3NwYWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKQ0KbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpDQpsb2NhbCBDb3JlR3VpID0gZ2FtZTpHZXRTZXJ2aWNlKCdTdGFydGVyR3VpJykNCmxvY2FsIENvbnRleHRBY3Rpb25TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCdDb250ZXh0QWN0aW9uU2VydmljZScpDQpsb2NhbCBVc2VySW5wdXRTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCdVc2VySW5wdXRTZXJ2aWNlJykNCg0KLS0gLy8gLy8gLy8gTG9jYWxzIC8vIC8vIC8vIC0tDQpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXINCmxvY2FsIExvY2FsQ2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIG9yIExvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQ0KbG9jYWwgSHVtYW5vaWRSb290UGFydCA9IExvY2FsQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikNCmxvY2FsIFVzZXJQbGF5ZXIgPSBIdW1hbm9pZFJvb3RQYXJ0OldhaXRGb3JDaGlsZCgidXNlciIpDQpsb2NhbCBBY3RpdmVGb2xkZXIgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoImFjdGl2ZSIpDQpsb2NhbCBGaXNoaW5nWm9uZXNGb2xkZXIgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoInpvbmVzIik6V2FpdEZvckNoaWxkKCJmaXNoaW5nIikNCmxvY2FsIFRwU3BvdHNGb2xkZXIgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIndvcmxkIik6V2FpdEZvckNoaWxkKCJzcGF3bnMiKTpXYWl0Rm9yQ2hpbGQoIlRwU3BvdHMiKQ0KbG9jYWwgTnBjRm9sZGVyID0gV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJ3b3JsZCIpOldhaXRGb3JDaGlsZCgibnBjcyIpDQpsb2NhbCBQbGF5ZXJHdWkgPSBMb2NhbFBsYXllcjpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIpDQpsb2NhbCBzY3JlZW5HdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIsIFBsYXllckd1aSkNCmxvY2FsIHNoYWRvd0NvdW50TGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIsIHNjcmVlbkd1aSkNCnNoYWRvd0NvdW50TGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygwLCAyODAsIDAsIDcwKQ0Kc2hhZG93Q291bnRMYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAzMCwgMCwgMjYwKQ0Kc2hhZG93Q291bnRMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMA0Kc2hhZG93Q291bnRMYWJlbC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTUsIDE1LCAyMCkNCnNoYWRvd0NvdW50TGFiZWwuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQpzaGFkb3dDb3VudExhYmVsLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZA0Kc2hhZG93Q291bnRMYWJlbC5UZXh0U2l6ZSA9IDI0DQpzaGFkb3dDb3VudExhYmVsLlRleHQgPSAiU2hhZG93IENvdW50OiAwIg0Kc2hhZG93Q291bnRMYWJlbC5WaXNpYmxlID0gZmFsc2UNCmxvY2FsIFJlbmRlclN0ZXBwZWQgPSBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQNCmxvY2FsIFdhaXRGb3JTb21lb25lID0gUmVuZGVyU3RlcHBlZC5XYWl0DQoNCi0tIC8vIC8vIC8vIEZlYXR1cmVzIExpc3QgLy8gLy8gLy8gLS0NCg0KDQotLSAvLyAvLyAvLyBWYXJpYWJsZXMgLy8gLy8gLy8gLS0NCmxvY2FsIENhc3RNb2RlID0gIkxlZ2l0Ig0KbG9jYWwgU2hha2VNb2RlID0gIk5hdmlnYXRpb24iDQpsb2NhbCBSZWVsTW9kZSA9ICJCbGF0YW50Ig0KbG9jYWwgQ29sbGVjdE1vZGUgPSAiVGVsZXBvcnRzIg0KbG9jYWwgdGVsZXBvcnRTcG90cyA9IHt9DQpsb2NhbCBGcmVlemVDaGFyID0gZmFsc2UNCmxvY2FsIERheU9ubHlMb29wID0gbmlsDQpsb2NhbCBCeXBhc3NHcHNMb29wID0gbmlsDQpsb2NhbCBOb2NsaXAgPSBmYWxzZQ0KbG9jYWwgUnVuQ291bnQgPSBmYWxzZQ0KDQotLSAvLyAvLyAvLyBGdW5jdGlvbnMgLy8gLy8gLy8gLS0NCmZ1bmN0aW9uIFNob3dOb3RpZmljYXRpb24oU3RyaW5nKQ0KICAgIEZsdWVudDpOb3RpZnkoew0KICAgICAgICBUaXRsZSA9ICJQaW5reSBHb2QiLA0KICAgICAgICBDb250ZW50ID0gU3RyaW5nLA0KICAgICAgICBEdXJhdGlvbiA9IDMsDQogICAgICAgIFRoZW1lID0gIkRhcmsiLA0KICAgICAgICBUaXRsZUNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMDAsIDI1NSksDQogICAgICAgIEljb24gPSAicmJ4YXNzZXRpZDovLzcwNzI3MTg0MTIiLA0KICAgICAgICBBY3Rpb25zID0gew0KICAgICAgICAgICAgSWdub3JlID0gew0KICAgICAgICAgICAgICAgIE5hbWUgPSAiT0siLA0KICAgICAgICAgICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKSBlbmQNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pDQplbmQNCg0KLS0gLy8gU2VuZGluZyBFeGVjdXRpb24gVG8gRGlzY29yZCAvLyAtLQ0KbG9jYWwgZnVuY3Rpb24gR2V0UGxheWVyU3RhdHMoKQ0KICAgIGxvY2FsIGh1ZCA9IExvY2FsUGxheWVyOkZpbmRGaXJzdENoaWxkKCJQbGF5ZXJHdWkiKSBhbmQgTG9jYWxQbGF5ZXIuUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJodWQiKQ0KICAgIGlmIGh1ZCBhbmQgaHVkLnNhZmV6b25lIHRoZW4NCiAgICAgICAgbG9jYWwgY29pbnMgPSBodWQuc2FmZXpvbmU6RmluZEZpcnN0Q2hpbGQoImNvaW5zIikgYW5kIGh1ZC5zYWZlem9uZS5jb2lucy5UZXh0IG9yICJOL0EiDQogICAgICAgIGxvY2FsIGpvYklkID0gZ2FtZS5Kb2JJZA0KICAgICAgICBsb2NhbCBqb2luU2NyaXB0ID0gc3RyaW5nLmZvcm1hdCgiZ2FtZTpHZXRTZXJ2aWNlKCdUZWxlcG9ydFNlcnZpY2UnKTpUZWxlcG9ydFRvUGxhY2VJbnN0YW5jZSglZCwgJyVzJywgZ2FtZTpHZXRTZXJ2aWNlKCdQbGF5ZXJzJykuTG9jYWxQbGF5ZXIpIiwgZ2FtZS5QbGFjZUlkLCBqb2JJZCkNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIFVzZXJuYW1lID0gTG9jYWxQbGF5ZXIuTmFtZSwNCiAgICAgICAgICAgIERpc3BsYXlOYW1lID0gTG9jYWxQbGF5ZXIuRGlzcGxheU5hbWUsDQogICAgICAgICAgICBDb2lucyA9IGNvaW5zLA0KICAgICAgICAgICAgSm9iSWQgPSBqb2JJZCwNCiAgICAgICAgICAgIEpvaW5TY3JpcHQgPSBqb2luU2NyaXB0DQogICAgICAgIH0NCiAgICBlbmQNCiAgICByZXR1cm4gbmlsDQplbmQNCg0KZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLklkbGVkOkNvbm5lY3QoZnVuY3Rpb24oKQ0KICAgIFZpcnR1YWxVc2VyOkNhcHR1cmVDb250cm9sbGVyKCkNCiAgICBWaXJ0dWFsVXNlcjpDbGlja0J1dHRvbjIoVmVjdG9yMi5uZXcoKSkNCmVuZCkNCg0Kc3Bhd24oZnVuY3Rpb24oKQ0KICAgIHdoaWxlIHRydWUgZG8NCiAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiZXZlbnRzIik6V2FpdEZvckNoaWxkKCJhZmsiKTpGaXJlU2VydmVyKGZhbHNlKQ0KICAgICAgICB0YXNrLndhaXQoMC4wMSkNCiAgICBlbmQNCmVuZCkNCg0KLS0gLy8gLy8gLy8gQXV0byBDYXN0IC8vIC8vIC8vIC0tDQpsb2NhbCBhdXRvQ2FzdEVuYWJsZWQgPSBmYWxzZQ0KbG9jYWwgZnVuY3Rpb24gYXV0b0Nhc3QoKQ0KICAgIGlmIExvY2FsQ2hhcmFjdGVyIHRoZW4NCiAgICAgICAgbG9jYWwgdG9vbCA9IExvY2FsQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiVG9vbCIpDQogICAgICAgIGlmIHRvb2wgdGhlbg0KICAgICAgICAgICAgbG9jYWwgaGFzQm9iYmVyID0gdG9vbDpGaW5kRmlyc3RDaGlsZCgiYm9iYmVyIikNCiAgICAgICAgICAgIGlmIG5vdCBoYXNCb2JiZXIgdGhlbg0KICAgICAgICAgICAgICAgIGlmIENhc3RNb2RlID09ICJMZWdpdCIgdGhlbg0KICAgICAgICAgICAgICAgICAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRNb3VzZUJ1dHRvbkV2ZW50KDAsIDAsIDAsIHRydWUsIExvY2FsUGxheWVyLCAwKQ0KICAgICAgICAgICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LkNoaWxkQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBIdW1hbm9pZFJvb3RQYXJ0OkZpbmRGaXJzdENoaWxkKCJwb3dlciIpIH49IG5pbCBhbmQgSHVtYW5vaWRSb290UGFydC5wb3dlci5wb3dlcmJhci5iYXIgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LnBvd2VyLnBvd2VyYmFyLmJhci5DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24ocHJvcGVydHkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHByb3BlcnR5ID09ICJTaXplIiB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBIdW1hbm9pZFJvb3RQYXJ0LnBvd2VyLnBvd2VyYmFyLmJhci5TaXplID09IFVEaW0yLm5ldygxLCAwLCAxLCAwKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlydHVhbElucHV0TWFuYWdlcjpTZW5kTW91c2VCdXR0b25FdmVudCgwLCAwLCAwLCBmYWxzZSwgTG9jYWxQbGF5ZXIsIDApDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgIGVuZCkNCiAgICAgICAgICAgICAgICBlbHNlaWYgQ2FzdE1vZGUgPT0gIkJsYXRhbnQiIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcm9kID0gTG9jYWxDaGFyYWN0ZXIgYW5kIExvY2FsQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiVG9vbCIpDQogICAgICAgICAgICAgICAgICAgIGlmIHJvZCBhbmQgcm9kOkZpbmRGaXJzdENoaWxkKCJ2YWx1ZXMiKSBhbmQgc3RyaW5nLmZpbmQocm9kLk5hbWUsICJSb2QiKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQ0KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgUmFuZG9tID0gbWF0aC5yYW5kb20oOTAsIDk5KQ0KICAgICAgICAgICAgICAgICAgICAgICAgcm9kLmV2ZW50cy5jYXN0OkZpcmVTZXJ2ZXIoUmFuZG9tKQ0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgdGFzay53YWl0KDAuNSkNCiAgICBlbmQNCmVuZA0KDQotLSAvLyAvLyAvLyBBdXRvIFNoYWtlIC8vIC8vIC8vIC0tDQpsb2NhbCBhdXRvU2hha2VFbmFibGVkID0gdHJ1ZSAtLSBTZXQgdG8gdHJ1ZSB0byBlbmFibGUgYXV0by1zaGFrZQ0KbG9jYWwgYXV0b1NoYWtlQ29ubmVjdGlvbg0KbG9jYWwgU2hha2VNb2RlID0gIk5hdmlnYXRpb24iIC0tIENob29zZSBiZXR3ZWVuICJOYXZpZ2F0aW9uIiBvciAiTW91c2UiDQoNCmxvY2FsIGZ1bmN0aW9uIGF1dG9TaGFrZSgpDQogICAgaWYgU2hha2VNb2RlID09ICJOYXZpZ2F0aW9uIiB0aGVuDQogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGxvY2FsIHNoYWtldWkgPSBQbGF5ZXJHdWk6RmluZEZpcnN0Q2hpbGQoInNoYWtldWkiKQ0KICAgICAgICAgICAgaWYgbm90IHNoYWtldWkgdGhlbiByZXR1cm4gZW5kDQogICAgICAgICAgICBsb2NhbCBzYWZlem9uZSA9IHNoYWtldWk6RmluZEZpcnN0Q2hpbGQoInNhZmV6b25lIikNCiAgICAgICAgICAgIGxvY2FsIGJ1dHRvbiA9IHNhZmV6b25lIGFuZCBzYWZlem9uZTpGaW5kRmlyc3RDaGlsZCgiYnV0dG9uIikNCiAgICAgICAgICAgIGlmIGJ1dHRvbiB0aGVuDQogICAgICAgICAgICAgICAgLS0gU2ltdWxhdGUgYnV0dG9uIHByZXNzIHVzaW5nIEd1aVNlcnZpY2UNCiAgICAgICAgICAgICAgICBHdWlTZXJ2aWNlLlNlbGVjdGVkT2JqZWN0ID0gYnV0dG9uDQogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkgLS0gUmVkdWNlZCB3YWl0IHRpbWUgZm9yIGJldHRlciByZXNwb25zaXZlbmVzcw0KICAgICAgICAgICAgICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZEtleUV2ZW50KHRydWUsIEVudW0uS2V5Q29kZS5SZXR1cm4sIGZhbHNlLCBnYW1lKQ0KICAgICAgICAgICAgICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZEtleUV2ZW50KGZhbHNlLCBFbnVtLktleUNvZGUuUmV0dXJuLCBmYWxzZSwgZ2FtZSkNCiAgICAgICAgICAgICAgICBHdWlTZXJ2aWNlLlNlbGVjdGVkT2JqZWN0ID0gbmlsIC0tIENsZWFyIHNlbGVjdGVkIG9iamVjdCBhZnRlciBwcmVzcw0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZCkNCiAgICBlbHNlaWYgU2hha2VNb2RlID09ICJNb3VzZSIgdGhlbg0KICAgICAgICBwY2FsbChmdW5jdGlvbigpDQogICAgICAgICAgICBsb2NhbCBzaGFrZXVpID0gUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJzaGFrZXVpIikNCiAgICAgICAgICAgIGlmIG5vdCBzaGFrZXVpIHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICAgICAgbG9jYWwgc2FmZXpvbmUgPSBzaGFrZXVpOkZpbmRGaXJzdENoaWxkKCJzYWZlem9uZSIpDQogICAgICAgICAgICBsb2NhbCBidXR0b24gPSBzYWZlem9uZSBhbmQgc2FmZXpvbmU6RmluZEZpcnN0Q2hpbGQoImJ1dHRvbiIpDQogICAgICAgICAgICBpZiBidXR0b24gdGhlbg0KICAgICAgICAgICAgICAgIC0tIFNpbXVsYXRlIG1vdXNlIGNsaWNrIG9uIGJ1dHRvbg0KICAgICAgICAgICAgICAgIGxvY2FsIHBvcyA9IGJ1dHRvbi5BYnNvbHV0ZVBvc2l0aW9uDQogICAgICAgICAgICAgICAgbG9jYWwgc2l6ZSA9IGJ1dHRvbi5BYnNvbHV0ZVNpemUNCiAgICAgICAgICAgICAgICBsb2NhbCBjZW50ZXJYLCBjZW50ZXJZID0gcG9zLlggKyBzaXplLlggLyAyLCBwb3MuWSArIHNpemUuWSAvIDINCiAgICAgICAgICAgICAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRNb3VzZUJ1dHRvbkV2ZW50KGNlbnRlclgsIGNlbnRlclksIDAsIHRydWUsIGdhbWUsIDApDQogICAgICAgICAgICAgICAgVmlydHVhbElucHV0TWFuYWdlcjpTZW5kTW91c2VCdXR0b25FdmVudChjZW50ZXJYLCBjZW50ZXJZLCAwLCBmYWxzZSwgZ2FtZSwgMCkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQpDQogICAgZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gc3RhcnRBdXRvU2hha2UoKQ0KICAgIGlmIGF1dG9TaGFrZUNvbm5lY3Rpb24gb3Igbm90IGF1dG9TaGFrZUVuYWJsZWQgdGhlbiByZXR1cm4gZW5kDQogICAgLS0gVXNlIEhlYXJ0YmVhdCBmb3Igc21vb3RoZXIgZXhlY3V0aW9uIGluc3RlYWQgb2YgUmVuZGVyU3RlcHBlZA0KICAgIGF1dG9TaGFrZUNvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGF1dG9TaGFrZSkNCmVuZA0KDQpsb2NhbCBmdW5jdGlvbiBzdG9wQXV0b1NoYWtlKCkNCiAgICBpZiBhdXRvU2hha2VDb25uZWN0aW9uIHRoZW4NCiAgICAgICAgYXV0b1NoYWtlQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkNCiAgICAgICAgYXV0b1NoYWtlQ29ubmVjdGlvbiA9IG5pbA0KICAgIGVuZA0KZW5kDQoNCi0tIEF1dG9tYXRpY2FsbHkgc3RhcnQvc3RvcCBhdXRvLXNoYWtlIGJhc2VkIG9uIEdVSSBjaGFuZ2VzDQpQbGF5ZXJHdWkuRGVzY2VuZGFudEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oZGVzY2VuZGFudCkNCiAgICBpZiBhdXRvU2hha2VFbmFibGVkIGFuZCBkZXNjZW5kYW50Lk5hbWUgPT0gImJ1dHRvbiIgYW5kIGRlc2NlbmRhbnQuUGFyZW50IGFuZCBkZXNjZW5kYW50LlBhcmVudC5OYW1lID09ICJzYWZlem9uZSIgdGhlbg0KICAgICAgICBzdGFydEF1dG9TaGFrZSgpDQogICAgZW5kDQplbmQpDQoNClBsYXllckd1aS5EZXNjZW5kYW50UmVtb3Zpbmc6Q29ubmVjdChmdW5jdGlvbihkZXNjZW5kYW50KQ0KICAgIGlmIGRlc2NlbmRhbnQuTmFtZSA9PSAiYnV0dG9uIiBhbmQgZGVzY2VuZGFudC5QYXJlbnQgYW5kIGRlc2NlbmRhbnQuUGFyZW50Lk5hbWUgPT0gInNhZmV6b25lIiB0aGVuDQogICAgICAgIHN0b3BBdXRvU2hha2UoKQ0KICAgIGVuZA0KZW5kKQ0KDQotLSBJbml0aWFsIGNoZWNrIGZvciBzaGFrZSBVSQ0KdGFzay5kZWZlcihmdW5jdGlvbigpDQogICAgbG9jYWwgc2hha2V1aSA9IFBsYXllckd1aTpGaW5kRmlyc3RDaGlsZCgic2hha2V1aSIpDQogICAgbG9jYWwgc2FmZXpvbmUgPSBzaGFrZXVpIGFuZCBzaGFrZXVpOkZpbmRGaXJzdENoaWxkKCJzYWZlem9uZSIpDQogICAgbG9jYWwgYnV0dG9uID0gc2FmZXpvbmUgYW5kIHNhZmV6b25lOkZpbmRGaXJzdENoaWxkKCJidXR0b24iKQ0KICAgIGlmIGF1dG9TaGFrZUVuYWJsZWQgYW5kIGJ1dHRvbiB0aGVuDQogICAgICAgIHN0YXJ0QXV0b1NoYWtlKCkNCiAgICBlbmQNCmVuZCkNCg0KDQotLSAvLyAvLyAvLyBBdXRvIFJlZWwgLy8gLy8gLy8gLS0NCmxvY2FsIGF1dG9SZWVsRW5hYmxlZCA9IGZhbHNlDQpsb2NhbCBQZXJmZWN0Q2F0Y2hFbmFibGVkID0gZmFsc2UNCmxvY2FsIGF1dG9SZWVsQ29ubmVjdGlvbg0KbG9jYWwgZnVuY3Rpb24gYXV0b1JlZWwoKQ0KICAgIGxvY2FsIHJlZWwgPSBQbGF5ZXJHdWk6RmluZEZpcnN0Q2hpbGQoInJlZWwiKQ0KICAgIGlmIG5vdCByZWVsIHRoZW4gcmV0dXJuIGVuZA0KICAgIGxvY2FsIGJhciA9IHJlZWw6RmluZEZpcnN0Q2hpbGQoImJhciIpDQogICAgbG9jYWwgcGxheWVyYmFyID0gYmFyIGFuZCBiYXI6RmluZEZpcnN0Q2hpbGQoInBsYXllcmJhciIpDQogICAgbG9jYWwgZmlzaCA9IGJhciBhbmQgYmFyOkZpbmRGaXJzdENoaWxkKCJmaXNoIikNCiAgICBpZiBwbGF5ZXJiYXIgYW5kIGZpc2ggdGhlbg0KICAgICAgICBwbGF5ZXJiYXIuUG9zaXRpb24gPSBmaXNoLlBvc2l0aW9uDQogICAgZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gbm9wZXJmZWN0KCkNCiAgICBsb2NhbCByZWVsID0gUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJyZWVsIikNCiAgICBpZiBub3QgcmVlbCB0aGVuIHJldHVybiBlbmQNCiAgICBsb2NhbCBiYXIgPSByZWVsOkZpbmRGaXJzdENoaWxkKCJiYXIiKQ0KICAgIGxvY2FsIHBsYXllcmJhciA9IGJhciBhbmQgYmFyOkZpbmRGaXJzdENoaWxkKCJwbGF5ZXJiYXIiKQ0KICAgIGlmIHBsYXllcmJhciB0aGVuDQogICAgICAgIHBsYXllcmJhci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAtMzUsIDApDQogICAgICAgIHdhaXQoMC4yKQ0KICAgIGVuZA0KZW5kDQoNCmxvY2FsIGZ1bmN0aW9uIHN0YXJ0QXV0b1JlZWwoKQ0KICAgIGlmIFJlZWxNb2RlID09ICJMZWdpdCIgdGhlbg0KICAgICAgICBpZiBhdXRvUmVlbENvbm5lY3Rpb24gb3Igbm90IGF1dG9SZWVsRW5hYmxlZCB0aGVuIHJldHVybiBlbmQNCiAgICAgICAgbm9wZXJmZWN0KCkNCiAgICAgICAgdGFzay53YWl0KDIpDQogICAgICAgIGF1dG9SZWVsQ29ubmVjdGlvbiA9IFJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZDpDb25uZWN0KGF1dG9SZWVsKQ0KICAgIGVsc2VpZiBSZWVsTW9kZSA9PSAiQmxhdGFudCIgdGhlbg0KICAgICAgICBsb2NhbCByZWVsID0gUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJyZWVsIikNCiAgICAgICAgaWYgbm90IHJlZWwgdGhlbiByZXR1cm4gZW5kDQogICAgICAgIGxvY2FsIGJhciA9IHJlZWw6RmluZEZpcnN0Q2hpbGQoImJhciIpDQogICAgICAgIGxvY2FsIHBsYXllcmJhciA9IGJhciBhbmQgYmFyOkZpbmRGaXJzdENoaWxkKCJwbGF5ZXJiYXIiKQ0KICAgICAgICBwbGF5ZXJiYXI6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCdQb3NpdGlvbicpOldhaXQoKQ0KICAgICAgICBnYW1lLlJlcGxpY2F0ZWRTdG9yYWdlOldhaXRGb3JDaGlsZCgiZXZlbnRzIik6V2FpdEZvckNoaWxkKCJyZWVsZmluaXNoZWQiKTpGaXJlU2VydmVyKDEwMCwgZmFsc2UpDQogICAgZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gc3RvcEF1dG9SZWVsKCkNCiAgICBpZiBhdXRvUmVlbENvbm5lY3Rpb24gdGhlbg0KICAgICAgICBhdXRvUmVlbENvbm5lY3Rpb246RGlzY29ubmVjdCgpDQogICAgICAgIGF1dG9SZWVsQ29ubmVjdGlvbiA9IG5pbA0KICAgIGVuZA0KZW5kDQoNClBsYXllckd1aS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbihkZXNjZW5kYW50KQ0KICAgIGlmIGF1dG9SZWVsRW5hYmxlZCBhbmQgZGVzY2VuZGFudC5OYW1lID09ICJwbGF5ZXJiYXIiIGFuZCBkZXNjZW5kYW50LlBhcmVudCBhbmQgZGVzY2VuZGFudC5QYXJlbnQuTmFtZSA9PSAiYmFyIiB0aGVuDQogICAgICAgIHN0YXJ0QXV0b1JlZWwoKQ0KICAgIGVuZA0KZW5kKQ0KDQpQbGF5ZXJHdWkuRGVzY2VuZGFudFJlbW92aW5nOkNvbm5lY3QoZnVuY3Rpb24oZGVzY2VuZGFudCkNCiAgICBpZiBkZXNjZW5kYW50Lk5hbWUgPT0gInBsYXllcmJhciIgYW5kIGRlc2NlbmRhbnQuUGFyZW50IGFuZCBkZXNjZW5kYW50LlBhcmVudC5OYW1lID09ICJiYXIiIHRoZW4NCiAgICAgICAgc3RvcEF1dG9SZWVsKCkNCiAgICAgICAgaWYgYXV0b0Nhc3RFbmFibGVkIHRoZW4NCiAgICAgICAgICAgIHRhc2sud2FpdCgxKQ0KICAgICAgICAgICAgYXV0b0Nhc3QoKQ0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZCkNCg0KaWYgYXV0b1JlZWxFbmFibGVkIGFuZCBQbGF5ZXJHdWk6RmluZEZpcnN0Q2hpbGQoInJlZWwiKSBhbmQgDQogICAgUGxheWVyR3VpLnJlZWw6RmluZEZpcnN0Q2hpbGQoImJhciIpIGFuZCANCiAgICBQbGF5ZXJHdWkucmVlbC5iYXI6RmluZEZpcnN0Q2hpbGQoInBsYXllcmJhciIpIHRoZW4NCiAgICBzdGFydEF1dG9SZWVsKCkNCmVuZA0KDQotLSAvLyAvLyAvLyBab25lIENhc3QgLy8gLy8gLy8gLS0NClpvbmVDb25uZWN0aW9uID0gTG9jYWxDaGFyYWN0ZXIuQ2hpbGRBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKGNoaWxkKQ0KICAgIGlmIFpvbmVDYXN0IGFuZCBjaGlsZDpJc0EoIlRvb2wiKSBhbmQgRmlzaGluZ1pvbmVzRm9sZGVyOkZpbmRGaXJzdENoaWxkKFpvbmUpIH49IG5pbCB0aGVuDQogICAgICAgIGNoaWxkLkNoaWxkQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihibGVoaCkNCiAgICAgICAgICAgIGlmIGJsZWhoLk5hbWUgPT0gImJvYmJlciIgdGhlbg0KICAgICAgICAgICAgICAgIGxvY2FsIFJvcGVDb25zdHJhaW50ID0gYmxlaGg6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJSb3BlQ29uc3RyYWludCIpDQogICAgICAgICAgICAgICAgaWYgWm9uZUNhc3QgYW5kIFJvcGVDb25zdHJhaW50IH49IG5pbCB0aGVuDQogICAgICAgICAgICAgICAgICAgIFJvcGVDb25zdHJhaW50LkNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihwcm9wZXJ0eSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHByb3BlcnR5ID09ICJMZW5ndGgiIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSb3BlQ29uc3RyYWludC5MZW5ndGggPSBtYXRoLmh1Z2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgICBlbmQpDQogICAgICAgICAgICAgICAgICAgIFJvcGVDb25zdHJhaW50Lkxlbmd0aCA9IG1hdGguaHVnZQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQ0KICAgICAgICAgICAgICAgIHdoaWxlIFdhaXRGb3JTb21lb25lKFJlbmRlclN0ZXBwZWQpIGRvDQogICAgICAgICAgICAgICAgICAgIGlmIFpvbmVDYXN0IGFuZCBibGVoaC5QYXJlbnQgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpDQogICAgICAgICAgICAgICAgICAgICAgICBibGVoaC5DRnJhbWUgPSBGaXNoaW5nWm9uZXNGb2xkZXJbWm9uZV0uQ0ZyYW1lDQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZCkNCiAgICBlbmQNCmVuZCkNCg0KLS0gLy8gRmluZCBUcFNwb3RzIC8vIC0tDQpsb2NhbCBUcFNwb3RzRm9sZGVyID0gV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJ3b3JsZCIpOldhaXRGb3JDaGlsZCgic3Bhd25zIik6V2FpdEZvckNoaWxkKCJUcFNwb3RzIikNCmZvciBpLCB2IGluIHBhaXJzKFRwU3BvdHNGb2xkZXI6R2V0Q2hpbGRyZW4oKSkgZG8NCiAgICBpZiB0YWJsZS5maW5kKHRlbGVwb3J0U3BvdHMsIHYuTmFtZSkgPT0gbmlsIHRoZW4NCiAgICAgICAgdGFibGUuaW5zZXJ0KHRlbGVwb3J0U3BvdHMsIHYuTmFtZSkNCiAgICBlbmQNCmVuZA0KDQotLSAvLyAvLyAvLyBHZXQgUG9zaXRpb24gLy8gLy8gLy8gLS0NCmZ1bmN0aW9uIEdldFBvc2l0aW9uKCkNCglpZiBub3QgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4NCgkJcmV0dXJuIHsNCgkJCVZlY3RvcjMubmV3KDAsMCwwKSwNCgkJCVZlY3RvcjMubmV3KDAsMCwwKSwNCgkJCVZlY3RvcjMubmV3KDAsMCwwKQ0KCQl9DQoJZW5kDQoJcmV0dXJuIHsNCgkJZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpLlBvc2l0aW9uLlgsDQoJCWdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKS5Qb3NpdGlvbi5ZLA0KCQlnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikuUG9zaXRpb24uWg0KCX0NCmVuZA0KDQpmdW5jdGlvbiBFeHBvcnRWYWx1ZShhcmcxLCBhcmcyKQ0KCXJldHVybiB0b251bWJlcihzdHJpbmcuZm9ybWF0KCIlLiIuLihhcmcyIG9yIDEpLi4nZicsIGFyZzEpKQ0KZW5kDQoNCi0tIC8vIC8vIC8vIFNlbGwgSXRlbSAvLyAvLyAvLyAtLQ0KZnVuY3Rpb24gcmVtZW1iZXJQb3NpdGlvbigpDQogICAgc3Bhd24oZnVuY3Rpb24oKQ0KICAgICAgICBsb2NhbCBpbml0aWFsQ0ZyYW1lID0gSHVtYW5vaWRSb290UGFydC5DRnJhbWUNCiANCiAgICAgICAgbG9jYWwgYm9keVZlbG9jaXR5ID0gSW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiKQ0KICAgICAgICBib2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygwLCAwLCAwKQ0KICAgICAgICBib2R5VmVsb2NpdHkuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQ0KICAgICAgICBib2R5VmVsb2NpdHkuUGFyZW50ID0gSHVtYW5vaWRSb290UGFydA0KIA0KICAgICAgICBsb2NhbCBib2R5R3lybyA9IEluc3RhbmNlLm5ldygiQm9keUd5cm8iKQ0KICAgICAgICBib2R5R3lyby5NYXhUb3JxdWUgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQ0KICAgICAgICBib2R5R3lyby5EID0gMTAwDQogICAgICAgIGJvZHlHeXJvLlAgPSAxMDAwMA0KICAgICAgICBib2R5R3lyby5DRnJhbWUgPSBpbml0aWFsQ0ZyYW1lDQogICAgICAgIGJvZHlHeXJvLlBhcmVudCA9IEh1bWFub2lkUm9vdFBhcnQNCiANCiAgICAgICAgd2hpbGUgQXV0b0ZyZWV6ZSBkbw0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBpbml0aWFsQ0ZyYW1lDQogICAgICAgICAgICB0YXNrLndhaXQoMC4wMSkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGJvZHlWZWxvY2l0eSB0aGVuDQogICAgICAgICAgICBib2R5VmVsb2NpdHk6RGVzdHJveSgpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBib2R5R3lybyB0aGVuDQogICAgICAgICAgICBib2R5R3lybzpEZXN0cm95KCkNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KZW5kDQpmdW5jdGlvbiBTZWxsSGFuZCgpDQogICAgbG9jYWwgY3VycmVudFBvc2l0aW9uID0gSHVtYW5vaWRSb290UGFydC5DRnJhbWUNCiAgICBsb2NhbCBzZWxsUG9zaXRpb24gPSBDRnJhbWUubmV3KDQ2NCwgMTUxLCAyMzIpDQogICAgbG9jYWwgd2FzQXV0b0ZyZWV6ZUFjdGl2ZSA9IGZhbHNlDQogICAgaWYgQXV0b0ZyZWV6ZSB0aGVuDQogICAgICAgIHdhc0F1dG9GcmVlemVBY3RpdmUgPSB0cnVlDQogICAgICAgIEF1dG9GcmVlemUgPSBmYWxzZQ0KICAgIGVuZA0KICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gc2VsbFBvc2l0aW9uDQogICAgdGFzay53YWl0KDAuNSkNCiAgICB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJ3b3JsZCIpOldhaXRGb3JDaGlsZCgibnBjcyIpOldhaXRGb3JDaGlsZCgiTWFyYyBNZXJjaGFudCIpOldhaXRGb3JDaGlsZCgibWVyY2hhbnQiKTpXYWl0Rm9yQ2hpbGQoInNlbGwiKTpJbnZva2VTZXJ2ZXIoKQ0KICAgIHRhc2sud2FpdCgxKQ0KICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gY3VycmVudFBvc2l0aW9uDQogICAgaWYgd2FzQXV0b0ZyZWV6ZUFjdGl2ZSB0aGVuDQogICAgICAgIEF1dG9GcmVlemUgPSB0cnVlDQogICAgICAgIHJlbWVtYmVyUG9zaXRpb24oKQ0KICAgIGVuZA0KZW5kDQpmdW5jdGlvbiBTZWxsQWxsKCkNCiAgICBsb2NhbCBjdXJyZW50UG9zaXRpb24gPSBIdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQ0KICAgIGxvY2FsIHNlbGxQb3NpdGlvbiA9IENGcmFtZS5uZXcoNDY0LCAxNTEsIDIzMikNCiAgICBsb2NhbCB3YXNBdXRvRnJlZXplQWN0aXZlID0gZmFsc2UNCiAgICBpZiBBdXRvRnJlZXplIHRoZW4NCiAgICAgICAgd2FzQXV0b0ZyZWV6ZUFjdGl2ZSA9IHRydWUNCiAgICAgICAgQXV0b0ZyZWV6ZSA9IGZhbHNlDQogICAgZW5kDQogICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBzZWxsUG9zaXRpb24NCiAgICB0YXNrLndhaXQoMC41KQ0KICAgIHdvcmtzcGFjZTpXYWl0Rm9yQ2hpbGQoIndvcmxkIik6V2FpdEZvckNoaWxkKCJucGNzIik6V2FpdEZvckNoaWxkKCJNYXJjIE1lcmNoYW50Iik6V2FpdEZvckNoaWxkKCJtZXJjaGFudCIpOldhaXRGb3JDaGlsZCgic2VsbGFsbCIpOkludm9rZVNlcnZlcigpDQogICAgdGFzay53YWl0KDEpDQogICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBjdXJyZW50UG9zaXRpb24NCiAgICBpZiB3YXNBdXRvRnJlZXplQWN0aXZlIHRoZW4NCiAgICAgICAgQXV0b0ZyZWV6ZSA9IHRydWUNCiAgICAgICAgcmVtZW1iZXJQb3NpdGlvbigpDQogICAgZW5kDQplbmQNCg0KLS0gLy8gLy8gLy8gTm9jbGlwIFN0ZXBwZWQgLy8gLy8gLy8gLS0NCk5vY2xpcENvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLlN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgaWYgTm9jbGlwID09IHRydWUgdGhlbg0KICAgICAgICBpZiBMb2NhbENoYXJhY3RlciB+PSBuaWwgdGhlbg0KICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMoTG9jYWxDaGFyYWN0ZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8NCiAgICAgICAgICAgICAgICBpZiB2OklzQSgiQmFzZVBhcnQiKSBhbmQgdi5DYW5Db2xsaWRlID09IHRydWUgdGhlbg0KICAgICAgICAgICAgICAgICAgICB2LkNhbkNvbGxpZGUgPSBmYWxzZQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZA0KZW5kKQ0KDQotLSAvLyAvLyAvLyBEdXBlIC8vIC8vIC8vIC0tDQpsb2NhbCBEdXBlRW5hYmxlZCA9IGZhbHNlDQpsb2NhbCBEdXBlQ29ubmVjdGlvbg0KbG9jYWwgZnVuY3Rpb24gYXV0b0R1cGUoKQ0KICAgIGxvY2FsIGh1ZCA9IExvY2FsUGxheWVyLlBsYXllckd1aTpGaW5kRmlyc3RDaGlsZCgiaHVkIikNCiAgICBpZiBodWQgdGhlbg0KICAgICAgICBsb2NhbCBzYWZlem9uZSA9IGh1ZDpGaW5kRmlyc3RDaGlsZCgic2FmZXpvbmUiKQ0KICAgICAgICBpZiBzYWZlem9uZSB0aGVuDQogICAgICAgICAgICBsb2NhbCBib2R5QW5ub3VuY2VtZW50cyA9IHNhZmV6b25lOkZpbmRGaXJzdENoaWxkKCJib2R5YW5ub3VuY2VtZW50cyIpDQogICAgICAgICAgICBpZiBib2R5QW5ub3VuY2VtZW50cyB0aGVuDQogICAgICAgICAgICAgICAgbG9jYWwgb2ZmZXJGcmFtZSA9IGJvZHlBbm5vdW5jZW1lbnRzOkZpbmRGaXJzdENoaWxkKCJvZmZlciIpDQogICAgICAgICAgICAgICAgaWYgb2ZmZXJGcmFtZSBhbmQgb2ZmZXJGcmFtZTpGaW5kRmlyc3RDaGlsZCgiY29uZmlybSIpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgZmlyZXNpZ25hbChvZmZlckZyYW1lLmNvbmZpcm0uTW91c2VCdXR0b24xQ2xpY2spDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gc3RhcnRBdXRvRHVwZSgpDQogICAgaWYgRHVwZUNvbm5lY3Rpb24gb3Igbm90IER1cGVFbmFibGVkIHRoZW4gcmV0dXJuIGVuZA0KICAgIER1cGVDb25uZWN0aW9uID0gUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoYXV0b0R1cGUpDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gc3RvcEF1dG9EdXBlKCkNCiAgICBpZiBEdXBlQ29ubmVjdGlvbiB0aGVuDQogICAgICAgIER1cGVDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQ0KICAgICAgICBEdXBlQ29ubmVjdGlvbiA9IG5pbA0KICAgIGVuZA0KZW5kDQoNClBsYXllckd1aS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbihkZXNjZW5kYW50KQ0KICAgIGlmIER1cGVFbmFibGVkIGFuZCBkZXNjZW5kYW50Lk5hbWUgPT0gImNvbmZpcm0iIGFuZCBkZXNjZW5kYW50LlBhcmVudCBhbmQgZGVzY2VuZGFudC5QYXJlbnQuTmFtZSA9PSAib2ZmZXIiIHRoZW4NCiAgICAgICAgbG9jYWwgaHVkID0gTG9jYWxQbGF5ZXIuUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJodWQiKQ0KICAgICAgICBpZiBodWQgdGhlbg0KICAgICAgICAgICAgbG9jYWwgc2FmZXpvbmUgPSBodWQ6RmluZEZpcnN0Q2hpbGQoInNhZmV6b25lIikNCiAgICAgICAgICAgIGlmIHNhZmV6b25lIHRoZW4NCiAgICAgICAgICAgICAgICBsb2NhbCBib2R5QW5ub3VuY2VtZW50cyA9IHNhZmV6b25lOkZpbmRGaXJzdENoaWxkKCJib2R5YW5ub3VuY2VtZW50cyIpDQogICAgICAgICAgICAgICAgaWYgYm9keUFubm91bmNlbWVudHMgdGhlbg0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBvZmZlckZyYW1lID0gYm9keUFubm91bmNlbWVudHM6RmluZEZpcnN0Q2hpbGQoIm9mZmVyIikNCiAgICAgICAgICAgICAgICAgICAgaWYgb2ZmZXJGcmFtZSBhbmQgb2ZmZXJGcmFtZTpGaW5kRmlyc3RDaGlsZCgiY29uZmlybSIpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIGZpcmVzaWduYWwob2ZmZXJGcmFtZS5jb25maXJtLk1vdXNlQnV0dG9uMUNsaWNrKQ0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZCkNCg0KLS0gLy8gLy8gLy8gRXhjbHVzaXZlcyAvLyAvLyAvLyAtLQ0KbG9jYWwgc2hhZG93Q291bnRMYWJlbCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIiwgc2NyZWVuR3VpKQ0Kc2hhZG93Q291bnRMYWJlbC5TaXplID0gVURpbTIubmV3KDAsIDI4MCwgMCwgNzApDQpzaGFkb3dDb3VudExhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDMwLCAwLCAyNjApDQpzaGFkb3dDb3VudExhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwDQpzaGFkb3dDb3VudExhYmVsLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxNSwgMTUsIDIwKQ0Kc2hhZG93Q291bnRMYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMDAsIDI1NSkNCnNoYWRvd0NvdW50TGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkDQpzaGFkb3dDb3VudExhYmVsLlRleHRTaXplID0gMjQNCnNoYWRvd0NvdW50TGFiZWwuVGV4dCA9ICJTaGFkb3cgQ291bnQ6IDAiDQpzaGFkb3dDb3VudExhYmVsLlZpc2libGUgPSBmYWxzZQ0KDQpsb2NhbCBVSUdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikNClVJR3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7DQogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMjU1KSksDQogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjUsIENvbG9yMy5mcm9tUkdCKDE4MCwgOTAsIDE4MCkpLA0KICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgQ29sb3IzLmZyb21SR0IoMjU1LCAxMDAsIDI1NSkpDQp9KQ0KVUlHcmFkaWVudC5QYXJlbnQgPSBzaGFkb3dDb3VudExhYmVsDQoNCnNwYXduKGZ1bmN0aW9uKCkNCiAgICBsb2NhbCByb3RhdGlvbiA9IDANCiAgICB3aGlsZSB3YWl0KCkgZG8NCiAgICAgICAgcm90YXRpb24gPSAocm90YXRpb24gKyAxKSAlIDM2MA0KICAgICAgICBVSUdyYWRpZW50LlJvdGF0aW9uID0gcm90YXRpb24NCiAgICBlbmQNCmVuZCkNCg0KbG9jYWwgR2xvdyA9IEluc3RhbmNlLm5ldygiSW1hZ2VMYWJlbCIpDQpHbG93Lk5hbWUgPSAiR2xvdyINCkdsb3cuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDENCkdsb3cuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApDQpHbG93LlNpemUgPSBVRGltMi5uZXcoMS4yLCAwLCAxLjIsIDApDQpHbG93LkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpDQpHbG93LkltYWdlID0gInJieGFzc2V0aWQ6Ly83MTMxOTQ2MDk4Ig0KR2xvdy5JbWFnZUNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQpHbG93LkltYWdlVHJhbnNwYXJlbmN5ID0gMC44DQpHbG93LlBhcmVudCA9IHNoYWRvd0NvdW50TGFiZWwNCg0KbG9jYWwgY29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsIHNoYWRvd0NvdW50TGFiZWwpDQpjb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTUpDQoNCmxvY2FsIFVJU3Ryb2tlID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIpDQpVSVN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQpVSVN0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjQNClVJU3Ryb2tlLlRoaWNrbmVzcyA9IDINClVJU3Ryb2tlLlBhcmVudCA9IHNoYWRvd0NvdW50TGFiZWwNCg0KbG9jYWwgRHJvcFNoYWRvdyA9IEluc3RhbmNlLm5ldygiSW1hZ2VMYWJlbCIpDQpEcm9wU2hhZG93Lk5hbWUgPSAiRHJvcFNoYWRvdyINCkRyb3BTaGFkb3cuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDENCkRyb3BTaGFkb3cuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApDQpEcm9wU2hhZG93LlNpemUgPSBVRGltMi5uZXcoMS4xLCAwLCAxLjEsIDApDQpEcm9wU2hhZG93LkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpDQpEcm9wU2hhZG93LkltYWdlID0gInJieGFzc2V0aWQ6Ly83MTMxOTQ2MDk4Ig0KRHJvcFNoYWRvdy5JbWFnZUNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApDQpEcm9wU2hhZG93LkltYWdlVHJhbnNwYXJlbmN5ID0gMC41DQpEcm9wU2hhZG93LlpJbmRleCA9IC0xDQpEcm9wU2hhZG93LlBhcmVudCA9IHNoYWRvd0NvdW50TGFiZWwNCg0KbG9jYWwgZnVuY3Rpb24gdXBkYXRlU2hhZG93Q291bnQoKQ0KICAgIGlmIHdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCgiU2hhZG93cyIpIHRoZW4NCiAgICAgICAgbG9jYWwgY291bnQgPSAjd29ya3NwYWNlLlNoYWRvd3M6R2V0Q2hpbGRyZW4oKQ0KICAgICAgICBzaGFkb3dDb3VudExhYmVsLlRleHQgPSAiU2hhZG93IENvdW50OiAiIC4uIGNvdW50DQogICAgZWxzZQ0KICAgICAgICBzaGFkb3dDb3VudExhYmVsLlRleHQgPSAiU2hhZG93IENvdW50OiBOL0EiDQogICAgZW5kDQplbmQNCg0Kc3Bhd24oZnVuY3Rpb24oKQ0KICAgIHdoaWxlIHdhaXQoMSkgZG8NCiAgICAgICAgaWYgc2hhZG93Q291bnRMYWJlbC5WaXNpYmxlIHRoZW4NCiAgICAgICAgICAgIHVwZGF0ZVNoYWRvd0NvdW50KCkNCiAgICAgICAgZW5kDQogICAgZW5kDQplbmQpDQoNCi0tIC8vIC8vIC8vIFRhYnMgR3VpIC8vIC8vIC8vIC0tDQoNCmxvY2FsIFRhYnMgPSB7DQogICAgSG9tZSA9IFdpbmRvdzpBZGRUYWIoeyANCiAgICAgICAgVGl0bGUgPSAiSG9tZSIsIA0KICAgICAgICBJY29uID0gImNyb3duIiwNCiAgICAgICAgUmlnaHRJY29uID0gInNwYXJrbGVzIiwNCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQogICAgfSksDQogICAgTWFpbiA9IFdpbmRvdzpBZGRUYWIoeyANCiAgICAgICAgVGl0bGUgPSAiTWFpbiIsIA0KICAgICAgICBJY29uID0gInNldHRpbmdzIiwNCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQogICAgfSksDQogICAgRXhjbHVzaXZlcyA9IFdpbmRvdzpBZGRUYWIoeyANCiAgICAgICAgVGl0bGUgPSAiRXhjbHVzaXZlcyIsIA0KICAgICAgICBJY29uID0gImdlbSIsDQogICAgICAgIFJpZ2h0SWNvbiA9ICJzdGFyIiwNCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQogICAgfSksDQogICAgSXRlbXMgPSBXaW5kb3c6QWRkVGFiKHsgDQogICAgICAgIFRpdGxlID0gIkl0ZW1zIiwgDQogICAgICAgIEljb24gPSAicGFja2FnZSIsIA0KICAgICAgICBSaWdodEljb24gPSAiYm94IiwgDQogICAgICAgIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEyOCwgMjU1KSANCiAgICB9KSwNCiAgICBUZWxlcG9ydHMgPSBXaW5kb3c6QWRkVGFiKHsgDQogICAgICAgIFRpdGxlID0gIlRlbGVwb3J0cyIsIA0KICAgICAgICBJY29uID0gIm1hcCIsIA0KICAgICAgICBSaWdodEljb24gPSAibmF2aWdhdGlvbiIsIA0KICAgICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMjgsIDI1NSkgDQogICAgfSksDQogICAgTWlzYyA9IFdpbmRvdzpBZGRUYWIoeyANCiAgICAgICAgVGl0bGUgPSAiTWlzYyIsIA0KICAgICAgICBJY29uID0gIm1vcmUtaG9yaXpvbnRhbCIsIA0KICAgICAgICBSaWdodEljb24gPSAic2V0dGluZ3MiLCANCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTI4LCAyNTUpIA0KICAgIH0pLA0KICAgIFRyYWRlID0gV2luZG93OkFkZFRhYih7IA0KICAgICAgICBUaXRsZSA9ICJUcmFkZSIsIA0KICAgICAgICBJY29uID0gInJlcGVhdCIsIA0KICAgICAgICBSaWdodEljb24gPSAiZ2lmdCIsIA0KICAgICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMjgsIDI1NSkgDQogICAgfSkNCn0NCg0KbG9jYWwgT3B0aW9ucyA9IEZsdWVudC5PcHRpb25zDQoNCmRvDQogICAgVGFicy5Ib21lOkFkZFBhcmFncmFwaCh7DQogICAgICAgIFRpdGxlID0gIldlbGNvbWUgdG8gUGlua3kgR29kIiwNCiAgICAgICAgQ29udGVudCA9IFtbDQpUaGFuayB5b3UgZm9yIGNob29zaW5nIFBpbmt5IEdvZCENCg0KRmVhdHVyZXM6DQrDouKCrMKiIEV4Y2x1c2l2ZSBTaGFkb3cgU3lzdGVtDQrDouKCrMKiIEFkdmFuY2VkIEZpc2hpbmcgVG9vbHMNCsOi4oKswqIgUHJlbWl1bSBUZWxlcG9ydGF0aW9uDQrDouKCrMKiIFZJUCBTdXBwb3J0DQoNClZlcnNpb246IDEuMC4wDQpVcGRhdGVkOiBdXSAuLiBvcy5kYXRlKCIlZC8lbS8lWSIpDQogICAgfSkNCg0KICAgIC0tIC8vIEV4Y2x1c2l2ZXMgVGFiIC8vIC0tDQogICAgbG9jYWwgc2VjdGlvbkV4Y2x1cyA9IFRhYnMuRXhjbHVzaXZlczpBZGRTZWN0aW9uKCJFeGNsdXNpdmVzIEZlYXR1cmVzIikNCiAgICBsb2NhbCBDb3VudFNoYWRvd3MgPSBUYWJzLkV4Y2x1c2l2ZXM6QWRkVG9nZ2xlKCJDb3VudFNoYWRvd3MiLCB7DQogICAgICAgIFRpdGxlID0gIlNob3cgU2hhZG93IENvdW50ZXIiLA0KICAgICAgICBEZWZhdWx0ID0gZmFsc2UNCiAgICB9KQ0KICAgIENvdW50U2hhZG93czpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBsb2NhbCBSZXF1aXJlUm9kID0gUGxheWVyR3VpLmh1ZC5zYWZlem9uZS5lcXVpcG1lbnQucm9kcy5zY3JvbGwuc2FmZXpvbmU6RmluZEZpcnN0Q2hpbGQoIlJvZCBPZiBUaGUgRGVwdGhzIikNCiAgICAgICAgaWYgbm90IFJlcXVpcmVSb2QgdGhlbiANCiAgICAgICAgICAgIENvdW50U2hhZG93czpTZXRWYWx1ZShmYWxzZSkNCiAgICAgICAgICAgIGlmIE9wdGlvbnMuQ291bnRTaGFkb3dzLlZhbHVlIHRoZW4NCiAgICAgICAgICAgICAgICBTaG93Tm90aWZpY2F0aW9uKCJSZXF1aXJlbWVudDogUm9kIE9mIFRoZSBEZXB0aHMiKSANCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgc2hhZG93Q291bnRMYWJlbC5WaXNpYmxlID0gT3B0aW9ucy5Db3VudFNoYWRvd3MuVmFsdWUNCiAgICBlbmQpDQogICAgbG9jYWwgUm9kRHVwZSA9IFRhYnMuRXhjbHVzaXZlczpBZGRUb2dnbGUoIlJvZER1cGUiLCB7VGl0bGUgPSAiUm9kIE9mIFRoZSBEZXB0aHMgU3BhbSIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIFJvZER1cGU6T25DaGFuZ2VkKGZ1bmN0aW9uKCkNCiAgICAgICAgbG9jYWwgUmVxdWlyZVJvZCA9IFBsYXllckd1aS5odWQuc2FmZXpvbmUuZXF1aXBtZW50LnJvZHMuc2Nyb2xsLnNhZmV6b25lOkZpbmRGaXJzdENoaWxkKCJSb2QgT2YgVGhlIERlcHRocyIpDQogICAgICAgIGlmIG5vdCBSZXF1aXJlUm9kIHRoZW4gcmV0dXJuIFNob3dOb3RpZmljYXRpb24oIlJlcXVpcmVtZW50IFJvZCBPZiBUaGUgRGVwdGhzIikgZW5kDQogICAgICAgIHdoaWxlIE9wdGlvbnMuUm9kRHVwZS5WYWx1ZSBkbw0KICAgICAgICAgICAgbG9jYWwgYXJnczEgPSB7WzFdID0gIkZsaW1zeSBSb2QifQ0KICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLmV2ZW50cy5lcXVpcHJvZDpGaXJlU2VydmVyKHVucGFjayhhcmdzMSkpDQoNCiAgICAgICAgICAgIGxvY2FsIGFyZ3MyID0ge1sxXSA9ICJSb2QgT2YgVGhlIERlcHRocyJ9DQogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikuZXZlbnRzLmVxdWlwcm9kOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MyKSkNCiAgICAgICAgICAgIHRhc2sud2FpdChSb2REdXBlRGVsYXkpDQogICAgICAgIGVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBSb2REdXBlX0RlbGF5ID0gVGFicy5FeGNsdXNpdmVzOkFkZFNsaWRlcigiUm9kRHVwZV9EZWxheSIsIHsNCiAgICAgICAgVGl0bGUgPSAiUm9kIE9mIFRoZSBEZXB0aHMgU3BhbSBEZWxheSIsDQogICAgICAgIERlc2NyaXB0aW9uID0gIiIsDQogICAgICAgIERlZmF1bHQgPSAwLjIsDQogICAgICAgIE1pbiA9IDAsDQogICAgICAgIE1heCA9IDEsDQogICAgICAgIFJvdW5kaW5nID0gMSwNCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkNCiAgICAgICAgICAgIFJvZER1cGVEZWxheSA9IFZhbHVlDQogICAgICAgIGVuZA0KICAgIH0pDQogICAgVGFicy5FeGNsdXNpdmVzOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIkR1cGUgU2hhZG93IiwNCiAgICAgICAgRGVzY3JpcHRpb24gPSAiIiwNCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpDQogICAgICAgICAgICBsb2NhbCBSZXF1aXJlUm9kID0gUGxheWVyR3VpLmh1ZC5zYWZlem9uZS5lcXVpcG1lbnQucm9kcy5zY3JvbGwuc2FmZXpvbmU6RmluZEZpcnN0Q2hpbGQoIlJvZCBPZiBUaGUgRGVwdGhzIikNCiAgICAgICAgICAgIGlmIG5vdCBSZXF1aXJlUm9kIHRoZW4gcmV0dXJuIFNob3dOb3RpZmljYXRpb24oIlJlcXVpcmVtZW50IFJvZCBPZiBUaGUgRGVwdGhzIikgZW5kDQogICAgICAgICAgICBmb3IgaSx2IGluIHBhaXJzKExvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvIA0KICAgICAgICAgICAgICAgIGlmIHY6RmluZEZpcnN0Q2hpbGQoIm9mZmVyIikgdGhlbg0KICAgICAgICAgICAgICAgICAgICB2LlBhcmVudCA9IExvY2FsUGxheWVyLkNoYXJhY3Rlcg0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgICAgICB0YXNrLndhaXQoMikNCiAgICAgICAgICAgIGZvciBpLHYgaW4gcGFpcnMoTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkdldENoaWxkcmVuKCkpIGRvIA0KICAgICAgICAgICAgICAgIGlmIHY6RmluZEZpcnN0Q2hpbGQoIm9mZmVyIikgdGhlbg0KICAgICAgICAgICAgICAgICAgICB2LlBhcmVudCA9IExvY2FsUGxheWVyLkJhY2twYWNrDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgfSkNCg0KICAgIFRhYnMuRXhjbHVzaXZlczpBZGRCdXR0b24oew0KICAgICAgICBUaXRsZSA9ICJEZXN0cm95IFNoYWRvd3MiLA0KICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGZvciBfLHNoYWRvdyBpbiBwYWlycyh3b3Jrc3BhY2UuU2hhZG93czpHZXRDaGlsZHJlbigpKSBkbw0KICAgIAkJICAgIHNoYWRvdzpEZXN0cm95KCkNCgkJICAgIGVuZA0KICAgICAgICBlbmQNCiAgICB9KQ0KDQogICAgLS0gLy8gTWFpbiBUYWIgLy8gLS0NCiAgICBsb2NhbCBzZWN0aW9uID0gVGFicy5NYWluOkFkZFNlY3Rpb24oIkF1dG8gRmlzaGluZyIpDQogICAgbG9jYWwgYXV0b0Nhc3QgPSBUYWJzLk1haW46QWRkVG9nZ2xlKCJhdXRvQ2FzdCIsIHtUaXRsZSA9ICJBdXRvIENhc3QiLCBEZWZhdWx0ID0gZmFsc2UgfSkNCiAgICBhdXRvQ2FzdDpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBsb2NhbCBSb2ROYW1lID0gUmVwbGljYXRlZFN0b3JhZ2UucGxheWVyc3RhdHNbTG9jYWxQbGF5ZXIuTmFtZV0uU3RhdHMucm9kLlZhbHVlDQogICAgICAgIGlmIE9wdGlvbnMuYXV0b0Nhc3QuVmFsdWUgPT0gdHJ1ZSB0aGVuDQogICAgICAgICAgICBhdXRvQ2FzdEVuYWJsZWQgPSB0cnVlDQogICAgICAgICAgICBpZiBMb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZChSb2ROYW1lKSB0aGVuDQogICAgICAgICAgICAgICAgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkOkVxdWlwVG9vbChMb2NhbFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZChSb2ROYW1lKSkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgaWYgTG9jYWxDaGFyYWN0ZXIgdGhlbg0KICAgICAgICAgICAgICAgIGxvY2FsIHRvb2wgPSBMb2NhbENoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIlRvb2wiKQ0KICAgICAgICAgICAgICAgIGlmIHRvb2wgdGhlbg0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBoYXNCb2JiZXIgPSB0b29sOkZpbmRGaXJzdENoaWxkKCJib2JiZXIiKQ0KICAgICAgICAgICAgICAgICAgICBpZiBub3QgaGFzQm9iYmVyIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIENhc3RNb2RlID09ICJMZWdpdCIgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZE1vdXNlQnV0dG9uRXZlbnQoMCwgMCwgMCwgdHJ1ZSwgTG9jYWxQbGF5ZXIsIDApDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DaGlsZEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBIdW1hbm9pZFJvb3RQYXJ0OkZpbmRGaXJzdENoaWxkKCJwb3dlciIpIH49IG5pbCBhbmQgSHVtYW5vaWRSb290UGFydC5wb3dlci5wb3dlcmJhci5iYXIgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQucG93ZXIucG93ZXJiYXIuYmFyLkNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihwcm9wZXJ0eSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwcm9wZXJ0eSA9PSAiU2l6ZSIgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBIdW1hbm9pZFJvb3RQYXJ0LnBvd2VyLnBvd2VyYmFyLmJhci5TaXplID09IFVEaW0yLm5ldygxLCAwLCAxLCAwKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRNb3VzZUJ1dHRvbkV2ZW50KDAsIDAsIDAsIGZhbHNlLCBMb2NhbFBsYXllciwgMCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiBDYXN0TW9kZSA9PSAiQmxhdGFudCIgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHJvZCA9IExvY2FsQ2hhcmFjdGVyIGFuZCBMb2NhbENoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIlRvb2wiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHJvZCBhbmQgcm9kOkZpbmRGaXJzdENoaWxkKCJ2YWx1ZXMiKSBhbmQgc3RyaW5nLmZpbmQocm9kLk5hbWUsICJSb2QiKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIFJhbmRvbSA9IG1hdGgucmFuZG9tKDkwLCA5OSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9kLmV2ZW50cy5jYXN0OkZpcmVTZXJ2ZXIoUmFuZG9tKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGF1dG9DYXN0RW5hYmxlZCA9IGZhbHNlDQogICAgICAgIGVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBhdXRvU2hha2UgPSBUYWJzLk1haW46QWRkVG9nZ2xlKCJhdXRvU2hha2UiLCB7VGl0bGUgPSAiQXV0byBTaGFrZSIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIGF1dG9TaGFrZTpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBpZiBPcHRpb25zLmF1dG9TaGFrZS5WYWx1ZSA9PSB0cnVlIHRoZW4NCiAgICAgICAgICAgIGF1dG9TaGFrZUVuYWJsZWQgPSB0cnVlDQogICAgICAgICAgICBzdGFydEF1dG9TaGFrZSgpDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGF1dG9TaGFrZUVuYWJsZWQgPSBmYWxzZQ0KICAgICAgICAgICAgc3RvcEF1dG9TaGFrZSgpDQogICAgICAgIGVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBhdXRvUmVlbCA9IFRhYnMuTWFpbjpBZGRUb2dnbGUoImF1dG9SZWVsIiwge1RpdGxlID0gIkF1dG8gUmVlbCIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIGF1dG9SZWVsOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGlmIE9wdGlvbnMuYXV0b1JlZWwuVmFsdWUgPT0gdHJ1ZSB0aGVuDQogICAgICAgICAgICBhdXRvUmVlbEVuYWJsZWQgPSB0cnVlDQogICAgICAgICAgICBzdGFydEF1dG9SZWVsKCkNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgYXV0b1JlZWxFbmFibGVkID0gZmFsc2UNCiAgICAgICAgICAgIHN0b3BBdXRvUmVlbCgpDQogICAgICAgIGVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBGcmVlemVDaGFyYWN0ZXIgPSBUYWJzLk1haW46QWRkVG9nZ2xlKCJGcmVlemVDaGFyYWN0ZXIiLCB7VGl0bGUgPSAiRnJlZXplIENoYXJhY3RlciIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIEZyZWV6ZUNoYXJhY3RlcjpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBsb2NhbCBvbGRwb3MgPSBIdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQ0KICAgICAgICBGcmVlemVDaGFyID0gT3B0aW9ucy5GcmVlemVDaGFyYWN0ZXIuVmFsdWUNCiAgICAgICAgdGFzay53YWl0KCkNCiAgICAgICAgd2hpbGUgV2FpdEZvclNvbWVvbmUoUmVuZGVyU3RlcHBlZCkgZG8NCiAgICAgICAgICAgIGlmIEZyZWV6ZUNoYXIgYW5kIEh1bWFub2lkUm9vdFBhcnQgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQ0KICAgICAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb2xkcG9zDQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQpDQoNCiAgICAtLSAvLyBNb2RlIFRhYiAvLyAtLQ0KICAgIGxvY2FsIHNlY3Rpb24gPSBUYWJzLk1haW46QWRkU2VjdGlvbigiTW9kZSBGaXNoaW5nIikNCiAgICBsb2NhbCBhdXRvQ2FzdE1vZGUgPSBUYWJzLk1haW46QWRkRHJvcGRvd24oImF1dG9DYXN0TW9kZSIsIHsNCiAgICAgICAgVGl0bGUgPSAiQXV0byBDYXN0IE1vZGUiLA0KICAgICAgICBWYWx1ZXMgPSB7IkxlZ2l0IiwgIkJsYXRhbnQifSwNCiAgICAgICAgTXVsdGkgPSBmYWxzZSwNCiAgICAgICAgRGVmYXVsdCA9IENhc3RNb2RlLA0KICAgIH0pDQogICAgYXV0b0Nhc3RNb2RlOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkNCiAgICAgICAgQ2FzdE1vZGUgPSBWYWx1ZQ0KICAgIGVuZCkNCiAgICBsb2NhbCBhdXRvU2hha2VNb2RlID0gVGFicy5NYWluOkFkZERyb3Bkb3duKCJhdXRvU2hha2VNb2RlIiwgew0KICAgICAgICBUaXRsZSA9ICJBdXRvIFNoYWtlIE1vZGUiLA0KICAgICAgICBWYWx1ZXMgPSB7Ik5hdmlnYXRpb24iLCAiTW91c2UifSwNCiAgICAgICAgTXVsdGkgPSBmYWxzZSwNCiAgICAgICAgRGVmYXVsdCA9IFNoYWtlTW9kZSwNCiAgICB9KQ0KICAgIGF1dG9TaGFrZU1vZGU6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQ0KICAgICAgICBTaGFrZU1vZGUgPSBWYWx1ZQ0KICAgIGVuZCkNCiAgICBsb2NhbCBhdXRvUmVlbE1vZGUgPSBUYWJzLk1haW46QWRkRHJvcGRvd24oImF1dG9SZWVsTW9kZSIsIHsNCiAgICAgICAgVGl0bGUgPSAiQXV0byBSZWVsIE1vZGUiLA0KICAgICAgICBWYWx1ZXMgPSB7IkxlZ2l0IiwgIkJsYXRhbnQifSwNCiAgICAgICAgTXVsdGkgPSBmYWxzZSwNCiAgICAgICAgRGVmYXVsdCA9IFJlZWxNb2RlLA0KICAgIH0pDQogICAgYXV0b1JlZWxNb2RlOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkNCiAgICAgICAgUmVlbE1vZGUgPSBWYWx1ZQ0KICAgIGVuZCkNCg0KICAgIC0tIC8vIFNlbGwgVGFiIC8vIC0tDQogICAgbG9jYWwgc2VjdGlvbiA9IFRhYnMuSXRlbXM6QWRkU2VjdGlvbigiU2VsbCBJdGVtcyIpDQogICAgVGFicy5JdGVtczpBZGRCdXR0b24oew0KICAgICAgICBUaXRsZSA9ICJTZWxsIEhhbmQiLA0KICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIFNlbGxIYW5kKCkNCiAgICAgICAgZW5kDQogICAgfSkNCiAgICBUYWJzLkl0ZW1zOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIlNlbGwgQWxsIiwNCiAgICAgICAgRGVzY3JpcHRpb24gPSAiIiwNCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpDQogICAgICAgICAgICBTZWxsQWxsKCkNCiAgICAgICAgZW5kDQogICAgfSkNCg0KICAgIC0tIC8vIFRyZWFzdXJlIFRhYiAvLyAtLQ0KICAgIGxvY2FsIHNlY3Rpb24gPSBUYWJzLkl0ZW1zOkFkZFNlY3Rpb24oIlRyZWFzdXJlIikNCiAgICBUYWJzLkl0ZW1zOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIlRlbGVwb3J0IHRvIEphY2sgTWFycm93IiwNCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpDQogICAgICAgICAgICBIdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoLTI4MjQuMzU5LCAyMTQuMzExLCAxNTE4LjEzMCkNCiAgICAgICAgZW5kDQogICAgfSkNCiAgICBUYWJzLkl0ZW1zOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIlJlcGFpciBNYXAiLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGZvciBpLHYgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrOkdldENoaWxkcmVuKCkpIGRvIA0KICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSAiVHJlYXN1cmUgTWFwIiB0aGVuDQogICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQ6RXF1aXBUb29sKHYpDQogICAgICAgICAgICAgICAgICAgIHdvcmtzcGFjZS53b3JsZC5ucGNzWyJKYWNrIE1hcnJvdyJdLnRyZWFzdXJlLnJlcGFpcm1hcDpJbnZva2VTZXJ2ZXIoKQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIH0pDQogICAgVGFicy5JdGVtczpBZGRCdXR0b24oew0KICAgICAgICBUaXRsZSA9ICJDb2xsZWN0IFRyZWFzdXJlIiwNCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpDQogICAgICAgICAgICBmb3IgaSwgdiBpbiBpcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJXb3Jrc3BhY2UiKTpHZXREZXNjZW5kYW50cygpKSBkbw0KICAgICAgICAgICAgICAgIGlmIHYuQ2xhc3NOYW1lID09ICJQcm94aW1pdHlQcm9tcHQiIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgdi5Ib2xkRHVyYXRpb24gPSAwDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKHdvcmtzcGFjZS53b3JsZC5jaGVzdHM6R2V0RGVzY2VuZGFudHMoKSkgZG8NCiAgICAgICAgICAgICAgICBpZiB2OklzQSgiUGFydCIpIGFuZCB2OkZpbmRGaXJzdENoaWxkKCJDaGVzdFNldHVwIikgdGhlbiANCiAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IHYuQ0ZyYW1lDQogICAgICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIHBhaXJzKHdvcmtzcGFjZS53b3JsZC5jaGVzdHM6R2V0RGVzY2VuZGFudHMoKSkgZG8NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSAiUHJveGltaXR5UHJvbXB0IiB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZXByb3hpbWl0eXByb21wdCh2KQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMSkNCiAgICAgICAgICAgICAgICBlbmQgDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgfSkNCg0KICAgIC0tIC8vIFRlbGVwb3J0cyBUYWIgLy8gLS0NCiAgICBsb2NhbCBzZWN0aW9uID0gVGFicy5UZWxlcG9ydHM6QWRkU2VjdGlvbigiU2VsZWN0IFRlbGVwb3J0IikNCiAgICBsb2NhbCBJc2xhbmRUUERyb3Bkb3duVUkgPSBUYWJzLlRlbGVwb3J0czpBZGREcm9wZG93bigiSXNsYW5kVFBEcm9wZG93blVJIiwgew0KICAgICAgICBUaXRsZSA9ICJBcmVhIFRlbGVwb3J0IiwNCiAgICAgICAgVmFsdWVzID0gdGVsZXBvcnRTcG90cywNCiAgICAgICAgTXVsdGkgPSBmYWxzZSwNCiAgICAgICAgRGVmYXVsdCA9IG5pbCwNCiAgICB9KQ0KICAgIElzbGFuZFRQRHJvcGRvd25VSTpPbkNoYW5nZWQoZnVuY3Rpb24oVmFsdWUpDQogICAgICAgIGlmIHRlbGVwb3J0U3BvdHMgfj0gbmlsIGFuZCBIdW1hbm9pZFJvb3RQYXJ0IH49IG5pbCB0aGVuDQogICAgICAgICAgICB4cGNhbGwoZnVuY3Rpb24oKQ0KICAgICAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gVHBTcG90c0ZvbGRlcjpGaW5kRmlyc3RDaGlsZChWYWx1ZSkuQ0ZyYW1lICsgVmVjdG9yMy5uZXcoMCwgNSwgMCkNCiAgICAgICAgICAgICAgICBJc2xhbmRUUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKQ0KICAgICAgICAgICAgZW5kLGZ1bmN0aW9uIChlcnIpDQogICAgICAgICAgICBlbmQpDQogICAgICAgIGVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBUb3RlbVRQRHJvcGRvd25VSSA9IFRhYnMuVGVsZXBvcnRzOkFkZERyb3Bkb3duKCJUb3RlbVRQRHJvcGRvd25VSSIsIHsNCiAgICAgICAgVGl0bGUgPSAiU2VsZWN0IFRvdGVtIiwNCiAgICAgICAgVmFsdWVzID0geyJBdXJvcmEiLCAiU3VuZGlhbCIsICJXaW5kc2V0IiwgIlNtb2tlc2NyZWVuIiwgIlRlbXBlc3QifSwNCiAgICAgICAgTXVsdGkgPSBmYWxzZSwNCiAgICAgICAgRGVmYXVsdCA9IG5pbCwNCiAgICB9KQ0KICAgIFRvdGVtVFBEcm9wZG93blVJOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkNCiAgICAgICAgU2VsZWN0ZWRUb3RlbSA9IFZhbHVlDQogICAgICAgIGlmIFNlbGVjdGVkVG90ZW0gPT0gIkF1cm9yYSIgdGhlbg0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KC0xODExLCAtMTM3LCAtMzI4MikNCiAgICAgICAgICAgIFRvdGVtVFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkNCiAgICAgICAgZWxzZWlmIFNlbGVjdGVkVG90ZW0gPT0gIlN1bmRpYWwiIHRoZW4NCiAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygtMTE0OCwgMTM1LCAtMTA3NSkNCiAgICAgICAgICAgIFRvdGVtVFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkNCiAgICAgICAgZWxzZWlmIFNlbGVjdGVkVG90ZW0gPT0gIldpbmRzZXQiIHRoZW4NCiAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygyODQ5LCAxNzgsIDI3MDIpDQogICAgICAgICAgICBUb3RlbVRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpDQogICAgICAgIGVsc2VpZiBTZWxlY3RlZFRvdGVtID09ICJTbW9rZXNjcmVlbiIgdGhlbg0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDI3ODksIDE0MCwgLTYyNSkNCiAgICAgICAgICAgIFRvdGVtVFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkNCiAgICAgICAgZWxzZWlmIFNlbGVjdGVkVG90ZW0gPT0gIlRlbXBlc3QiIHRoZW4NCiAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygzNSwgMTMzLCAxOTQzKQ0KICAgICAgICAgICAgVG90ZW1UUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKQ0KICAgICAgICBlbmQNCiAgICBlbmQpDQogICAgbG9jYWwgV29ybGRFdmVudFRQRHJvcGRvd25VSSA9IFRhYnMuVGVsZXBvcnRzOkFkZERyb3Bkb3duKCJXb3JsZEV2ZW50VFBEcm9wZG93blVJIiwgew0KICAgICAgICBUaXRsZSA9ICJTZWxlY3QgV29ybGQgRXZlbnQiLA0KICAgICAgICBWYWx1ZXMgPSB7IlN0cmFuZ2UgV2hpcmxwb29sIiwgIkdyZWF0IEhhbW1lcmhlYWQgU2hhcmsiLCAiR3JlYXQgV2hpdGUgU2hhcmsiLCAiV2hhbGUgU2hhcmsiLCAiVGhlIERlcHRocyAtIFNlcnBlbnQifSwNCiAgICAgICAgTXVsdGkgPSBmYWxzZSwNCiAgICAgICAgRGVmYXVsdCA9IG5pbCwNCiAgICB9KQ0KICAgIFdvcmxkRXZlbnRUUERyb3Bkb3duVUk6T25DaGFuZ2VkKGZ1bmN0aW9uKFZhbHVlKQ0KICAgICAgICBTZWxlY3RlZFdvcmxkRXZlbnQgPSBWYWx1ZQ0KICAgICAgICBpZiBTZWxlY3RlZFdvcmxkRXZlbnQgPT0gIlN0cmFuZ2UgV2hpcmxwb29sIiB0aGVuDQogICAgICAgICAgICBsb2NhbCBvZmZzZXQgPSBWZWN0b3IzLm5ldygyNSwgMTM1LCAyNSkNCiAgICAgICAgICAgIGxvY2FsIFdvcmxkRXZlbnQgPSBnYW1lLldvcmtzcGFjZS56b25lcy5maXNoaW5nOkZpbmRGaXJzdENoaWxkKCJJc29uYWRlIikNCiAgICAgICAgICAgIGlmIG5vdCBXb3JsZEV2ZW50IHRoZW4gV29ybGRFdmVudFRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpIHJldHVybiBTaG93Tm90aWZpY2F0aW9uKCJOb3QgZm91bmQgU3RyYW5nZSBXaGlybHBvb2wiKSBlbmQNCiAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhnYW1lLldvcmtzcGFjZS56b25lcy5maXNoaW5nLklzb25hZGUuUG9zaXRpb24gKyBvZmZzZXQpICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0gU3RyYW5nZSBXaGlybHBvb2wNCiAgICAgICAgICAgIFdvcmxkRXZlbnRUUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKQ0KICAgICAgICBlbHNlaWYgU2VsZWN0ZWRXb3JsZEV2ZW50ID09ICJHcmVhdCBIYW1tZXJoZWFkIFNoYXJrIiB0aGVuDQogICAgICAgICAgICBsb2NhbCBvZmZzZXQgPSBWZWN0b3IzLm5ldygwLCAxMzUsIDApDQogICAgICAgICAgICBsb2NhbCBXb3JsZEV2ZW50ID0gZ2FtZS5Xb3Jrc3BhY2Uuem9uZXMuZmlzaGluZzpGaW5kRmlyc3RDaGlsZCgiR3JlYXQgSGFtbWVyaGVhZCBTaGFyayIpDQogICAgICAgICAgICBpZiBub3QgV29ybGRFdmVudCB0aGVuIFdvcmxkRXZlbnRUUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKSByZXR1cm4gU2hvd05vdGlmaWNhdGlvbigiTm90IGZvdW5kIEdyZWF0IEhhbW1lcmhlYWQgU2hhcmsiKSBlbmQNCiAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhnYW1lLldvcmtzcGFjZS56b25lcy5maXNoaW5nWyJHcmVhdCBIYW1tZXJoZWFkIFNoYXJrIl0uUG9zaXRpb24gKyBvZmZzZXQpICAgICAgICAgLS0gR3JlYXQgSGFtbWVyaGVhZCBTaGFyaw0KICAgICAgICAgICAgV29ybGRFdmVudFRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpDQogICAgICAgIGVsc2VpZiBTZWxlY3RlZFdvcmxkRXZlbnQgPT0gIkdyZWF0IFdoaXRlIFNoYXJrIiB0aGVuDQogICAgICAgICAgICBsb2NhbCBvZmZzZXQgPSBWZWN0b3IzLm5ldygwLCAxMzUsIDApDQogICAgICAgICAgICBsb2NhbCBXb3JsZEV2ZW50ID0gZ2FtZS5Xb3Jrc3BhY2Uuem9uZXMuZmlzaGluZzpGaW5kRmlyc3RDaGlsZCgiR3JlYXQgV2hpdGUgU2hhcmsiKQ0KICAgICAgICAgICAgaWYgbm90IFdvcmxkRXZlbnQgdGhlbiBXb3JsZEV2ZW50VFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkgcmV0dXJuIFNob3dOb3RpZmljYXRpb24oIk5vdCBmb3VuZCBHcmVhdCBXaGl0ZSBTaGFyayIpIGVuZA0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KGdhbWUuV29ya3NwYWNlLnpvbmVzLmZpc2hpbmdbIkdyZWF0IFdoaXRlIFNoYXJrIl0uUG9zaXRpb24gKyBvZmZzZXQpICAgICAgICAgICAgICAgLS0gR3JlYXQgV2hpdGUgU2hhcmsNCiAgICAgICAgICAgIFdvcmxkRXZlbnRUUERyb3Bkb3duVUk6U2V0VmFsdWUobmlsKQ0KICAgICAgICBlbHNlaWYgU2VsZWN0ZWRXb3JsZEV2ZW50ID09ICJXaGFsZSBTaGFyayIgdGhlbg0KICAgICAgICAgICAgbG9jYWwgb2Zmc2V0ID0gVmVjdG9yMy5uZXcoMCwgMTM1LCAwKQ0KICAgICAgICAgICAgbG9jYWwgV29ybGRFdmVudCA9IGdhbWUuV29ya3NwYWNlLnpvbmVzLmZpc2hpbmc6RmluZEZpcnN0Q2hpbGQoIldoYWxlIFNoYXJrIikNCiAgICAgICAgICAgIGlmIG5vdCBXb3JsZEV2ZW50IHRoZW4gV29ybGRFdmVudFRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpIHJldHVybiBTaG93Tm90aWZpY2F0aW9uKCJOb3QgZm91bmQgV2hhbGUgU2hhcmsiKSBlbmQNCiAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhnYW1lLldvcmtzcGFjZS56b25lcy5maXNoaW5nWyJXaGFsZSBTaGFyayJdLlBvc2l0aW9uICsgb2Zmc2V0KSAgICAgICAgICAgICAgICAgICAgIC0tIFdoYWxlIFNoYXJrDQogICAgICAgICAgICBXb3JsZEV2ZW50VFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkNCiAgICAgICAgZWxzZWlmIFNlbGVjdGVkV29ybGRFdmVudCA9PSAiVGhlIERlcHRocyAtIFNlcnBlbnQiIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIG9mZnNldCA9IFZlY3RvcjMubmV3KDAsIDUwLCAwKQ0KICAgICAgICAgICAgbG9jYWwgV29ybGRFdmVudCA9IGdhbWUuV29ya3NwYWNlLnpvbmVzLmZpc2hpbmc6RmluZEZpcnN0Q2hpbGQoIlRoZSBEZXB0aHMgLSBTZXJwZW50IikNCiAgICAgICAgICAgIGlmIG5vdCBXb3JsZEV2ZW50IHRoZW4gV29ybGRFdmVudFRQRHJvcGRvd25VSTpTZXRWYWx1ZShuaWwpIHJldHVybiBTaG93Tm90aWZpY2F0aW9uKCJOb3QgZm91bmQgVGhlIERlcHRocyAtIFNlcnBlbnQiKSBlbmQNCiAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhnYW1lLldvcmtzcGFjZS56b25lcy5maXNoaW5nWyJUaGUgRGVwdGhzIC0gU2VycGVudCJdLlBvc2l0aW9uICsgb2Zmc2V0KSAgICAgICAgICAgIC0tIFRoZSBEZXB0aHMgLSBTZXJwZW50DQogICAgICAgICAgICBXb3JsZEV2ZW50VFBEcm9wZG93blVJOlNldFZhbHVlKG5pbCkNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KICAgIFRhYnMuVGVsZXBvcnRzOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIlRlbGVwb3J0IHRvIFRyYXZlbGVyIE1lcmNoYW50IiwNCiAgICAgICAgRGVzY3JpcHRpb24gPSAiVGVsZXBvcnRzIHRvIHRoZSBUcmF2ZWxlciBNZXJjaGFudC4iLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGxvY2FsIE1lcmNoYW50ID0gZ2FtZS5Xb3Jrc3BhY2UuYWN0aXZlOkZpbmRGaXJzdENoaWxkKCJNZXJjaGFudCBCb2F0IikNCiAgICAgICAgICAgIGlmIG5vdCBNZXJjaGFudCB0aGVuIHJldHVybiBTaG93Tm90aWZpY2F0aW9uKCJOb3QgZm91bmQgTWVyY2hhbnQiKSBlbmQNCiAgICAgICAgICAgIEh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhnYW1lLldvcmtzcGFjZS5hY3RpdmVbIk1lcmNoYW50IEJvYXQiXS5Cb2F0WyJNZXJjaGFudCBCb2F0Il0uci5IYW5kbGVzUi5Qb3NpdGlvbikNCiAgICAgICAgZW5kDQogICAgfSkNCiAgICBUYWJzLlRlbGVwb3J0czpBZGRCdXR0b24oew0KICAgICAgICBUaXRsZSA9ICJDcmVhdGUgU2FmZSBab25lIiwNCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpDQogICAgICAgICAgICBsb2NhbCBTYWZlWm9uZSA9IEluc3RhbmNlLm5ldygiUGFydCIpDQogICAgICAgICAgICBTYWZlWm9uZS5TaXplID0gVmVjdG9yMy5uZXcoMzAsIDEsIDMwKQ0KICAgICAgICAgICAgU2FmZVpvbmUuUG9zaXRpb24gPSBWZWN0b3IzLm5ldyhtYXRoLnJhbmRvbSgtMjAwMCwyMDAwKSwgbWF0aC5yYW5kb20oNTAwMDAsOTAwMDApLCBtYXRoLnJhbmRvbSgtMjAwMCwyMDAwKSkNCiAgICAgICAgICAgIFNhZmVab25lLkFuY2hvcmVkID0gdHJ1ZQ0KICAgICAgICAgICAgU2FmZVpvbmUuQnJpY2tDb2xvciA9IEJyaWNrQ29sb3IubmV3KCJCcmlnaHQgcHVycGxlIikNCiAgICAgICAgICAgIFNhZmVab25lLk1hdGVyaWFsID0gRW51bS5NYXRlcmlhbC5Gb3JjZUZpZWxkDQogICAgICAgICAgICBTYWZlWm9uZS5QYXJlbnQgPSBnYW1lLldvcmtzcGFjZQ0KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBTYWZlWm9uZS5DRnJhbWUgKyBWZWN0b3IzLm5ldygwLCA1LCAwKQ0KICAgICAgICBlbmQNCiAgICB9KQ0KDQogICAgLS0gLy8gQ2hhcmFjdGVyIFRhYiAvLyAtLQ0KICAgIGxvY2FsIHNlY3Rpb24gPSBUYWJzLk1pc2M6QWRkU2VjdGlvbigiQ2hhcmFjdGVyIikNCiAgICBsb2NhbCBXYWxrT25XYXRlciA9IFRhYnMuTWlzYzpBZGRUb2dnbGUoIldhbGtPbldhdGVyIiwge1RpdGxlID0gIldhbGsgT24gV2F0ZXIiLCBEZWZhdWx0ID0gZmFsc2UgfSkNCiAgICBXYWxrT25XYXRlcjpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBmb3IgaSx2IGluIHBhaXJzKHdvcmtzcGFjZS56b25lcy5maXNoaW5nOkdldENoaWxkcmVuKCkpIGRvDQoJCQlpZiB2Lk5hbWUgPT0gV2Fsa1pvbmUgdGhlbg0KCQkJCXYuQ2FuQ29sbGlkZSA9IE9wdGlvbnMuV2Fsa09uV2F0ZXIuVmFsdWUNCiAgICAgICAgICAgICAgICBpZiB2Lk5hbWUgPT0gIk9jZWFuIiB0aGVuDQogICAgICAgICAgICAgICAgICAgIGZvciBpLHYgaW4gcGFpcnMod29ya3NwYWNlLnpvbmVzLmZpc2hpbmc6R2V0Q2hpbGRyZW4oKSkgZG8NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSAiRGVlcCBPY2VhbiIgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYuQ2FuQ29sbGlkZSA9IE9wdGlvbnMuV2Fsa09uV2F0ZXIuVmFsdWUNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCgkJCWVuZA0KCQllbmQNCiAgICBlbmQpDQogICAgbG9jYWwgV2Fsa09uV2F0ZXJab25lID0gVGFicy5NaXNjOkFkZERyb3Bkb3duKCJXYWxrT25XYXRlclpvbmUiLCB7DQogICAgICAgIFRpdGxlID0gIldhbGsgT24gV2F0ZXIgWm9uZSIsDQogICAgICAgIFZhbHVlcyA9IHsiT2NlYW4iLCAiRGVzb2xhdGUgRGVlcCIsICJUaGUgRGVwdGhzIn0sDQogICAgICAgIE11bHRpID0gZmFsc2UsDQogICAgICAgIERlZmF1bHQgPSAiT2NlYW4iLA0KICAgIH0pDQogICAgV2Fsa09uV2F0ZXJab25lOk9uQ2hhbmdlZChmdW5jdGlvbihWYWx1ZSkNCiAgICAgICAgV2Fsa1pvbmUgPSBWYWx1ZQ0KICAgIGVuZCkNCiAgICBsb2NhbCBXYWxrU3BlZWRTbGlkZXJVSSA9IFRhYnMuTWlzYzpBZGRTbGlkZXIoIldhbGtTcGVlZFNsaWRlclVJIiwgew0KICAgICAgICBUaXRsZSA9ICJXYWxrIFNwZWVkIiwNCiAgICAgICAgTWluID0gMTYsDQogICAgICAgIE1heCA9IDIwMCwNCiAgICAgICAgRGVmYXVsdCA9IDE2LA0KICAgICAgICBSb3VuZGluZyA9IDEsDQogICAgfSkNCiAgICBXYWxrU3BlZWRTbGlkZXJVSTpPbkNoYW5nZWQoZnVuY3Rpb24odmFsdWUpDQogICAgICAgIExvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5XYWxrU3BlZWQgPSB2YWx1ZQ0KICAgIGVuZCkNCiAgICBsb2NhbCBKdW1wSGVpZ2h0U2xpZGVyVUkgPSBUYWJzLk1pc2M6QWRkU2xpZGVyKCJKdW1wSGVpZ2h0U2xpZGVyVUkiLCB7DQogICAgICAgIFRpdGxlID0gIkp1bXAgSGVpZ2h0IiwNCiAgICAgICAgTWluID0gNTAsDQogICAgICAgIE1heCA9IDIwMCwNCiAgICAgICAgRGVmYXVsdCA9IDUwLA0KICAgICAgICBSb3VuZGluZyA9IDEsDQogICAgfSkNCiAgICBKdW1wSGVpZ2h0U2xpZGVyVUk6T25DaGFuZ2VkKGZ1bmN0aW9uKHZhbHVlKQ0KICAgICAgICBMb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuSnVtcFBvd2VyID0gdmFsdWUNCiAgICBlbmQpDQoNCiAgICBsb2NhbCBUb2dnbGVOb2NsaXAgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJUb2dnbGVOb2NsaXAiLCB7VGl0bGUgPSAiTm9jbGlwIiwgRGVmYXVsdCA9IGZhbHNlIH0pDQogICAgVG9nZ2xlTm9jbGlwOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIE5vY2xpcCA9IE9wdGlvbnMuVG9nZ2xlTm9jbGlwLlZhbHVlDQogICAgZW5kKQ0KDQogICAgLS0gLy8gTWlzYyBUYWIgLy8gLS0NCiAgICBsb2NhbCBzZWN0aW9uID0gVGFicy5NaXNjOkFkZFNlY3Rpb24oIk1pc2MiKQ0KICAgIGxvY2FsIEJ5cGFzc1JhZGFyID0gVGFicy5NaXNjOkFkZFRvZ2dsZSgiQnlwYXNzUmFkYXIiLCB7VGl0bGUgPSAiQnlwYXNzIEZpc2ggUmFkYXIiLCBEZWZhdWx0ID0gZmFsc2UgfSkNCiAgICBCeXBhc3NSYWRhcjpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBmb3IgXywgdiBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIkNvbGxlY3Rpb25TZXJ2aWNlIik6R2V0VGFnZ2VkKCJyYWRhclRhZyIpKSBkbw0KCQkJaWYgdjpJc0EoIkJpbGxib2FyZEd1aSIpIG9yIHY6SXNBKCJTdXJmYWNlR3VpIikgdGhlbg0KCQkJCXYuRW5hYmxlZCA9IE9wdGlvbnMuQnlwYXNzUmFkYXIuVmFsdWUNCgkJCWVuZA0KCQllbmQNCiAgICBlbmQpDQogICAgbG9jYWwgQnlwYXNzR1BTID0gVGFicy5NaXNjOkFkZFRvZ2dsZSgiQnlwYXNzR1BTIiwge1RpdGxlID0gIkJ5cGFzcyBHUFMiLCBEZWZhdWx0ID0gZmFsc2UgfSkNCiAgICBCeXBhc3NHUFM6T25DaGFuZ2VkKGZ1bmN0aW9uKCkNCiAgICAgICAgaWYgT3B0aW9ucy5CeXBhc3NHUFMuVmFsdWUgPT0gdHJ1ZSB0aGVuDQogICAgICAgICAgICBsb2NhbCBYeXpDbG9uZSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKS5yZXNvdXJjZXMuaXRlbXMuaXRlbXMuR1BTLkdQUy5ncHNNYWluLnh5ejpDbG9uZSgpDQoJCQlYeXpDbG9uZS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuUGxheWVyR3VpOldhaXRGb3JDaGlsZCgiaHVkIik6V2FpdEZvckNoaWxkKCJzYWZlem9uZSIpOldhaXRGb3JDaGlsZCgiYmFja3BhY2siKQ0KCQkJbG9jYWwgUG9zID0gR2V0UG9zaXRpb24oKQ0KCQkJbG9jYWwgU3RyaW5nSW5wdXQgPSBzdHJpbmcuZm9ybWF0KCIlcywgJXMsICVzIiwgRXhwb3J0VmFsdWUoUG9zWzFdKSwgRXhwb3J0VmFsdWUoUG9zWzJdKSwgRXhwb3J0VmFsdWUoUG9zWzNdKSkNCgkJCVh5ekNsb25lLlRleHQgPSAiPGZvbnQgY29sb3I9JyNmZjQ5NDknPlg8L2ZvbnQ+PGZvbnQgY29sb3IgPSAnI2EzZmY4MSc+WTwvZm9udD48Zm9udCBjb2xvciA9ICcjNjI2YWZmJz5aPC9mb250PjogIi4uU3RyaW5nSW5wdXQNCgkJCUJ5cGFzc0dwc0xvb3AgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpDQoJCQkJbG9jYWwgUG9zID0gR2V0UG9zaXRpb24oKQ0KCQkJCVN0cmluZ0lucHV0ID0gc3RyaW5nLmZvcm1hdCgiJXMsICVzLCAlcyIsIEV4cG9ydFZhbHVlKFBvc1sxXSksIEV4cG9ydFZhbHVlKFBvc1syXSksIEV4cG9ydFZhbHVlKFBvc1szXSkpDQoJCQkJWHl6Q2xvbmUuVGV4dCA9ICI8Zm9udCBjb2xvcj0nI2ZmNDk0OSc+WDwvZm9udD48Zm9udCBjb2xvciA9ICcjYTNmZjgxJz5ZPC9mb250Pjxmb250IGNvbG9yID0gJyM2MjZhZmYnPlo8L2ZvbnQ+IDogIi4uU3RyaW5nSW5wdXQNCgkJCWVuZCkNCgkJZWxzZQ0KCQkJaWYgUGxheWVyR3VpLmh1ZC5zYWZlem9uZS5iYWNrcGFjazpGaW5kRmlyc3RDaGlsZCgieHl6IikgdGhlbg0KCQkJCVBsYXllckd1aS5odWQuc2FmZXpvbmUuYmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoInh5eiIpOkRlc3Ryb3koKQ0KCQkJZW5kDQoJCQlpZiBCeXBhc3NHcHNMb29wIHRoZW4NCgkJCQlCeXBhc3NHcHNMb29wOkRpc2Nvbm5lY3QoKQ0KCQkJCUJ5cGFzc0dwc0xvb3AgPSBuaWwNCgkJCWVuZA0KICAgICAgICBlbmQNCiAgICBlbmQpDQogICAgbG9jYWwgUmVtb3ZlRm9nID0gVGFicy5NaXNjOkFkZFRvZ2dsZSgiUmVtb3ZlRm9nIiwge1RpdGxlID0gIlJlbW92ZSBGb2ciLCBEZWZhdWx0ID0gZmFsc2UgfSkNCiAgICBSZW1vdmVGb2c6T25DaGFuZ2VkKGZ1bmN0aW9uKCkNCiAgICAgICAgaWYgT3B0aW9ucy5SZW1vdmVGb2cuVmFsdWUgPT0gdHJ1ZSB0aGVuDQogICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIkxpZ2h0aW5nIik6RmluZEZpcnN0Q2hpbGQoIlNreSIpIHRoZW4NCiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIkxpZ2h0aW5nIik6RmluZEZpcnN0Q2hpbGQoIlNreSIpLlBhcmVudCA9IGdhbWU6R2V0U2VydmljZSgiTGlnaHRpbmciKS5ibG9vbQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiTGlnaHRpbmciKS5ibG9vbTpGaW5kRmlyc3RDaGlsZCgiU2t5IikgdGhlbg0KICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiTGlnaHRpbmciKS5ibG9vbTpGaW5kRmlyc3RDaGlsZCgiU2t5IikuUGFyZW50ID0gZ2FtZTpHZXRTZXJ2aWNlKCJMaWdodGluZyIpDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KICAgIGxvY2FsIERheU9ubHkgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJEYXlPbmx5Iiwge1RpdGxlID0gIkRheSBPbmx5IiwgRGVmYXVsdCA9IGZhbHNlIH0pDQogICAgRGF5T25seTpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBpZiBPcHRpb25zLkRheU9ubHkuVmFsdWUgPT0gdHJ1ZSB0aGVuDQogICAgICAgICAgICBEYXlPbmx5TG9vcCA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQ0KCQkJCWdhbWU6R2V0U2VydmljZSgiTGlnaHRpbmciKS5UaW1lT2ZEYXkgPSAiMTI6MDA6MDAiDQoJCQllbmQpDQoJCWVsc2UNCgkJCWlmIERheU9ubHlMb29wIHRoZW4NCgkJCQlEYXlPbmx5TG9vcDpEaXNjb25uZWN0KCkNCgkJCQlEYXlPbmx5TG9vcCA9IG5pbA0KCQkJZW5kDQogICAgICAgIGVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBIb2xkRHVyYXRpb24gPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJIb2xkRHVyYXRpb24iLCB7VGl0bGUgPSAiSG9sZCBEdXJhdGlvbiAwIHNlYyIsIERlZmF1bHQgPSBmYWxzZSB9KQ0KICAgIEhvbGREdXJhdGlvbjpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBpZiBPcHRpb25zLkhvbGREdXJhdGlvbi5WYWx1ZSA9PSB0cnVlIHRoZW4NCiAgICAgICAgICAgIGZvciBpLHYgaW4gaXBhaXJzKGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIik6R2V0RGVzY2VuZGFudHMoKSkgZG8NCiAgICAgICAgICAgICAgICBpZiB2LkNsYXNzTmFtZSA9PSAiUHJveGltaXR5UHJvbXB0IiB0aGVuDQogICAgICAgICAgICAgICAgICAgIHYuSG9sZER1cmF0aW9uID0gMA0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZCkNCiAgICBsb2NhbCBEaXNhYmxlT3h5Z2VuID0gVGFicy5NaXNjOkFkZFRvZ2dsZSgiRGlzYWJsZU94eWdlbiIsIHtUaXRsZSA9ICJEaXNhYmxlIE94eWdlbiIsIERlZmF1bHQgPSB0cnVlIH0pDQogICAgRGlzYWJsZU94eWdlbjpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBMb2NhbFBsYXllci5DaGFyYWN0ZXIuY2xpZW50Lm94eWdlbi5EaXNhYmxlZCA9IE9wdGlvbnMuRGlzYWJsZU94eWdlbi5WYWx1ZQ0KICAgIGVuZCkNCiAgICBUYWJzLk1pc2M6QWRkQnV0dG9uKHsNCiAgICAgICAgVGl0bGUgPSAiQ29weSBYWVoiLA0KICAgICAgICBEZXNjcmlwdGlvbiA9ICJDb3B5IENsaXBib2FyZCIsDQogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQ0KICAgICAgICAgICAgbG9jYWwgWFlaID0gdG9zdHJpbmcoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uKQ0KICAgICAgICAgICAgc2V0Y2xpcGJvYXJkKCJnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygiIC4uIFhZWiAuLiAiKSIpDQogICAgICAgIGVuZA0KICAgIH0pDQoNCiAgICBsb2NhbCBKdXN0VUkgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJKdXN0VUkiLCB7VGl0bGUgPSAiU2hvdy9IaWRlIFVJcyIsIERlZmF1bHQgPSB0cnVlIH0pDQogICAgSnVzdFVJOk9uQ2hhbmdlZChmdW5jdGlvbigpDQogICAgICAgIGxvY2FsIEJsYWNrU2hvdyA9IEp1c3RVSS5WYWx1ZQ0KICAgICAgICBpZiBCbGFja1Nob3cgdGhlbg0KICAgICAgICAgICAgUGxheWVyR3VpLmh1ZC5zYWZlem9uZS5WaXNpYmxlID0gdHJ1ZQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICBQbGF5ZXJHdWkuaHVkLnNhZmV6b25lLlZpc2libGUgPSBmYWxzZQ0KICAgICAgICBlbmQNCiAgICBlbmQpDQoNCiAgICBsb2NhbCBJZGVudGl0eUhpZGVyVUkgPSBUYWJzLk1pc2M6QWRkVG9nZ2xlKCJJZGVudGl0eUhpZGVyVUkiLCB7VGl0bGUgPSAiUHJvdGVjdCBJZGVudGl0eSIsIERlZmF1bHQgPSBmYWxzZSB9KSAgICANCiAgICBJZGVudGl0eUhpZGVyVUk6T25DaGFuZ2VkKGZ1bmN0aW9uKCkNCiAgICAgICAgd2hpbGUgT3B0aW9ucy5JZGVudGl0eUhpZGVyVUkuVmFsdWUgPT0gdHJ1ZSBkbw0KICAgICAgICAgICAgaWYgVXNlclBsYXllcjpGaW5kRmlyc3RDaGlsZCgic3RyZWFrIikgdGhlbiBVc2VyUGxheWVyLnN0cmVhay5UZXh0ID0gIkhJRERFTiIgZW5kDQogICAgICAgICAgICBpZiBVc2VyUGxheWVyOkZpbmRGaXJzdENoaWxkKCJsZXZlbCIpIHRoZW4gVXNlclBsYXllci5sZXZlbC5UZXh0ID0gIkxldmVsOiBISURERU4iIGVuZA0KICAgICAgICAgICAgaWYgVXNlclBsYXllcjpGaW5kRmlyc3RDaGlsZCgibGV2ZWwiKSB0aGVuIFVzZXJQbGF5ZXIudXNlci5UZXh0ID0gIkhJRERFTiIgZW5kDQogICAgICAgICAgICBsb2NhbCBodWQgPSBMb2NhbFBsYXllcjpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIpOldhaXRGb3JDaGlsZCgiaHVkIik6V2FpdEZvckNoaWxkKCJzYWZlem9uZSIpDQogICAgICAgICAgICBpZiBodWQ6RmluZEZpcnN0Q2hpbGQoImNvaW5zIikgdGhlbiBodWQuY29pbnMuVGV4dCA9ICJISURERU4kIiBlbmQNCiAgICAgICAgICAgIGlmIGh1ZDpGaW5kRmlyc3RDaGlsZCgibHZsIikgdGhlbiBodWQubHZsLlRleHQgPSAiSElEREVOIExWTCIgZW5kDQogICAgICAgICAgICB0YXNrLndhaXQoMC4wMSkNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KDQogICAgLS0gLy8gTG9hZCBUYWIgLy8gLS0NCiAgICBsb2NhbCBzZWN0aW9uID0gVGFicy5NaXNjOkFkZFNlY3Rpb24oIkxvYWQgU2NyaXB0cyIpDQogICAgVGFicy5NaXNjOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIkxvYWQgSW5maW5pdGUtWWllbGQgRkUiLA0KICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRWRnZUlZL2luZmluaXRleWllbGQvbWFzdGVyL3NvdXJjZScpKSgpDQogICAgICAgIGVuZA0KICAgIH0pDQogICAgVGFicy5NaXNjOkFkZEJ1dHRvbih7DQogICAgICAgIFRpdGxlID0gIkxvYWQgUmVtb3RlU3B5IiwNCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpDQogICAgICAgICAgICBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldEFzeW5jKCJodHRwczovL2dpdGh1Yi5jb20vcmljaGllMDg2Ni9yZW1vdGUtc3B5L3JlbGVhc2VzL2xhdGVzdC9kb3dubG9hZC9SZW1vdGVTcHkubHVhIikpKCkNCiAgICAgICAgZW5kDQogICAgfSkNCg0KICAgIGxvY2FsIHNlY3Rpb24gPSBUYWJzLlRyYWRlOkFkZFNlY3Rpb24oIkNvbWluZyBTb29uLi4uIikNCg0KICAgIC0tIEFkZCBBbnRpLUFGSyBidXR0b24gdG8gTWFpbiB0YWINCiAgICBsb2NhbCBzZWN0aW9uID0gVGFicy5NYWluOkFkZFNlY3Rpb24oIkFudGktQUZLIikNCiAgICBsb2NhbCBBbnRpQUZLID0gVGFicy5NYWluOkFkZFRvZ2dsZSgiQW50aUFGSyIsIHsNCiAgICAgICAgVGl0bGUgPSAiQW50aS1BRksiLA0KICAgICAgICBEZWZhdWx0ID0gZmFsc2UNCiAgICB9KQ0KDQogICAgQW50aUFGSzpPbkNoYW5nZWQoZnVuY3Rpb24oKQ0KICAgICAgICBpZiBPcHRpb25zLkFudGlBRksuVmFsdWUgdGhlbg0KICAgICAgICAgICAgbG9jYWwgYW50aUFGS0d1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikNCiAgICAgICAgICAgIGxvY2FsIG1haW5GcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQ0KICAgICAgICAgICAgbG9jYWwgdGl0bGUgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpIA0KICAgICAgICAgICAgbG9jYWwgc3RhdHVzID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQ0KICAgICAgICAgICAgbG9jYWwgY3JlZGl0ID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQ0KDQogICAgICAgICAgICAtLSBHVUkgU2V0dXANCiAgICAgICAgICAgIGFudGlBRktHdWkuTmFtZSA9ICJBbnRpQUZLR3VpIg0KICAgICAgICAgICAgYW50aUFGS0d1aS5QYXJlbnQgPSBnYW1lLkNvcmVHdWkNCiAgICAgICAgICAgIGFudGlBRktHdWkuWkluZGV4QmVoYXZpb3IgPSBFbnVtLlpJbmRleEJlaGF2aW9yLlNpYmxpbmcNCg0KICAgICAgICAgICAgbWFpbkZyYW1lLk5hbWUgPSAiTWFpbkZyYW1lIg0KICAgICAgICAgICAgbWFpbkZyYW1lLlBhcmVudCA9IGFudGlBRktHdWkNCiAgICAgICAgICAgIG1haW5GcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoNDUsIDQ1LCA0NSkNCiAgICAgICAgICAgIG1haW5GcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjcsIDAsIDAuMSwgMCkNCiAgICAgICAgICAgIG1haW5GcmFtZS5TaXplID0gVURpbTIubmV3KDAsIDM3MCwgMCwgMTYwKQ0KICAgICAgICAgICAgbWFpbkZyYW1lLkFjdGl2ZSA9IHRydWUNCiAgICAgICAgICAgIG1haW5GcmFtZS5EcmFnZ2FibGUgPSB0cnVlDQoNCiAgICAgICAgICAgIHRpdGxlLk5hbWUgPSAiVGl0bGUiDQogICAgICAgICAgICB0aXRsZS5QYXJlbnQgPSBtYWluRnJhbWUNCiAgICAgICAgICAgIHRpdGxlLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigzNSwgMzUsIDM1KQ0KICAgICAgICAgICAgdGl0bGUuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAzMCkNCiAgICAgICAgICAgIHRpdGxlLkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2Fuc0JvbGQNCiAgICAgICAgICAgIHRpdGxlLlRleHQgPSAiQW50aSBBRksgU3RhdHVzIg0KICAgICAgICAgICAgdGl0bGUuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAyNTUpDQogICAgICAgICAgICB0aXRsZS5UZXh0U2l6ZSA9IDIyDQoNCiAgICAgICAgICAgIHN0YXR1cy5OYW1lID0gIlN0YXR1cyINCiAgICAgICAgICAgIHN0YXR1cy5QYXJlbnQgPSBtYWluRnJhbWUNCiAgICAgICAgICAgIHN0YXR1cy5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzUsIDM1LCAzNSkNCiAgICAgICAgICAgIHN0YXR1cy5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLjMsIDApDQogICAgICAgICAgICBzdGF0dXMuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCA0NCkNCiAgICAgICAgICAgIHN0YXR1cy5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnNCb2xkDQogICAgICAgICAgICBzdGF0dXMuVGV4dCA9ICJTdGF0dXM6IEFjdGl2ZSINCiAgICAgICAgICAgIHN0YXR1cy5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMDAsIDI1NSkNCiAgICAgICAgICAgIHN0YXR1cy5UZXh0U2l6ZSA9IDIwDQoNCiAgICAgICAgICAgIGNyZWRpdC5OYW1lID0gIkNyZWRpdCINCiAgICAgICAgICAgIGNyZWRpdC5QYXJlbnQgPSBtYWluRnJhbWUNCiAgICAgICAgICAgIGNyZWRpdC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzUsIDM1LCAzNSkNCiAgICAgICAgICAgIGNyZWRpdC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLjcsIDApDQogICAgICAgICAgICBjcmVkaXQuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAzMCkNCiAgICAgICAgICAgIGNyZWRpdC5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMNCiAgICAgICAgICAgIGNyZWRpdC5UZXh0ID0gIk1hZGUgYnkgUGlua3kgR29kIg0KICAgICAgICAgICAgY3JlZGl0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMjU1KQ0KICAgICAgICAgICAgY3JlZGl0LlRleHRTaXplID0gMTgNCg0KICAgICAgICAgICAgLS0gQW50aS1BRksgTG9naWMNCiAgICAgICAgICAgIGxvY2FsIFZpcnR1YWxVc2VyID0gZ2FtZTpHZXRTZXJ2aWNlKCdWaXJ0dWFsVXNlcicpDQogICAgICAgICAgICBsb2NhbCBjb25uZWN0aW9uID0gZ2FtZTpHZXRTZXJ2aWNlKCdQbGF5ZXJzJykuTG9jYWxQbGF5ZXIuSWRsZWQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgICAgICAgICAgICAgVmlydHVhbFVzZXI6Q2FwdHVyZUNvbnRyb2xsZXIoKQ0KICAgICAgICAgICAgICAgIFZpcnR1YWxVc2VyOkNsaWNrQnV0dG9uMihWZWN0b3IyLm5ldygpKQ0KICAgICAgICAgICAgICAgIHN0YXR1cy5UZXh0ID0gIlByZXZlbnRlZCBBRksgS2ljayEiDQogICAgICAgICAgICAgICAgd2FpdCgyKQ0KICAgICAgICAgICAgICAgIHN0YXR1cy5UZXh0ID0gIlN0YXR1czogQWN0aXZlIg0KICAgICAgICAgICAgZW5kKQ0KDQogICAgICAgICAgICAtLSBDbGVhbnVwIHdoZW4gdG9nZ2xlZCBvZmYNCiAgICAgICAgICAgIEFudGlBRksuQ29ubmVjdGlvbiA9IGNvbm5lY3Rpb24NCiAgICAgICAgICAgIEFudGlBRksuR3VpID0gYW50aUFGS0d1aQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICBpZiBBbnRpQUZLLkNvbm5lY3Rpb24gdGhlbg0KICAgICAgICAgICAgICAgIEFudGlBRksuQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgaWYgQW50aUFGSy5HdWkgdGhlbg0KICAgICAgICAgICAgICAgIEFudGlBRksuR3VpOkRlc3Ryb3koKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZCkNCmVuZA0KDQpXaW5kb3c6U2VsZWN0VGFiKDEpDQpGbHVlbnQ6Tm90aWZ5KHsNCiAgICBUaXRsZSA9ICJQaW5reSBHb2QiLA0KICAgIENvbnRlbnQgPSAiU3VjY2Vzc2Z1bGx5IExvYWRlZCIsDQogICAgRHVyYXRpb24gPSAzLA0KICAgIFRoZW1lID0gIkRhcmsiLA0KICAgIFRpdGxlQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMjU1KSwNCiAgICBJY29uID0gInJieGFzc2V0aWQ6Ly83MDcyNzE4NDEyIiwNCiAgICBBY3Rpb25zID0gew0KICAgICAgICBJZ25vcmUgPSB7DQogICAgICAgICAgICBOYW1lID0gIk9LIiwNCiAgICAgICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKSBlbmQNCiAgICAgICAgfQ0KICAgIH0NCn0p]]local b=function(c)local d={}for e=1,#c do d[e]=string.char(bit32.bxor(string.byte(c,e),e%255))end return table.concat(d)end return b(a)end)())() _()
